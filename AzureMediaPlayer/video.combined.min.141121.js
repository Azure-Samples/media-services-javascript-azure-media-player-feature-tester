function _handleMultipleEvents(n,t,i,r){vjs.arr.forEach(i,function(i){n(t,i,r)})}function _logType(n,t){var i,u,r;i=Array.prototype.slice.call(t);u=function(){};r=window.console||{log:u,warn:u,error:u};n?i.unshift(n.toUpperCase()+":"):n="log";vjs.log.history.push(i);i.unshift("VIDEOJS:");r[n].apply?r[n].apply(r,i):r[n](i.join(" "))}function ObjectIron(n){var t;for(t=[],i=0,len=n.length;i<len;i+=1)n[i].isRoot?t.push("root"):t.push(n[i].name);var e=function(n,t){var i;if(n!==null&&t!==null)for(i in n)n.hasOwnProperty(i)&&(t.hasOwnProperty(i)||(t[i]=n[i]))},u=function(n,t,i){var o,s,r,u,f;if(n!==null&&n.length!==0)for(o=0,s=n.length;o<s;o+=1)r=n[o],t.hasOwnProperty(r.name)&&(i.hasOwnProperty(r.name)?r.merge&&(u=t[r.name],f=i[r.name],typeof u=="object"&&typeof f=="object"?e(u,f):i[r.name]=r.mergeFunction!=null?r.mergeFunction(u,f):u+f):i[r.name]=t[r.name])},r=function(n,t){var f=n,o,c,s,l,h,i,e;if(f.children!==null&&f.children.length!==0)for(o=0,c=f.children.length;o<c;o+=1)if(i=f.children[o],t.hasOwnProperty(i.name))if(i.isArray)for(h=t[i.name+"_asArray"],s=0,l=h.length;s<l;s+=1)e=h[s],u(f.properties,t,e),r(i,e);else e=t[i.name],u(f.properties,t,e),r(i,e)},f=function(i){var u,h,c,e,o,s,l;if(i===null||typeof i!="object")return i;for(u=0,h=t.length;u<h;u+=1)t[u]==="root"&&(o=n[u],s=i,r(o,s));for(e in i)if(i.hasOwnProperty(e)){if(c=t.indexOf(e),c!==-1)if(o=n[c],o.isArray)for(l=i[e+"_asArray"],u=0,h=l.length;u<h;u+=1)s=l[u],r(o,s);else s=i[e],r(o,s);f(i[e])}return i};return{run:f}}function X2JS(n,t,i){function h(n){var t=n.localName;return t==null&&(t=n.baseName),(t==null||t=="")&&(t=n.nodeName),t}function w(n){return n.prefix}function c(n){return typeof n=="string"?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):n}function b(n){return n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function f(u){var l,it,o,g,v,c,s,rt,y,p,a,nt,k,ut,tt,d;if(u.nodeType==r.DOCUMENT_NODE){for(c=u.firstChild,l=0,it=u.childNodes.length;l<it;l+=1)if(u.childNodes[l].nodeType!==r.COMMENT_NODE){c=u.childNodes[l];break}return i?o=f(c):(o={},s=h(c),o[s]=f(c)),o}if(u.nodeType==r.ELEMENT_NODE){for(o={},o.__cnt=0,g=u.childNodes,v=0;v<g.length;v++)if(c=g.item(v),s=h(c),o.__cnt++,o[s]==null)o[s]=f(c),o[s+"_asArray"]=new Array(1),o[s+"_asArray"][0]=o[s];else{for(o[s]!=null&&(o[s]instanceof Array||(rt=o[s],o[s]=[],o[s][0]=rt,o[s+"_asArray"]=o[s])),y=0;o[s][y]!=null;)y++;o[s][y]=f(c)}for(p=0;p<u.attributes.length;p++){for(a=u.attributes.item(p),o.__cnt++,nt=a.value,k=0,ut=n.length;k<ut;k++)tt=n[k],tt.test.call(this,a.value)&&(nt=tt.converter.call(this,a.value));o[t+a.name]=nt}return d=w(u),d!=null&&d!=""&&(o.__cnt++,o.__prefix=d),o.__cnt==1&&o["#text"]!=null&&(o=o["#text"]),o["#text"]!=null&&(o.__text=o["#text"],e&&(o.__text=b(o.__text)),delete o["#text"],delete o["#text_asArray"]),o["#cdata-section"]!=null&&(o.__cdata=o["#cdata-section"],delete o["#cdata-section"],delete o["#cdata-section_asArray"]),(o.__text!=null||o.__cdata!=null)&&(o.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}),o}return u.nodeType==r.TEXT_NODE||u.nodeType==r.CDATA_SECTION_NODE?u.nodeValue:u.nodeType==r.COMMENT_NODE?null:void 0}function u(n,t,i,r){var e="<"+(n!=null&&n.__prefix!=null?n.__prefix+":":"")+t,u,f,o;if(i!=null)for(u=0;u<i.length;u++)f=i[u],o=n[f],e+=" "+f.substr(1)+"='"+o+"'";return e+(r?"/>":">")}function o(n,t){return"<\/"+(n.__prefix!=null?n.__prefix+":":"")+t+">"}function k(n,t){return n.indexOf(t,n.length-t.length)!==-1}function l(n,t){return k(t.toString(),"_asArray")||t.toString().indexOf("_")==0||n[t]instanceof Function?!0:!1}function a(n){var t=0,i;if(n instanceof Object)for(i in n)l(n,i)||t++;return t}function v(n){var i=[],t;if(n instanceof Object)for(t in n)t.toString().indexOf("__")==-1&&t.toString().indexOf("_")==0&&i.push(t);return i}function d(n){var t="";return n.__cdata!=null&&(t+="<![CDATA["+n.__cdata+"]\]>"),n.__text!=null&&(t+=e?c(n.__text):n.__text),t}function y(n){var t="";return n instanceof Object?t+=d(n):n!=null&&(t+=e?c(n):n),t}function g(n,t,i){var f="",r;if(n.length==0)f+=u(n,t,i,!0);else for(r=0;r<n.length;r++)f+=u(n[r],t,v(n[r]),!1),f+=s(n[r]),f+=o(n[r],t);return f}function s(n){var i="",h=a(n),r,t,f,e;if(h>0)for(r in n)l(n,r)||(t=n[r],f=v(t),t==null||t==undefined?i+=u(t,r,f,!0):t instanceof Object?t instanceof Array?i+=g(t,r,f):(e=a(t),e>0||t.__text!=null||t.__cdata!=null?(i+=u(t,r,f,!1),i+=s(t),i+=o(t,r)):i+=u(t,r,f,!0)):(i+=u(t,r,f,!1),i+=y(t),i+=o(t,r)));return i+y(n)}(t===null||t===undefined)&&(t="_");(i===null||i===undefined)&&(i=!1);var p="1.0.11",e=!1,r={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(n){var t,i;return window.DOMParser?(i=new window.DOMParser,t=i.parseFromString(n,"text/xml")):(n.indexOf("<?")==0&&(n=n.substr(n.indexOf("?>")+2)),t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(n)),t};this.xml2json=function(n){return f(n)};this.xml_str2json=function(n){var t=this.parseXmlString(n);return this.xml2json(t)};this.json2xml_str=function(n){return s(n)};this.json2xml=function(n){var t=this.json2xml_str(n);return this.parseXmlString(t)};this.getVersion=function(){return p};this.escapeMode=function(n){e=n}}var vjs,videojs,hasOwnProp,errNum,_backgroundSizeSupported,cx,UrlRewriter,UTF8,BASE64,btoa,atob,__extends,OnePlayer;for(document.createElement("video"),document.createElement("audio"),document.createElement("track"),vjs=function(n,t,i){var r;if(typeof n=="string"){if(n.indexOf("#")===0&&(n=n.slice(1)),vjs.players[n])return vjs.players[n];r=vjs.el(n)}else r=n;if(!r||!r.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return r.player||new vjs.Player(r,t,i)},videojs=window.videojs=vjs,vjs.CDN_VERSION="GENERATED_CDN_VSN",vjs.ACCESS_PROTOCOL="https:"==document.location.protocol?"https://":"http://",vjs.options={techOrder:["html5","flash"],html5:{},flash:{},width:300,height:150,defaultVolume:0,playbackRates:[],children:{mediaLoader:{},posterImage:{},textTrackDisplay:{},loadingSpinner:{},bigPlayButton:{},controlBar:{},errorDisplay:{}},language:document.getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language||"en",languages:{},notSupportedMessage:"No compatible source was found for this video."},vjs.CDN_VERSION!=="GENERATED_CDN_VSN"&&(videojs.options.flash.swf=vjs.ACCESS_PROTOCOL+"vjs.zencdn.net/"+vjs.CDN_VERSION+"/video-js.swf"),vjs.addLanguage=function(n,t){return vjs.options.languages[n]=vjs.options.languages[n]!==undefined?vjs.util.mergeOptions(vjs.options.languages[n],t):t,vjs.options.languages},vjs.players={},typeof define=="function"&&define.amd?define([],function(){return videojs}):typeof exports=="object"&&typeof module=="object"&&(module.exports=videojs),vjs.CoreObject=vjs.CoreObject=function(){},vjs.CoreObject.extend=function(n){var r,t,i;n=n||{};r=n.init||n.init||this.prototype.init||this.prototype.init||function(){};t=function(){r.apply(this,arguments)};t.prototype=vjs.obj.create(this.prototype);t.prototype.constructor=t;t.extend=vjs.CoreObject.extend;t.create=vjs.CoreObject.create;for(i in n)n.hasOwnProperty(i)&&(t.prototype[i]=n[i]);return t},vjs.CoreObject.create=function(){var n=vjs.obj.create(this.prototype);return this.apply(n,arguments),n},vjs.on=function(n,t,i){if(vjs.obj.isArray(t))return _handleMultipleEvents(vjs.on,n,t,i);var r=vjs.getData(n);r.handlers||(r.handlers={});r.handlers[t]||(r.handlers[t]=[]);i.guid||(i.guid=vjs.guid++);r.handlers[t].push(i);r.dispatcher||(r.disabled=!1,r.dispatcher=function(t){var u,f,i,e;if(!r.disabled&&(t=vjs.fixEvent(t),u=r.handlers[t.type],u))for(f=u.slice(0),i=0,e=f.length;i<e;i++)if(t.isImmediatePropagationStopped())break;else f[i].call(n,t)});r.handlers[t].length==1&&(n.addEventListener?n.addEventListener(t,r.dispatcher):n.attachEvent&&n.attachEvent("on"+t,r.dispatcher))},vjs.off=function(n,t,i){var r,e,o,u,f;if(vjs.hasData(n)&&(r=vjs.getData(n),r.handlers)){if(vjs.obj.isArray(t))return _handleMultipleEvents(vjs.off,n,t,i);if(e=function(t){r.handlers[t]=[];vjs.cleanUpEvents(n,t)},!t){for(o in r.handlers)e(o);return}if(u=r.handlers[t],u){if(!i){e(t);return}if(i.guid)for(f=0;f<u.length;f++)u[f].guid===i.guid&&u.splice(f--,1);vjs.cleanUpEvents(n,t)}}},vjs.cleanUpEvents=function(n,t){var i=vjs.getData(n);i.handlers[t].length===0&&(delete i.handlers[t],n.removeEventListener?n.removeEventListener(t,i.dispatcher,!1):n.detachEvent&&n.detachEvent("on"+t,i.dispatcher));vjs.isEmpty(i.handlers)&&(delete i.handlers,delete i.dispatcher,delete i.disabled);vjs.isEmpty(i)&&vjs.removeData(n)},vjs.fixEvent=function(n){function f(){return!0}function e(){return!1}var t,u,i,r;if(!n||!n.isPropagationStopped){t=n||window.event;n={};for(u in t)u!=="layerX"&&u!=="layerY"&&u!=="keyboardEvent.keyLocation"&&(u=="returnValue"&&t.preventDefault||(n[u]=t[u]));n.target||(n.target=n.srcElement||document);n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement;n.preventDefault=function(){t.preventDefault&&t.preventDefault();n.returnValue=!1;n.isDefaultPrevented=f;n.defaultPrevented=!0};n.isDefaultPrevented=e;n.defaultPrevented=!1;n.stopPropagation=function(){t.stopPropagation&&t.stopPropagation();n.cancelBubble=!0;n.isPropagationStopped=f};n.isPropagationStopped=e;n.stopImmediatePropagation=function(){t.stopImmediatePropagation&&t.stopImmediatePropagation();n.isImmediatePropagationStopped=f;n.stopPropagation()};n.isImmediatePropagationStopped=e;n.clientX!=null&&(i=document.documentElement,r=document.body,n.pageX=n.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),n.pageY=n.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0));n.which=n.charCode||n.keyCode;n.button!=null&&(n.button=n.button&1?0:n.button&4?1:n.button&2?2:0)}return n},vjs.trigger=function(n,t){var u=vjs.hasData(n)?vjs.getData(n):{},i=n.parentNode||n.ownerDocument,r;return typeof t=="string"&&(t={type:t,target:n}),t=vjs.fixEvent(t),u.dispatcher&&u.dispatcher.call(n,t),i&&!t.isPropagationStopped()&&t.bubbles!==!1?vjs.trigger(i,t):i||t.defaultPrevented||(r=vjs.getData(t.target),t.target[t.type]&&(r.disabled=!0,typeof t.target[t.type]=="function"&&t.target[t.type](),r.disabled=!1)),!t.defaultPrevented},vjs.one=function(n,t,i){if(vjs.obj.isArray(t))return _handleMultipleEvents(vjs.one,n,t,i);var r=function(){vjs.off(n,t,r);i.apply(this,arguments)};r.guid=i.guid=i.guid||vjs.guid++;vjs.on(n,t,r)},hasOwnProp=Object.prototype.hasOwnProperty,vjs.createEl=function(n,t){var i;return n=n||"div",t=t||{},i=document.createElement(n),vjs.obj.each(t,function(n,t){n.indexOf("aria-")!==-1||n=="role"?i.setAttribute(n,t):i[n]=t}),i},vjs.capitalize=function(n){return n.charAt(0).toUpperCase()+n.slice(1)},vjs.obj={},vjs.obj.create=Object.create||function(n){function t(){}return t.prototype=n,new t},vjs.obj.each=function(n,t,i){for(var r in n)hasOwnProp.call(n,r)&&t.call(i||this,r,n[r])},vjs.obj.merge=function(n,t){if(!t)return n;for(var i in t)hasOwnProp.call(t,i)&&(n[i]=t[i]);return n},vjs.obj.deepMerge=function(n,t){var i,r,u;n=vjs.obj.copy(n);for(i in t)hasOwnProp.call(t,i)&&(r=n[i],u=t[i],n[i]=vjs.obj.isPlain(r)&&vjs.obj.isPlain(u)?vjs.obj.deepMerge(r,u):t[i]);return n},vjs.obj.copy=function(n){return vjs.obj.merge({},n)},vjs.obj.isPlain=function(n){return!!n&&typeof n=="object"&&n.toString()==="[object Object]"&&n.constructor===Object},vjs.obj.isArray=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"},vjs.bind=function(n,t,i){t.guid||(t.guid=vjs.guid++);var r=function(){return t.apply(n,arguments)};return r.guid=i?i+"_"+t.guid:t.guid,r},vjs.cache={},vjs.guid=1,vjs.expando="vdata"+(new Date).getTime(),vjs.getData=function(n){var t=n[vjs.expando];return t||(t=n[vjs.expando]=vjs.guid++,vjs.cache[t]={}),vjs.cache[t]},vjs.hasData=function(n){var t=n[vjs.expando];return!(!t||vjs.isEmpty(vjs.cache[t]))},vjs.removeData=function(n){var t=n[vjs.expando];if(t){delete vjs.cache[t];try{delete n[vjs.expando]}catch(i){n.removeAttribute?n.removeAttribute(vjs.expando):n[vjs.expando]=null}}},vjs.isEmpty=function(n){for(var t in n)if(n[t]!==null)return!1;return!0},vjs.addClass=function(n,t){(" "+n.className+" ").indexOf(" "+t+" ")==-1&&(n.className=n.className===""?t:n.className+" "+t)},vjs.removeClass=function(n,t){var i,r;if(n.className.indexOf(t)!=-1){for(i=n.className.split(" "),r=i.length-1;r>=0;r--)i[r]===t&&i.splice(r,1);n.className=i.join(" ")}},vjs.TEST_VID=vjs.createEl("video"),vjs.USER_AGENT=navigator.userAgent,vjs.IS_IPHONE=/iPhone/i.test(vjs.USER_AGENT),vjs.IS_IPAD=/iPad/i.test(vjs.USER_AGENT),vjs.IS_IPOD=/iPod/i.test(vjs.USER_AGENT),vjs.IS_IOS=vjs.IS_IPHONE||vjs.IS_IPAD||vjs.IS_IPOD,vjs.IOS_VERSION=function(){var n=vjs.USER_AGENT.match(/OS (\d+)_/i);if(n&&n[1])return n[1]}(),vjs.IS_ANDROID=/Android/i.test(vjs.USER_AGENT),vjs.ANDROID_VERSION=function(){var n=vjs.USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),t,i;return n?(t=n[1]&&parseFloat(n[1]),i=n[2]&&parseFloat(n[2]),t&&i?parseFloat(n[1]+"."+n[2]):t?t:null):null}(),vjs.IS_OLD_ANDROID=vjs.IS_ANDROID&&/webkit/i.test(vjs.USER_AGENT)&&vjs.ANDROID_VERSION<2.3,vjs.IS_FIREFOX=/Firefox/i.test(vjs.USER_AGENT),vjs.IS_CHROME=/Chrome/i.test(vjs.USER_AGENT),vjs.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),vjs.setElementAttributes=function(n,t){vjs.obj.each(t,function(t,i){i===null||typeof i=="undefined"||i===!1?n.removeAttribute(t):n.setAttribute(t,i===!0?"":i)})},vjs.getElementAttributes=function(n){var f,e,i,r,u,t;if(f={},e=",autoplay,controls,loop,muted,default,",n&&n.attributes&&n.attributes.length>0)for(i=n.attributes,t=i.length-1;t>=0;t--)r=i[t].name,u=i[t].value,(typeof n[r]=="boolean"||e.indexOf(","+r+",")!==-1)&&(u=u!==null?!0:!1),f[r]=u;return f},vjs.getComputedDimension=function(n,t){var i="";return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(n,"").getPropertyValue(t):n.currentStyle&&(i=n["client"+t.substr(0,1).toUpperCase()+t.substr(1)]+"px"),i},vjs.insertFirst=function(n,t){t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},vjs.browser={},vjs.el=function(n){return n.indexOf("#")===0&&(n=n.slice(1)),document.getElementById(n)},vjs.formatTime=function(n,t){t=t||n;var i=Math.floor(n%60),r=Math.floor(n/60%60),u=Math.floor(n/3600),f=Math.floor(t/60%60),e=Math.floor(t/3600);return(isNaN(n)||n===Infinity)&&(u=r=i="-"),u=u>0||e>0?u+":":"",r=((u||f>=10)&&r<10?"0"+r:r)+":",i=i<10?"0"+i:i,u+r+i},vjs.blockTextSelection=function(){document.body.focus();document.onselectstart=function(){return!1}},vjs.unblockTextSelection=function(){document.onselectstart=function(){return!0}},vjs.trim=function(n){return(n+"").replace(/^\s+|\s+$/g,"")},vjs.round=function(n,t){return t||(t=0),Math.round(n*Math.pow(10,t))/Math.pow(10,t)},vjs.createTimeRange=function(n,t){return{length:1,start:function(){return n},end:function(){return t}}},vjs.get=function(n,t,i,r){var o,u,f,e,s;i=i||function(){};typeof XMLHttpRequest=="undefined"&&(window.XMLHttpRequest=function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(n){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(i){}throw new Error("This browser does not support XMLHttpRequest.");});u=new XMLHttpRequest;f=vjs.parseUrl(n);e=window.location;s=f.protocol+f.host!==e.protocol+e.host;!s||!window.XDomainRequest||"withCredentials"in u?(o=f.protocol=="file:"||e.protocol=="file:",u.onreadystatechange=function(){u.readyState===4&&(u.status===200||o&&u.status===0?t(u.responseText):i(u.responseText))}):(u=new window.XDomainRequest,u.onload=function(){t(u.responseText)},u.onerror=i,u.onprogress=function(){},u.ontimeout=i);try{u.open("GET",n,!0);r&&(u.withCredentials=!0)}catch(h){i(h);return}try{u.send()}catch(h){i(h)}},vjs.setLocalStorage=function(n,t){try{var r=window.localStorage||!1;if(!r)return;r[n]=t}catch(i){i.code==22||i.code==1014?vjs.log("LocalStorage Full (VideoJS)",i):i.code==18?vjs.log("LocalStorage not allowed (VideoJS)",i):vjs.log("LocalStorage Error (VideoJS)",i)}},vjs.getAbsoluteURL=function(n){return n.match(/^https?:\/\//)||(n=vjs.createEl("div",{innerHTML:'<a href="'+n+'">x<\/a>'}).firstChild.href),n},vjs.parseUrl=function(n){var t,i,f,u,e,r;for(u=["protocol","hostname","port","pathname","search","hash","host"],i=vjs.createEl("a",{href:n}),f=i.host===""&&i.protocol!=="file:",f&&(t=vjs.createEl("div"),t.innerHTML='<a href="'+n+'"><\/a>',i=t.firstChild,t.setAttribute("style","display:none; position:absolute;"),document.body.appendChild(t)),e={},r=0;r<u.length;r++)e[u[r]]=i[u[r]];return f&&document.body.removeChild(t),e},vjs.log=function(){_logType(null,arguments)},vjs.log.history=[],vjs.log.error=function(){_logType("error",arguments)},vjs.log.warn=function(){_logType("warn",arguments)},vjs.findPosition=function(n){var i,r,t,u,f,e,o,s,h;return(n.getBoundingClientRect&&n.parentNode&&(i=n.getBoundingClientRect()),!i)?{left:0,top:0}:(r=document.documentElement,t=document.body,u=r.clientLeft||t.clientLeft||0,f=window.pageXOffset||t.scrollLeft,e=i.left+f-u,o=r.clientTop||t.clientTop||0,s=window.pageYOffset||t.scrollTop,h=i.top+s-o,{left:vjs.round(e),top:vjs.round(h)})},vjs.arr={},vjs.arr.forEach=function(n,t,i){if(vjs.obj.isArray(n)&&t instanceof Function)for(var r=0,u=n.length;r<u;++r)t.call(i||vjs,n[r],r,n);return n},vjs.util={},vjs.util.mergeOptions=function(n,t){var i,r,u;n=vjs.obj.copy(n);for(i in t)t.hasOwnProperty(i)&&(r=n[i],u=t[i],n[i]=vjs.obj.isPlain(r)&&vjs.obj.isPlain(u)?vjs.util.mergeOptions(r,u):t[i]);return n},vjs.Component=vjs.CoreObject.extend({init:function(n,t,i){this.player_=n;this.options_=vjs.obj.copy(this.options_);t=this.options(t);this.id_=t.id||(t.el&&t.el.id?t.el.id:n.id()+"_component_"+vjs.guid++);this.name_=t.name||null;this.el_=t.el||this.createEl();this.children_=[];this.childIndex_={};this.childNameIndex_={};this.initChildren();this.ready(i);t.reportTouchActivity!==!1&&this.enableTouchActivity()}}),vjs.Component.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var n=this.children_.length-1;n>=0;n--)this.children_[n].dispose&&this.children_[n].dispose();this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.off();this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_);vjs.removeData(this.el_);this.el_=null},vjs.Component.prototype.player_=!0,vjs.Component.prototype.player=function(){return this.player_},vjs.Component.prototype.options_,vjs.Component.prototype.options=function(n){return n===undefined?this.options_:this.options_=vjs.util.mergeOptions(this.options_,n)},vjs.Component.prototype.el_,vjs.Component.prototype.createEl=function(n,t){return vjs.createEl(n,t)},vjs.Component.prototype.localize=function(n){var i=this.player_.language(),t=this.player_.languages();return t&&t[i]&&t[i][n]?t[i][n]:n},vjs.Component.prototype.el=function(){return this.el_},vjs.Component.prototype.contentEl_,vjs.Component.prototype.contentEl=function(){return this.contentEl_||this.el_},vjs.Component.prototype.id_,vjs.Component.prototype.id=function(){return this.id_},vjs.Component.prototype.name_,vjs.Component.prototype.name=function(){return this.name_},vjs.Component.prototype.children_,vjs.Component.prototype.children=function(){return this.children_},vjs.Component.prototype.childIndex_,vjs.Component.prototype.getChildById=function(n){return this.childIndex_[n]},vjs.Component.prototype.childNameIndex_,vjs.Component.prototype.getChild=function(n){return this.childNameIndex_[n]},vjs.Component.prototype.addChild=function(n,t){var i,u,r;return typeof n=="string"?(r=n,t=t||{},u=t.componentClass||vjs.capitalize(r),t.name=r,i=new window.videojs[u](this.player_||this,t)):i=n,this.children_.push(i),typeof i.id=="function"&&(this.childIndex_[i.id()]=i),r=r||i.name&&i.name(),r&&(this.childNameIndex_[r]=i),typeof i.el=="function"&&i.el()&&this.contentEl().appendChild(i.el()),i},vjs.Component.prototype.removeChild=function(n){var i,t,r;if(typeof n=="string"&&(n=this.getChild(n)),n&&this.children_){for(i=!1,t=this.children_.length-1;t>=0;t--)if(this.children_[t]===n){i=!0;this.children_.splice(t,1);break}i&&(this.childIndex_[n.id]=null,this.childNameIndex_[n.name]=null,r=n.el(),r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(n.el()))}},vjs.Component.prototype.initChildren=function(){var t,n,i,r,f,u;if(t=this,n=this.options().children,n)if(vjs.obj.isArray(n))for(u=0;u<n.length;u++)i=n[u],typeof i=="string"?(r=i,f={}):(r=i.name,f=i),t[r]=t.addChild(r,f);else vjs.obj.each(n,function(n,i){i!==!1&&(t[n]=t.addChild(n,i))})},vjs.Component.prototype.buildCSSClass=function(){return""},vjs.Component.prototype.on=function(n,t){vjs.on(this.el_,n,vjs.bind(this,t));return this},vjs.Component.prototype.off=function(n,t){return vjs.off(this.el_,n,t),this},vjs.Component.prototype.one=function(n,t){vjs.one(this.el_,n,vjs.bind(this,t));return this},vjs.Component.prototype.trigger=function(n){return vjs.trigger(this.el_,n),this},vjs.Component.prototype.isReady_,vjs.Component.prototype.isReadyOnInitFinish_=!0,vjs.Component.prototype.readyQueue_,vjs.Component.prototype.ready=function(n){return n&&(this.isReady_?n.call(this):(this.readyQueue_===undefined&&(this.readyQueue_=[]),this.readyQueue_.push(n))),this},vjs.Component.prototype.triggerReady=function(){var n,t,i;if(this.isReady_=!0,n=this.readyQueue_,n&&n.length>0){for(t=0,i=n.length;t<i;t++)n[t].call(this);this.readyQueue_=[];this.trigger("ready")}},vjs.Component.prototype.addClass=function(n){return vjs.addClass(this.el_,n),this},vjs.Component.prototype.removeClass=function(n){return vjs.removeClass(this.el_,n),this},vjs.Component.prototype.show=function(){return this.el_.style.display="block",this},vjs.Component.prototype.hide=function(){return this.el_.style.display="none",this},vjs.Component.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},vjs.Component.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},vjs.Component.prototype.disable=function(){this.hide();this.show=function(){}},vjs.Component.prototype.width=function(n,t){return this.dimension("width",n,t)},vjs.Component.prototype.height=function(n,t){return this.dimension("height",n,t)},vjs.Component.prototype.dimensions=function(n,t){return this.width(n,!0).height(t)},vjs.Component.prototype.dimension=function(n,t,i){if(t!==undefined)return this.el_.style[n]=(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?t:t==="auto"?"":t+"px",i||this.trigger("resize"),this;if(!this.el_)return 0;var r=this.el_.style[n],u=r.indexOf("px");return u!==-1?parseInt(r.slice(0,u),10):parseInt(this.el_["offset"+vjs.capitalize(n)],10)},vjs.Component.prototype.onResize,vjs.Component.prototype.emitTapEvents=function(){var i,n,e,t,r,u,f,o,s;i=0;n=null;s=22;this.on("touchstart",function(r){r.touches.length===1&&(n=r.touches[0],i=(new Date).getTime(),t=!0)});this.on("touchmove",function(i){i.touches.length>1?t=!1:n&&(u=i.touches[0].pageX-n.pageX,f=i.touches[0].pageY-n.pageY,o=Math.sqrt(u*u+f*f),o>s&&(t=!1))});r=function(){t=!1};this.on("touchleave",r);this.on("touchcancel",r);this.on("touchend",function(r){n=null;t===!0&&(e=(new Date).getTime()-i,e<250&&(r.preventDefault(),this.trigger("tap")))})},vjs.Component.prototype.enableTouchActivity=function(){var n,t,i;n=vjs.bind(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){n();clearInterval(t);t=setInterval(n,250)});i=function(){n();clearInterval(t)};this.on("touchmove",n);this.on("touchend",i);this.on("touchcancel",i)},vjs.Button=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.emitTapEvents();this.on("tap",this.onClick);this.on("click",this.onClick);this.on("focus",this.onFocus);this.on("blur",this.onBlur)}}),vjs.Button.prototype.createEl=function(n,t){var i;return t=vjs.obj.merge({className:this.buildCSSClass(),role:"button","aria-live":"polite",tabIndex:0},t),i=vjs.Component.prototype.createEl.call(this,n,t),t.innerHTML||(this.contentEl_=vjs.createEl("div",{className:"vjs-control-content"}),this.controlText_=vjs.createEl("span",{className:"vjs-control-text",innerHTML:this.localize(this.buttonText)||"Need Text"}),this.contentEl_.appendChild(this.controlText_),i.appendChild(this.contentEl_)),i},vjs.Button.prototype.buildCSSClass=function(){return"vjs-control "+vjs.Component.prototype.buildCSSClass.call(this)},vjs.Button.prototype.onClick=function(){},vjs.Button.prototype.onFocus=function(){vjs.on(document,"keydown",vjs.bind(this,this.onKeyPress))},vjs.Button.prototype.onKeyPress=function(n){(n.which==32||n.which==13)&&(n.preventDefault(),this.onClick())},vjs.Button.prototype.onBlur=function(){vjs.off(document,"keydown",vjs.bind(this,this.onKeyPress))},vjs.Slider=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.bar=this.getChild(this.options_.barName);this.handle=this.getChild(this.options_.handleName);this.on("mousedown",this.onMouseDown);this.on("touchstart",this.onMouseDown);this.on("focus",this.onFocus);this.on("blur",this.onBlur);this.on("click",this.onClick);this.player_.on("controlsvisible",vjs.bind(this,this.update));n.on(this.playerEvent,vjs.bind(this,this.update));this.boundEvents={};this.boundEvents.move=vjs.bind(this,this.onMouseMove);this.boundEvents.end=vjs.bind(this,this.onMouseUp)}}),vjs.Slider.prototype.createEl=function(n,t){return t=t||{},t.className=t.className+" vjs-slider",t=vjs.obj.merge({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},t),vjs.Component.prototype.createEl.call(this,n,t)},vjs.Slider.prototype.onMouseDown=function(n){n.preventDefault();vjs.blockTextSelection();this.addClass("vjs-sliding");vjs.on(document,"mousemove",this.boundEvents.move);vjs.on(document,"mouseup",this.boundEvents.end);vjs.on(document,"touchmove",this.boundEvents.move);vjs.on(document,"touchend",this.boundEvents.end);this.onMouseMove(n)},vjs.Slider.prototype.onMouseMove=function(){},vjs.Slider.prototype.onMouseUp=function(){vjs.unblockTextSelection();this.removeClass("vjs-sliding");vjs.off(document,"mousemove",this.boundEvents.move,!1);vjs.off(document,"mouseup",this.boundEvents.end,!1);vjs.off(document,"touchmove",this.boundEvents.move,!1);vjs.off(document,"touchend",this.boundEvents.end,!1);this.update()},vjs.Slider.prototype.update=function(){if(this.el_){var t,n=this.getPercent(),i=this.handle,r=this.bar;if(isNaN(n)&&(n=0),t=n,i){var o=this.el_,s=o.offsetWidth,u=i.el().offsetWidth,f=u?u/s:0,h=1-f,e=n*h;t=e+f/2;i.el().style.left=vjs.round(e*100,2)+"%"}r&&(r.el().style.width=vjs.round(t*100,2)+"%")}},vjs.Slider.prototype.calculateDistance=function(n){var e,o,r,u,f,t,i,c,l,s,h;return e=this.el_,o=vjs.findPosition(e),f=t=e.offsetWidth,i=this.handle,this.options().vertical?(u=o.top,l=n.changedTouches?n.changedTouches[0].pageY:n.pageY,i&&(s=i.el().offsetHeight,u=u+s/2,t=t-s),Math.max(0,Math.min(1,(u-l+t)/t))):(r=o.left,c=n.changedTouches?n.changedTouches[0].pageX:n.pageX,i&&(h=i.el().offsetWidth,r=r+h/2,f=f-h),Math.max(0,Math.min(1,(c-r)/f)))},vjs.Slider.prototype.onFocus=function(){vjs.on(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Slider.prototype.onKeyPress=function(n){n.which==37||n.which==40?(n.preventDefault(),this.stepBack()):(n.which==38||n.which==39)&&(n.preventDefault(),this.stepForward())},vjs.Slider.prototype.onBlur=function(){vjs.off(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Slider.prototype.onClick=function(n){n.stopImmediatePropagation();n.preventDefault()},vjs.SliderHandle=vjs.Component.extend(),vjs.SliderHandle.prototype.defaultValue=0,vjs.SliderHandle.prototype.createEl=function(n,t){return t=t||{},t.className=t.className+" vjs-slider-handle",t=vjs.obj.merge({innerHTML:'<span class="vjs-control-text">'+this.defaultValue+"<\/span>"},t),vjs.Component.prototype.createEl.call(this,"div",t)},vjs.Menu=vjs.Component.extend(),vjs.Menu.prototype.addItem=function(n){this.addChild(n);n.on("click",vjs.bind(this,function(){this.unlockShowing()}))},vjs.Menu.prototype.createEl=function(){var t=this.options().contentElType||"ul",n;this.contentEl_=vjs.createEl(t,{className:"vjs-menu-content"});n=vjs.Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});n.appendChild(this.contentEl_);vjs.on(n,"click",function(n){n.preventDefault();n.stopImmediatePropagation()});return n},vjs.MenuItem=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);this.selected(t.selected)}}),vjs.MenuItem.prototype.createEl=function(n,t){return vjs.Button.prototype.createEl.call(this,"li",vjs.obj.merge({className:"vjs-menu-item",innerHTML:this.options_.label},t))},vjs.MenuItem.prototype.onClick=function(){this.selected(!0)},vjs.MenuItem.prototype.selected=function(n){n?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-selected",!0)):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-selected",!1))},vjs.MenuButton=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);this.menu=this.createMenu();this.addChild(this.menu);this.items&&this.items.length===0&&this.hide();this.on("keyup",this.onKeyPress);this.el_.setAttribute("aria-haspopup",!0);this.el_.setAttribute("role","button")}}),vjs.MenuButton.prototype.buttonPressed_=!1,vjs.MenuButton.prototype.createMenu=function(){var t=new vjs.Menu(this.player_),n;if(this.options().title&&t.contentEl().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.options().title),tabindex:-1})),this.items=this.createItems(),this.items)for(n=0;n<this.items.length;n++)t.addItem(this.items[n]);return t},vjs.MenuButton.prototype.createItems=function(){},vjs.MenuButton.prototype.buildCSSClass=function(){return this.className+" vjs-menu-button "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.MenuButton.prototype.onFocus=function(){},vjs.MenuButton.prototype.onBlur=function(){},vjs.MenuButton.prototype.onClick=function(){this.one("mouseout",vjs.bind(this,function(){this.menu.unlockShowing();this.el_.blur()}));this.buttonPressed_?this.unpressButton():this.pressButton()},vjs.MenuButton.prototype.onKeyPress=function(n){n.preventDefault();n.which==32||n.which==13?this.buttonPressed_?this.unpressButton():this.pressButton():n.which==27&&this.buttonPressed_&&this.unpressButton()},vjs.MenuButton.prototype.pressButton=function(){this.buttonPressed_=!0;this.menu.lockShowing();this.el_.setAttribute("aria-pressed",!0);this.items&&this.items.length>0&&this.items[0].el().focus()},vjs.MenuButton.prototype.unpressButton=function(){this.buttonPressed_=!1;this.menu.unlockShowing();this.el_.setAttribute("aria-pressed",!1)},vjs.MediaError=function(n){typeof n=="number"?this.code=n:typeof n=="string"?this.message=n:typeof n=="object"&&vjs.obj.merge(this,n);this.message||(this.message=vjs.MediaError.defaultMessages[this.code]||"")},vjs.MediaError.prototype.code=0,vjs.MediaError.prototype.message="",vjs.MediaError.prototype.status=null,vjs.MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],vjs.MediaError.defaultMessages={1:"You aborted the video playback",2:"A network error caused the video download to fail part-way.",3:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",4:"The video could not be loaded, either because the server or network failed or because the format is not supported.",5:"The video is encrypted and we do not have the keys to decrypt it."},errNum=0;errNum<vjs.MediaError.errorTypes.length;errNum++)vjs.MediaError[vjs.MediaError.errorTypes[errNum]]=errNum,vjs.MediaError.prototype[vjs.MediaError.errorTypes[errNum]]=errNum;if(function(){var t,r,i,n;for(vjs.browser.fullscreenAPI,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=t[0],n=0;n<t.length;n++)if(t[n][1]in document){i=t[n];break}if(i)for(vjs.browser.fullscreenAPI={},n=0;n<i.length;n++)vjs.browser.fullscreenAPI[r[n]]=i[n]}(),vjs.Player=vjs.Component.extend({init:function(n,t,i){this.tag=n;n.id=n.id||"vjs_video_"+vjs.guid++;this.tagAttributes=n&&vjs.getElementAttributes(n);t=vjs.obj.merge(this.getTagSettings(n),t);this.language_=t.language||vjs.options.language;this.languages_=t.languages||vjs.options.languages;this.cache_={};this.poster_=t.poster;this.controls_=t.controls;n.controls=!1;t.reportTouchActivity=!1;vjs.Component.call(this,this,t,i);this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled");vjs.players[this.id_]=this;t.plugins&&vjs.obj.each(t.plugins,function(n,t){this[n](t)},this);this.listenForUserActivity()}}),vjs.Player.prototype.language_,vjs.Player.prototype.language=function(n){return n===undefined?this.language_:(this.language_=n,this)},vjs.Player.prototype.languages_,vjs.Player.prototype.languages=function(){return this.languages_},vjs.Player.prototype.options_=vjs.options,vjs.Player.prototype.dispose=function(){this.trigger("dispose");this.off("dispose");vjs.players[this.id_]=null;this.tag&&this.tag.player&&(this.tag.player=null);this.el_&&this.el_.player&&(this.el_.player=null);this.tech&&this.tech.dispose();vjs.Component.prototype.dispose.call(this)},vjs.Player.prototype.getTagSettings=function(n){var t={sources:[],tracks:[]},u,i,f,r,e;if(vjs.obj.merge(t,vjs.getElementAttributes(n)),n.hasChildNodes())for(u=n.childNodes,r=0,e=u.length;r<e;r++)i=u[r],f=i.nodeName.toLowerCase(),f==="source"?t.sources.push(vjs.getElementAttributes(i)):f==="track"&&t.tracks.push(vjs.getElementAttributes(i));return t},vjs.Player.prototype.createEl=function(){var t=this.el_=vjs.Component.prototype.createEl.call(this,"div"),n=this.tag,u,f,e,i,o,s,r;if(n.removeAttribute("width"),n.removeAttribute("height"),n.hasChildNodes()){for(f=n.childNodes,e=f.length,r=[];e--;)o=f[e],s=o.nodeName.toLowerCase(),s==="track"&&r.push(o);for(i=0;i<r.length;i++)n.removeChild(r[i])}u=vjs.getElementAttributes(n);vjs.obj.each(u,function(n){t.setAttribute(n,u[n])});n.id+="_html5_api";n.className="vjs-tech";n.player=t.player=this;this.addClass("vjs-paused");this.width(this.options_.width,!0);this.height(this.options_.height,!0);n.parentNode&&n.parentNode.insertBefore(t,n);vjs.insertFirst(n,t);this.el_=t;this.on("loadstart",this.onLoadStart);this.on("waiting",this.onWaiting);this.on(["canplay","canplaythrough","playing","ended"],this.onWaitEnd);this.on("seeking",this.onSeeking);this.on("seeked",this.onSeeked);this.on("ended",this.onEnded);this.on("play",this.onPlay);this.on("firstplay",this.onFirstPlay);this.on("pause",this.onPause);this.on("progress",this.onProgress);this.on("durationchange",this.onDurationChange);this.on("fullscreenchange",this.onFullscreenChange);return t},vjs.Player.prototype.loadTech=function(n,t){this.tech&&this.unloadTech();n!=="Html5"&&this.tag&&(vjs.Html5.disposeMediaElement(this.tag),this.tag=null);this.techName=n;this.isReady_=!1;var r=function(){this.player_.triggerReady()},i=vjs.obj.merge({source:t,parentEl:this.el_},this.options_[n.toLowerCase()]);t&&(this.currentType_=t.type,t.src==this.cache_.src&&this.cache_.currentTime>0&&(i.startTime=this.cache_.currentTime),this.cache_.src=t.src);this.tech=new window.videojs[n](this,i);this.tech.ready(r)},vjs.Player.prototype.unloadTech=function(){this.isReady_=!1;this.tech.dispose();this.tech=!1},vjs.Player.prototype.onLoadStart=function(){if(this.error(null),this.paused()){this.hasStarted(!1);this.one("play",function(){this.hasStarted(!0)})}else this.trigger("firstplay")},vjs.Player.prototype.hasStarted_=!1,vjs.Player.prototype.hasStarted=function(n){return n!==undefined?(this.hasStarted_!==n&&(this.hasStarted_=n,n?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started")),this):this.hasStarted_},vjs.Player.prototype.onLoadedMetaData,vjs.Player.prototype.onLoadedData,vjs.Player.prototype.onLoadedAllData,vjs.Player.prototype.onPlay=function(){this.removeClass("vjs-paused");this.addClass("vjs-playing")},vjs.Player.prototype.onWaiting=function(){this.addClass("vjs-waiting")},vjs.Player.prototype.onWaitEnd=function(){this.removeClass("vjs-waiting")},vjs.Player.prototype.onSeeking=function(){this.addClass("vjs-seeking")},vjs.Player.prototype.onSeeked=function(){this.removeClass("vjs-seeking")},vjs.Player.prototype.onFirstPlay=function(){this.options_.starttime&&this.currentTime(this.options_.starttime);this.addClass("vjs-has-started")},vjs.Player.prototype.onPause=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused")},vjs.Player.prototype.onTimeUpdate,vjs.Player.prototype.onProgress=function(){this.bufferedPercent()==1&&this.trigger("loadedalldata")},vjs.Player.prototype.onEnded=function(){this.options_.loop&&(this.currentTime(0),this.play())},vjs.Player.prototype.onDurationChange=function(){var n=this.techGet("duration");n&&(n<0&&(n=Infinity),this.duration(n),n===Infinity?this.addClass("vjs-live"):this.removeClass("vjs-live"))},vjs.Player.prototype.onVolumeChange,vjs.Player.prototype.onFullscreenChange=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},vjs.Player.prototype.cache_,vjs.Player.prototype.getCache=function(){return this.cache_},vjs.Player.prototype.techCall=function(n,t){if(this.tech&&!this.tech.isReady_)this.tech.ready(function(){this[n](t)});else try{this.tech[n](t)}catch(i){vjs.log(i);throw i;}},vjs.Player.prototype.techGet=function(n){if(this.tech&&this.tech.isReady_)try{return this.tech[n]()}catch(t){this.tech[n]===undefined?vjs.log("Video.js: "+n+" method not defined for "+this.techName+" playback technology.",t):t.name=="TypeError"?(vjs.log("Video.js: "+n+" unavailable on "+this.techName+" playback technology element.",t),this.tech.isReady_=!1):vjs.log(t);throw t;}return},vjs.Player.prototype.play=function(){return this.techCall("play"),this},vjs.Player.prototype.pause=function(){return this.techCall("pause"),this},vjs.Player.prototype.paused=function(){return this.techGet("paused")===!1?!1:!0},vjs.Player.prototype.currentTime=function(n){return n!==undefined?(this.techCall("setCurrentTime",n),this):this.cache_.currentTime=this.techGet("currentTime")||0},vjs.Player.prototype.duration=function(n){return n!==undefined?(this.cache_.duration=parseFloat(n),this):(this.cache_.duration===undefined&&this.onDurationChange(),this.cache_.duration||0)},vjs.Player.prototype.remainingTime=function(){return this.duration()-this.currentTime()},vjs.Player.prototype.buffered=function(){var n=this.techGet("buffered");return n&&n.length||(n=vjs.createTimeRange(0,0)),n},vjs.Player.prototype.bufferedPercent=function(){var t=this.duration(),r=this.buffered(),u=0,f,i,n;if(!t)return 0;for(n=0;n<r.length;n++)f=r.start(n),i=r.end(n),i>t&&(i=t),u+=i-f;return u/t},vjs.Player.prototype.bufferedEnd=function(){var t=this.buffered(),i=this.duration(),n=t.end(t.length-1);return n>i&&(n=i),n},vjs.Player.prototype.volume=function(n){var t;return n!==undefined?(t=Math.max(0,Math.min(1,parseFloat(n))),this.cache_.volume=t,this.techCall("setVolume",t),vjs.setLocalStorage("volume",t),this):(t=parseFloat(this.techGet("volume")),isNaN(t)?1:t)},vjs.Player.prototype.muted=function(n){return n!==undefined?(this.techCall("setMuted",n),this):this.techGet("muted")||!1},vjs.Player.prototype.supportsFullScreen=function(){return this.techGet("supportsFullScreen")||!1},vjs.Player.prototype.isFullscreen_=!1,vjs.Player.prototype.isFullscreen=function(n){return n!==undefined?(this.isFullscreen_=!!n,this):this.isFullscreen_},vjs.Player.prototype.isFullScreen=function(n){return vjs.log.warn('player.isFullScreen() has been deprecated, use player.isFullscreen() with a lowercase "s")'),this.isFullscreen(n)},vjs.Player.prototype.requestFullscreen=function(){var n=vjs.browser.fullscreenAPI;if(this.isFullscreen(!0),n){vjs.on(document,n.fullscreenchange,vjs.bind(this,function(){this.isFullscreen(document[n.fullscreenElement]);this.isFullscreen()===!1&&vjs.off(document,n.fullscreenchange,arguments.callee);this.trigger("fullscreenchange")}));this.el_[n.requestFullscreen]()}else this.tech.supportsFullScreen()?this.techCall("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"));return this},vjs.Player.prototype.requestFullScreen=function(){return vjs.log.warn('player.requestFullScreen() has been deprecated, use player.requestFullscreen() with a lowercase "s")'),this.requestFullscreen()},vjs.Player.prototype.exitFullscreen=function(){var n=vjs.browser.fullscreenAPI;return this.isFullscreen(!1),n?document[n.exitFullscreen]():this.tech.supportsFullScreen()?this.techCall("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.cancelFullScreen=function(){return vjs.log.warn("player.cancelFullScreen() has been deprecated, use player.exitFullscreen()"),this.exitFullscreen()},vjs.Player.prototype.enterFullWindow=function(){this.isFullWindow=!0;this.docOrigOverflow=document.documentElement.style.overflow;vjs.on(document,"keydown",vjs.bind(this,this.fullWindowOnEscKey));document.documentElement.style.overflow="hidden";vjs.addClass(document.body,"vjs-full-window");this.trigger("enterFullWindow")},vjs.Player.prototype.fullWindowOnEscKey=function(n){n.keyCode===27&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},vjs.Player.prototype.exitFullWindow=function(){this.isFullWindow=!1;vjs.off(document,"keydown",this.fullWindowOnEscKey);document.documentElement.style.overflow=this.docOrigOverflow;vjs.removeClass(document.body,"vjs-full-window");this.trigger("exitFullWindow")},vjs.Player.prototype.selectSource=function(n){for(var i,r,u,e,o,t=0,f=this.options_.techOrder;t<f.length;t++){if(i=vjs.capitalize(f[t]),r=window.videojs[i],!r){vjs.log.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.');continue}if(r.isSupported())for(u=0,e=n;u<e.length;u++)if(o=e[u],r.canPlaySource(o))return{source:o,tech:i}}return!1},vjs.Player.prototype.src=function(n){return n===undefined?this.techGet("src"):(vjs.obj.isArray(n)?this.sourceList_(n):typeof n=="string"?this.src({src:n}):n instanceof Object&&(n.type&&!window.videojs[this.techName].canPlaySource(n)?this.sourceList_([n]):(this.cache_.src=n.src,this.currentType_=n.type||"",this.ready(function(){this.techCall("src",n.src);this.options_.preload=="auto"&&this.load();this.options_.autoplay&&this.play()}))),this)},vjs.Player.prototype.sourceList_=function(n){var t=this.selectSource(n);t?t.tech===this.techName?this.src(t.source):this.loadTech(t.tech,t.source):(this.error({code:4,message:this.localize(this.options().notSupportedMessage)}),this.triggerReady())},vjs.Player.prototype.load=function(){return this.techCall("load"),this},vjs.Player.prototype.currentSrc=function(){return this.techGet("currentSrc")||this.cache_.src||""},vjs.Player.prototype.currentType=function(){return this.currentType_||""},vjs.Player.prototype.preload=function(n){return n!==undefined?(this.techCall("setPreload",n),this.options_.preload=n,this):this.techGet("preload")},vjs.Player.prototype.autoplay=function(n){return n!==undefined?(this.techCall("setAutoplay",n),this.options_.autoplay=n,this):this.techGet("autoplay",n)},vjs.Player.prototype.loop=function(n){return n!==undefined?(this.techCall("setLoop",n),this.options_.loop=n,this):this.techGet("loop")},vjs.Player.prototype.poster_,vjs.Player.prototype.poster=function(n){if(n===undefined)return this.poster_;this.poster_=n;this.techCall("setPoster",n);this.trigger("posterchange")},vjs.Player.prototype.controls_,vjs.Player.prototype.controls=function(n){return n!==undefined?(n=!!n,this.controls_!==n&&(this.controls_=n,n?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled")):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"))),this):this.controls_},vjs.Player.prototype.usingNativeControls_,vjs.Player.prototype.usingNativeControls=function(n){return n!==undefined?(n=!!n,this.usingNativeControls_!==n&&(this.usingNativeControls_=n,n?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):this.usingNativeControls_},vjs.Player.prototype.error_=null,vjs.Player.prototype.error=function(n){return n===undefined?this.error_:n===null?(this.error_=n,this.removeClass("vjs-error"),this):(this.error_=n instanceof vjs.MediaError?n:new vjs.MediaError(n),this.trigger("error"),this.addClass("vjs-error"),vjs.log.error("(CODE:"+this.error_.code+" "+vjs.MediaError.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this)},vjs.Player.prototype.ended=function(){return this.techGet("ended")},vjs.Player.prototype.seeking=function(){return this.techGet("seeking")},vjs.Player.prototype.userActivity_=!0,vjs.Player.prototype.reportUserActivity=function(){this.userActivity_=!0},vjs.Player.prototype.userActive_=!0,vjs.Player.prototype.userActive=function(n){if(n!==undefined){if(n=!!n,n!==this.userActive_)if(this.userActive_=n,n)this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");else{if(this.userActivity_=!1,this.tech)this.tech.one("mousemove",function(n){n.stopPropagation();n.preventDefault()});this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")}return this}return this.userActive_},vjs.Player.prototype.listenForUserActivity=function(){var n,r,u,t,f,e,i,o,s;n=vjs.bind(this,this.reportUserActivity);r=function(t){(t.screenX!=o||t.screenY!=s)&&(o=t.screenX,s=t.screenY,n())};u=function(){n();clearInterval(t);t=setInterval(n,250)};f=function(){n();clearInterval(t)};this.on("mousedown",u);this.on("mousemove",r);this.on("mouseup",f);this.on("keydown",n);this.on("keyup",n);e=setInterval(vjs.bind(this,function(){this.userActivity_&&(this.userActivity_=!1,this.userActive(!0),clearTimeout(i),i=setTimeout(vjs.bind(this,function(){this.userActivity_||this.userActive(!1)}),2e3))}),250);this.on("dispose",function(){clearInterval(e);clearTimeout(i)})},vjs.Player.prototype.playbackRate=function(n){return n!==undefined?(this.techCall("setPlaybackRate",n),this):this.tech&&this.tech.features&&this.tech.features.playbackRate?this.techGet("playbackRate"):1},vjs.ControlBar=vjs.Component.extend(),vjs.ControlBar.prototype.options_={loadEvent:"play",children:{playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},liveDisplay:{},progressControl:{},fullscreenToggle:{},volumeControl:{},muteToggle:{},playbackRateMenuButton:{}}},vjs.ControlBar.prototype.createEl=function(){return vjs.createEl("div",{className:"vjs-control-bar"})},vjs.LiveDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.LiveDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-live-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"<\/span>"+this.localize("LIVE"),"aria-live":"off"}),n.appendChild(this.contentEl_),n},vjs.PlayToggle=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);n.on("play",vjs.bind(this,this.onPlay));n.on("pause",vjs.bind(this,this.onPause))}}),vjs.PlayToggle.prototype.buttonText="Play",vjs.PlayToggle.prototype.buildCSSClass=function(){return"vjs-play-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.PlayToggle.prototype.onClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},vjs.PlayToggle.prototype.onPlay=function(){vjs.removeClass(this.el_,"vjs-paused");vjs.addClass(this.el_,"vjs-playing");this.el_.children[0].children[0].innerHTML=this.localize("Pause")},vjs.PlayToggle.prototype.onPause=function(){vjs.removeClass(this.el_,"vjs-playing");vjs.addClass(this.el_,"vjs-paused");this.el_.children[0].children[0].innerHTML=this.localize("Play")},vjs.CurrentTimeDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);n.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.CurrentTimeDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time <\/span>0:00',"aria-live":"off"}),n.appendChild(this.contentEl_),n},vjs.CurrentTimeDisplay.prototype.updateContent=function(){var n=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Current Time")+"<\/span> "+vjs.formatTime(n,this.player_.duration())},vjs.DurationDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);n.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.DurationDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Duration Time")+"<\/span> 0:00","aria-live":"off"}),n.appendChild(this.contentEl_),n},vjs.DurationDisplay.prototype.updateContent=function(){var n=this.player_.duration();n&&(this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Duration Time")+"<\/span> "+vjs.formatTime(n))},vjs.TimeDivider=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.TimeDivider.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-time-divider",innerHTML:"<div><span>/<\/span><\/div>"})},vjs.RemainingTimeDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);n.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.RemainingTimeDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"<\/span> -0:00","aria-live":"off"}),n.appendChild(this.contentEl_),n},vjs.RemainingTimeDisplay.prototype.updateContent=function(){this.player_.duration()&&(this.contentEl_.innerHTML='<span class="vjs-control-text">'+this.localize("Remaining Time")+"<\/span> -"+vjs.formatTime(this.player_.remainingTime()))},vjs.FullscreenToggle=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t)}}),vjs.FullscreenToggle.prototype.buttonText="Fullscreen",vjs.FullscreenToggle.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.FullscreenToggle.prototype.onClick=function(){this.player_.isFullscreen()?(this.player_.exitFullscreen(),this.controlText_.innerHTML=this.localize("Fullscreen")):(this.player_.requestFullscreen(),this.controlText_.innerHTML=this.localize("Non-Fullscreen"))},vjs.ProgressControl=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.ProgressControl.prototype.options_={children:{seekBar:{}}},vjs.ProgressControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},vjs.SeekBar=vjs.Slider.extend({init:function(n,t){vjs.Slider.call(this,n,t);n.on("timeupdate",vjs.bind(this,this.updateARIAAttributes));n.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.SeekBar.prototype.options_={children:{loadProgressBar:{},playProgressBar:{},seekHandle:{}},barName:"playProgressBar",handleName:"seekHandle"},vjs.SeekBar.prototype.playerEvent="timeupdate",vjs.SeekBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder","aria-label":"video progress bar"})},vjs.SeekBar.prototype.updateARIAAttributes=function(){var n=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("aria-valuenow",vjs.round(this.getPercent()*100,2));this.el_.setAttribute("aria-valuetext",vjs.formatTime(n,this.player_.duration()))},vjs.SeekBar.prototype.getPercent=function(){return this.player_.currentTime()/this.player_.duration()},vjs.SeekBar.prototype.onMouseDown=function(n){vjs.Slider.prototype.onMouseDown.call(this,n);this.player_.scrubbing=!0;this.videoWasPlaying=!this.player_.paused();this.player_.pause()},vjs.SeekBar.prototype.onMouseMove=function(n){var t=this.calculateDistance(n)*this.player_.duration();t==this.player_.duration()&&(t=t-.1);this.player_.currentTime(t)},vjs.SeekBar.prototype.onMouseUp=function(n){vjs.Slider.prototype.onMouseUp.call(this,n);this.player_.scrubbing=!1;this.videoWasPlaying&&this.player_.play()},vjs.SeekBar.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},vjs.SeekBar.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},vjs.LoadProgressBar=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);n.on("progress",vjs.bind(this,this.update))}}),vjs.LoadProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"<\/span>: 0%<\/span>"})},vjs.LoadProgressBar.prototype.update=function(){var n,r,o,t,i=this.player_.buffered(),s=this.player_.duration(),u=this.player_.bufferedEnd(),f=this.el_.children,e=function(n,t){var i=n/t||0;return i*100+"%"};for(this.el_.style.width=e(u,s),n=0;n<i.length;n++)r=i.start(n),o=i.end(n),t=f[n],t||(t=this.el_.appendChild(vjs.createEl())),t.style.left=e(r,u),t.style.width=e(o-r,u);for(n=f.length;n>i.length;n--)this.el_.removeChild(f[n-1])},vjs.PlayProgressBar=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.PlayProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"<\/span>: 0%<\/span>"})},vjs.SeekHandle=vjs.SliderHandle.extend({init:function(n,t){vjs.SliderHandle.call(this,n,t);n.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.SeekHandle.prototype.defaultValue="00:00",vjs.SeekHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-seek-handle","aria-live":"off"})},vjs.SeekHandle.prototype.updateContent=function(){var n=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.innerHTML='<span class="vjs-control-text">'+vjs.formatTime(n,this.player_.duration())+"<\/span>"},vjs.VolumeControl=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);n.tech&&n.tech.features&&n.tech.features.volumeControl===!1&&this.addClass("vjs-hidden");n.on("loadstart",vjs.bind(this,function(){n.tech.features&&n.tech.features.volumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}))}}),vjs.VolumeControl.prototype.options_={children:{volumeBar:{}}},vjs.VolumeControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"})},vjs.VolumeBar=vjs.Slider.extend({init:function(n,t){vjs.Slider.call(this,n,t);n.on("volumechange",vjs.bind(this,this.updateARIAAttributes));n.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.VolumeBar.prototype.updateARIAAttributes=function(){this.el_.setAttribute("aria-valuenow",vjs.round(this.player_.volume()*100,2));this.el_.setAttribute("aria-valuetext",vjs.round(this.player_.volume()*100,2)+"%")},vjs.VolumeBar.prototype.options_={children:{volumeLevel:{},volumeHandle:{}},barName:"volumeLevel",handleName:"volumeHandle"},vjs.VolumeBar.prototype.playerEvent="volumechange",vjs.VolumeBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar","aria-label":"volume level"})},vjs.VolumeBar.prototype.onMouseMove=function(n){this.player_.muted()&&this.player_.muted(!1);this.player_.volume(this.calculateDistance(n))},vjs.VolumeBar.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},vjs.VolumeBar.prototype.stepForward=function(){this.player_.volume(this.player_.volume()+.1)},vjs.VolumeBar.prototype.stepBack=function(){this.player_.volume(this.player_.volume()-.1)},vjs.VolumeLevel=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.VolumeLevel.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"><\/span>'})},vjs.VolumeHandle=vjs.SliderHandle.extend(),vjs.VolumeHandle.prototype.defaultValue="00:00",vjs.VolumeHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-volume-handle"})},vjs.MuteToggle=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);n.on("volumechange",vjs.bind(this,this.update));n.tech&&n.tech.features&&n.tech.features.volumeControl===!1&&this.addClass("vjs-hidden");n.on("loadstart",vjs.bind(this,function(){n.tech.features&&n.tech.features.volumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}))}}),vjs.MuteToggle.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.localize("Mute")+"<\/span><\/div>"})},vjs.MuteToggle.prototype.onClick=function(){this.player_.muted(this.player_.muted()?!1:!0)},vjs.MuteToggle.prototype.update=function(){var i=this.player_.volume(),n=3,t;for(i===0||this.player_.muted()?n=0:i<.33?n=1:i<.67&&(n=2),this.player_.muted()?this.el_.children[0].children[0].innerHTML!=this.localize("Unmute")&&(this.el_.children[0].children[0].innerHTML=this.localize("Unmute")):this.el_.children[0].children[0].innerHTML!=this.localize("Mute")&&(this.el_.children[0].children[0].innerHTML=this.localize("Mute")),t=0;t<4;t++)vjs.removeClass(this.el_,"vjs-vol-"+t);vjs.addClass(this.el_,"vjs-vol-"+n)},vjs.VolumeMenuButton=vjs.MenuButton.extend({init:function(n,t){vjs.MenuButton.call(this,n,t);n.on("volumechange",vjs.bind(this,this.update));n.tech&&n.tech.features&&n.tech.features.volumeControl===!1&&this.addClass("vjs-hidden");n.on("loadstart",vjs.bind(this,function(){n.tech.features&&n.tech.features.volumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}));this.addClass("vjs-menu-button")}}),vjs.VolumeMenuButton.prototype.createMenu=function(){var n=new vjs.Menu(this.player_,{contentElType:"div"}),t=new vjs.VolumeBar(this.player_,vjs.obj.merge({vertical:!0},this.options_.volumeBar));return n.addChild(t),n},vjs.VolumeMenuButton.prototype.onClick=function(){vjs.MuteToggle.prototype.onClick.call(this);vjs.MenuButton.prototype.onClick.call(this)},vjs.VolumeMenuButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-volume-menu-button vjs-menu-button vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.localize("Mute")+"<\/span><\/div>"})},vjs.VolumeMenuButton.prototype.update=vjs.MuteToggle.prototype.update,vjs.PlaybackRateMenuButton=vjs.MenuButton.extend({init:function(n,t){vjs.MenuButton.call(this,n,t);this.updateVisibility();this.updateLabel();n.on("loadstart",vjs.bind(this,this.updateVisibility));n.on("ratechange",vjs.bind(this,this.updateLabel))}}),vjs.PlaybackRateMenuButton.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-playback-rate vjs-menu-button vjs-control",innerHTML:'<div class="vjs-control-content"><span class="vjs-control-text">'+this.localize("Playback Rate")+"<\/span><\/div>"});return this.labelEl_=vjs.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1}),n.appendChild(this.labelEl_),n},vjs.PlaybackRateMenuButton.prototype.createMenu=function(){var i=new vjs.Menu(this.player()),t=this.player().options().playbackRates,n;if(t)for(n=t.length-1;n>=0;n--)i.addChild(new vjs.PlaybackRateMenuItem(this.player(),{rate:t[n]+"x"}));return i},vjs.PlaybackRateMenuButton.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},vjs.PlaybackRateMenuButton.prototype.onClick=function(){for(var r=this.player().playbackRate(),n=this.player().options().playbackRates,i=n[0],t=0;t<n.length;t++)if(n[t]>r){i=n[t];break}this.player().playbackRate(i)},vjs.PlaybackRateMenuButton.prototype.playbackRateSupported=function(){return this.player().tech&&this.player().tech.features.playbackRate&&this.player().options().playbackRates&&this.player().options().playbackRates.length>0},vjs.PlaybackRateMenuButton.prototype.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},vjs.PlaybackRateMenuButton.prototype.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},vjs.PlaybackRateMenuItem=vjs.MenuItem.extend({contentElType:"button",init:function(n,t){var i=this.label=t.rate,r=this.rate=parseFloat(i,10);t.label=i;t.selected=r===1;vjs.MenuItem.call(this,n,t);this.player().on("ratechange",vjs.bind(this,this.update))}}),vjs.PlaybackRateMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this);this.player().playbackRate(this.rate)},vjs.PlaybackRateMenuItem.prototype.update=function(){this.selected(this.player().playbackRate()==this.rate)},vjs.PosterImage=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);n.poster()&&this.src(n.poster());n.poster()&&n.controls()||this.hide();n.on("posterchange",vjs.bind(this,function(){this.src(n.poster())}));n.on("play",vjs.bind(this,this.hide))}}),_backgroundSizeSupported="backgroundSize"in vjs.TEST_VID.style,vjs.PosterImage.prototype.createEl=function(){var n=vjs.createEl("div",{className:"vjs-poster",tabIndex:-1});return _backgroundSizeSupported||n.appendChild(vjs.createEl("img")),n},vjs.PosterImage.prototype.src=function(n){var t=this.el();n!==undefined&&(_backgroundSizeSupported?t.style.backgroundImage='url("'+n+'")':t.firstChild.src=n)},vjs.PosterImage.prototype.onClick=function(){this.player().controls()&&this.player_.play()},vjs.LoadingSpinner=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.LoadingSpinner.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner"})},vjs.BigPlayButton=vjs.Button.extend(),vjs.BigPlayButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-big-play-button",innerHTML:'<span aria-hidden="true"><\/span>',"aria-label":"play video"})},vjs.BigPlayButton.prototype.onClick=function(){this.player_.play()},vjs.ErrorDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.update();n.on("error",vjs.bind(this,this.update))}}),vjs.ErrorDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-error-display"});return this.contentEl_=vjs.createEl("div"),n.appendChild(this.contentEl_),n},vjs.ErrorDisplay.prototype.update=function(){this.player().error()&&(this.contentEl_.innerHTML=this.localize(this.player().error().message))},vjs.MediaTechController=vjs.Component.extend({init:function(n,t,i){t=t||{};t.reportTouchActivity=!1;vjs.Component.call(this,n,t,i);this.features.progressEvents||this.manualProgressOn();this.features.timeupdateEvents||this.manualTimeUpdatesOn();this.initControlsListeners()}}),vjs.MediaTechController.prototype.initControlsListeners=function(){var n,t,r,i;t=this;n=this.player();i=function(){n.controls()&&!n.usingNativeControls()&&t.addControlsListeners()};r=vjs.bind(t,t.removeControlsListeners);this.ready(i);n.on("controlsenabled",i);n.on("controlsdisabled",r);this.ready(function(){this.networkState&&this.networkState()>0&&this.player().trigger("loadstart")})},vjs.MediaTechController.prototype.addControlsListeners=function(){var n;this.on("mousedown",this.onClick);this.on("touchstart",function(){n=this.player_.userActive()});this.on("touchmove",function(){n&&this.player().reportUserActivity()});this.on("touchend",function(n){n.preventDefault()});this.emitTapEvents();this.on("tap",this.onTap)},vjs.MediaTechController.prototype.removeControlsListeners=function(){this.off("tap");this.off("touchstart");this.off("touchmove");this.off("touchleave");this.off("touchcancel");this.off("touchend");this.off("click");this.off("mousedown")},vjs.MediaTechController.prototype.onClick=function(n){n.button===0&&this.player().controls()&&(this.player().paused()?this.player().play():this.player().pause())},vjs.MediaTechController.prototype.onTap=function(){this.player().userActive(!this.player().userActive())},vjs.MediaTechController.prototype.manualProgressOn=function(){this.manualProgress=!0;this.trackProgress()},vjs.MediaTechController.prototype.manualProgressOff=function(){this.manualProgress=!1;this.stopTrackingProgress()},vjs.MediaTechController.prototype.trackProgress=function(){this.progressInterval=setInterval(vjs.bind(this,function(){var n=this.player().bufferedPercent();this.bufferedPercent_!=n&&this.player().trigger("progress");this.bufferedPercent_=n;n===1&&this.stopTrackingProgress()}),500)},vjs.MediaTechController.prototype.stopTrackingProgress=function(){clearInterval(this.progressInterval)},vjs.MediaTechController.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0;this.player().on("play",vjs.bind(this,this.trackCurrentTime));this.player().on("pause",vjs.bind(this,this.stopTrackingCurrentTime));this.one("timeupdate",function(){this.features.timeupdateEvents=!0;this.manualTimeUpdatesOff()})},vjs.MediaTechController.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime)},vjs.MediaTechController.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime();this.currentTimeInterval=setInterval(vjs.bind(this,function(){this.player().trigger("timeupdate")}),250)},vjs.MediaTechController.prototype.stopTrackingCurrentTime=function(){clearInterval(this.currentTimeInterval);this.player().trigger("timeupdate")},vjs.MediaTechController.prototype.dispose=function(){this.manualProgress&&this.manualProgressOff();this.manualTimeUpdates&&this.manualTimeUpdatesOff();vjs.Component.prototype.dispose.call(this)},vjs.MediaTechController.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.player().trigger("timeupdate")},vjs.MediaTechController.prototype.setPoster=function(){},vjs.MediaTechController.prototype.features={volumeControl:!0,fullscreenResize:!1,playbackRate:!1,progressEvents:!1,timeupdateEvents:!1},vjs.media={},vjs.Html5=vjs.MediaTechController.extend({init:function(n,t,i){this.features.volumeControl=vjs.Html5.canControlVolume();this.features.playbackRate=vjs.Html5.canControlPlaybackRate();this.features.movingMediaElementInDOM=!vjs.IS_IOS;this.features.fullscreenResize=!0;this.features.progressEvents=!0;vjs.MediaTechController.call(this,n,t,i);this.setupTriggers();var r=t.source;r&&this.el_.currentSrc!==r.src&&(this.el_.src=r.src);vjs.TOUCH_ENABLED&&n.options().nativeControlsForTouch!==!1&&this.useNativeControls();n.ready(function(){this.tag&&this.options_.autoplay&&this.paused()&&(delete this.tag.poster,this.play())});this.triggerReady()}}),vjs.Html5.prototype.dispose=function(){vjs.Html5.disposeMediaElement(this.el_);vjs.MediaTechController.prototype.dispose.call(this)},vjs.Html5.prototype.createEl=function(){var t=this.player_,n=t.tag,e,u,i,r,f;for(n&&this.features.movingMediaElementInDOM!==!1||(n?(e=n.cloneNode(!1),vjs.Html5.disposeMediaElement(n),n=e,t.tag=null):(n=vjs.createEl("video"),vjs.setElementAttributes(n,vjs.obj.merge(t.tagAttributes||{},{id:t.id()+"_html5_api","class":"vjs-tech"}))),n.player=t,vjs.insertFirst(n,t.el())),u=["autoplay","preload","loop","muted"],i=u.length-1;i>=0;i--)r=u[i],f={},typeof t.options_[r]!="undefined"&&(f[r]=t.options_[r]),vjs.setElementAttributes(n,f);return n},vjs.Html5.prototype.setupTriggers=function(){for(var n=vjs.Html5.Events.length-1;n>=0;n--)vjs.on(this.el_,vjs.Html5.Events[n],vjs.bind(this,this.eventHandler))},vjs.Html5.prototype.eventHandler=function(n){n.type=="error"?this.player().error(this.error().code):(n.bubbles=!1,this.player().trigger(n))},vjs.Html5.prototype.useNativeControls=function(){var t,n,i,r,u;t=this;n=this.player();t.setControls(n.controls());i=function(){t.setControls(!0)};r=function(){t.setControls(!1)};n.on("controlsenabled",i);n.on("controlsdisabled",r);u=function(){n.off("controlsenabled",i);n.off("controlsdisabled",r)};t.on("dispose",u);n.on("usingcustomcontrols",u);n.usingNativeControls(!0)},vjs.Html5.prototype.play=function(){this.el_.play()},vjs.Html5.prototype.pause=function(){this.el_.pause()},vjs.Html5.prototype.paused=function(){return this.el_.paused},vjs.Html5.prototype.currentTime=function(){return this.el_.currentTime},vjs.Html5.prototype.setCurrentTime=function(n){try{this.el_.currentTime=n}catch(t){vjs.log(t,"Video is not ready. (Video.js)")}},vjs.Html5.prototype.duration=function(){return this.el_.duration||0},vjs.Html5.prototype.buffered=function(){return this.el_.buffered},vjs.Html5.prototype.volume=function(){return this.el_.volume},vjs.Html5.prototype.setVolume=function(n){this.el_.volume=n},vjs.Html5.prototype.muted=function(){return this.el_.muted},vjs.Html5.prototype.setMuted=function(n){this.el_.muted=n},vjs.Html5.prototype.width=function(){return this.el_.offsetWidth},vjs.Html5.prototype.height=function(){return this.el_.offsetHeight},vjs.Html5.prototype.supportsFullScreen=function(){return typeof this.el_.webkitEnterFullScreen=="function"&&(/Android/.test(vjs.USER_AGENT)||!/Chrome|Mac OS X 10.5/.test(vjs.USER_AGENT))?!0:!1},vjs.Html5.prototype.enterFullScreen=function(){var n=this.el_;n.paused&&n.networkState<=n.HAVE_METADATA?(this.el_.play(),setTimeout(function(){n.pause();n.webkitEnterFullScreen()},0)):n.webkitEnterFullScreen()},vjs.Html5.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},vjs.Html5.prototype.src=function(n){if(n===undefined)return this.el_.src;this.el_.src=n},vjs.Html5.prototype.load=function(){this.el_.load()},vjs.Html5.prototype.currentSrc=function(){return this.el_.currentSrc},vjs.Html5.prototype.poster=function(){return this.el_.poster},vjs.Html5.prototype.setPoster=function(n){this.el_.poster=n},vjs.Html5.prototype.preload=function(){return this.el_.preload},vjs.Html5.prototype.setPreload=function(n){this.el_.preload=n},vjs.Html5.prototype.autoplay=function(){return this.el_.autoplay},vjs.Html5.prototype.setAutoplay=function(n){this.el_.autoplay=n},vjs.Html5.prototype.controls=function(){return this.el_.controls},vjs.Html5.prototype.setControls=function(n){this.el_.controls=!!n},vjs.Html5.prototype.loop=function(){return this.el_.loop},vjs.Html5.prototype.setLoop=function(n){this.el_.loop=n},vjs.Html5.prototype.error=function(){return this.el_.error},vjs.Html5.prototype.seeking=function(){return this.el_.seeking},vjs.Html5.prototype.ended=function(){return this.el_.ended},vjs.Html5.prototype.defaultMuted=function(){return this.el_.defaultMuted},vjs.Html5.prototype.playbackRate=function(){return this.el_.playbackRate},vjs.Html5.prototype.setPlaybackRate=function(n){this.el_.playbackRate=n},vjs.Html5.prototype.networkState=function(){return this.el_.networkState},vjs.Html5.isSupported=function(){try{vjs.TEST_VID.volume=.5}catch(n){return!1}return!!vjs.TEST_VID.canPlayType},vjs.Html5.canPlaySource=function(n){try{return!!vjs.TEST_VID.canPlayType(n.type)}catch(t){return""}},vjs.Html5.canControlVolume=function(){var n=vjs.TEST_VID.volume;return vjs.TEST_VID.volume=n/2+.1,n!==vjs.TEST_VID.volume},vjs.Html5.canControlPlaybackRate=function(){var n=vjs.TEST_VID.playbackRate;return vjs.TEST_VID.playbackRate=n/2+.1,n!==vjs.TEST_VID.playbackRate},function(){var n,t=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,i=/^video\/mp4/i;vjs.Html5.patchCanPlayType=function(){vjs.ANDROID_VERSION>=4&&(n||(n=vjs.TEST_VID.constructor.prototype.canPlayType),vjs.TEST_VID.constructor.prototype.canPlayType=function(i){return i&&t.test(i)?"maybe":n.call(this,i)});vjs.IS_OLD_ANDROID&&(n||(n=vjs.TEST_VID.constructor.prototype.canPlayType),vjs.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&i.test(t)?"maybe":n.call(this,t)})};vjs.Html5.unpatchCanPlayType=function(){var t=vjs.TEST_VID.constructor.prototype.canPlayType;return vjs.TEST_VID.constructor.prototype.canPlayType=n,n=null,t};vjs.Html5.patchCanPlayType()}(),vjs.Html5.Events="loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(","),vjs.Html5.disposeMediaElement=function(n){if(n){for(n.player=null,n.parentNode&&n.parentNode.removeChild(n);n.hasChildNodes();)n.removeChild(n.firstChild);n.removeAttribute("src");typeof n.load=="function"&&function(){try{n.load()}catch(t){}}()}},vjs.Flash=vjs.MediaTechController.extend({init:function(n,t,i){var e;vjs.MediaTechController.call(this,n,t,i);var r=t.source,h=t.parentEl,o=this.el_=vjs.createEl("div",{id:n.id()+"_temp_flash"}),s=n.id()+"_flash_api",u=n.options_,f=vjs.obj.merge({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:u.autoplay,preload:u.preload,loop:u.loop,muted:u.muted},t.flashVars),c=vjs.obj.merge({wmode:"opaque",bgcolor:"#000000"},t.params),l=vjs.obj.merge({id:s,name:s,"class":"vjs-tech"},t.attributes);r&&(r.type&&vjs.Flash.isStreamingType(r.type)?(e=vjs.Flash.streamToParts(r.src),f.rtmpConnection=encodeURIComponent(e.connection),f.rtmpStream=encodeURIComponent(e.stream)):f.src=encodeURIComponent(vjs.getAbsoluteURL(r.src)));vjs.insertFirst(o,h);t.startTime&&this.ready(function(){this.load();this.play();this.currentTime(t.startTime)});vjs.IS_FIREFOX&&this.ready(function(){vjs.on(this.el(),"mousemove",vjs.bind(this,function(){this.player().trigger({type:"mousemove",bubbles:!1})}))});n.on("stageclick",n.reportUserActivity);this.el_=vjs.Flash.embed(t.swf,o,f,c,l)}}),vjs.Flash.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)},vjs.Flash.prototype.play=function(){this.el_.vjs_play()},vjs.Flash.prototype.pause=function(){this.el_.vjs_pause()},vjs.Flash.prototype.src=function(n){if(n===undefined)return this.currentSrc();if(vjs.Flash.isStreamingSrc(n)?(n=vjs.Flash.streamToParts(n),this.setRtmpConnection(n.connection),this.setRtmpStream(n.stream)):(n=vjs.getAbsoluteURL(n),this.el_.vjs_src(n)),this.player_.autoplay()){var t=this;setTimeout(function(){t.play()},0)}},vjs.Flash.prototype.setCurrentTime=function(n){this.lastSeekTarget_=n;this.el_.vjs_setProperty("currentTime",n);vjs.MediaTechController.prototype.setCurrentTime.call(this)},vjs.Flash.prototype.currentTime=function(){return this.seeking()?this.lastSeekTarget_||0:this.el_.vjs_getProperty("currentTime")},vjs.Flash.prototype.currentSrc=function(){var n=this.el_.vjs_getProperty("currentSrc"),t,i;return n==null&&(t=this.rtmpConnection(),i=this.rtmpStream(),t&&i&&(n=vjs.Flash.streamFromParts(t,i))),n},vjs.Flash.prototype.load=function(){this.el_.vjs_load()},vjs.Flash.prototype.poster=function(){this.el_.vjs_getProperty("poster")},vjs.Flash.prototype.setPoster=function(){},vjs.Flash.prototype.buffered=function(){return vjs.createTimeRange(0,this.el_.vjs_getProperty("buffered"))},vjs.Flash.prototype.supportsFullScreen=function(){return!1},vjs.Flash.prototype.enterFullScreen=function(){return!1},function(){function f(n){var t=n.charAt(0).toUpperCase()+n.slice(1);i["set"+t]=function(t){return this.el_.vjs_setProperty(n,t)}}function u(n){i[n]=function(){return this.el_.vjs_getProperty(n)}}for(var i=vjs.Flash.prototype,t="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),r="error,networkState,readyState,seeking,initialTime,duration,startOffsetTime,paused,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks".split(","),n=0;n<t.length;n++)u(t[n]),f(t[n]);for(n=0;n<r.length;n++)u(r[n])}(),vjs.Flash.isSupported=function(){return vjs.Flash.version()[0]>=10},vjs.Flash.canPlaySource=function(n){var t;return n.type?(t=n.type.replace(/;.*/,"").toLowerCase(),t in vjs.Flash.formats||t in vjs.Flash.streamingFormats?"maybe":void 0):""},vjs.Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},vjs.Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},vjs.Flash.onReady=function(n){var t,i;t=vjs.el(n);i=t&&t.parentNode&&t.parentNode.player;i&&(t.player=i,vjs.Flash.checkReady(i.tech))},vjs.Flash.checkReady=function(n){n.el()&&(n.el().vjs_getProperty?n.triggerReady():setTimeout(function(){vjs.Flash.checkReady(n)},50))},vjs.Flash.onEvent=function(n,t){var i=vjs.el(n).player;i.trigger(t)},vjs.Flash.onError=function(n,t){var i=vjs.el(n).player,r="FLASH: "+t;t=="srcnotfound"?i.error({code:4,message:r}):i.error(r)},vjs.Flash.version=function(){var n="0,0,0";try{n=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(t){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(n=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(i){}}return n.split(",")},vjs.Flash.embed=function(n,t,i,r,u){var o=vjs.Flash.getEmbedCode(n,i,r,u),f=vjs.createEl("div",{innerHTML:o}).childNodes[0],s=t.parentNode,e;return t.parentNode.replaceChild(f,t),e=s.childNodes[0],setTimeout(function(){e.style.display="block"},1e3),f},vjs.Flash.getEmbedCode=function(n,t,i,r){var u="",f="",e="";return t&&vjs.obj.each(t,function(n,t){u+=n+"="+t+"&amp;"}),i=vjs.obj.merge({movie:n,flashvars:u,allowScriptAccess:"always",allowNetworking:"all"},i),vjs.obj.each(i,function(n,t){f+='<param name="'+n+'" value="'+t+'" />'}),r=vjs.obj.merge({data:n,width:"100%",height:"100%"},r),vjs.obj.each(r,function(n,t){e+=n+'="'+t+'" '}),'<object type="application/x-shockwave-flash"'+e+">"+f+"<\/object>"},vjs.Flash.streamFromParts=function(n,t){return n+"&"+t},vjs.Flash.streamToParts=function(n){var i={connection:"",stream:""},t,r;return n?(t=n.indexOf("&"),t!==-1?r=t+1:(t=r=n.lastIndexOf("/")+1,t===0&&(t=r=n.length)),i.connection=n.substring(0,t),i.stream=n.substring(r,n.length),i):i},vjs.Flash.isStreamingType=function(n){return n in vjs.Flash.streamingFormats},vjs.Flash.RTMP_RE=/^rtmp[set]?:\/\//i,vjs.Flash.isStreamingSrc=function(n){return vjs.Flash.RTMP_RE.test(n)},vjs.MediaLoader=vjs.Component.extend({init:function(n,t,i){var r,u,f,e;if(vjs.Component.call(this,n,t,i),n.options_.sources&&n.options_.sources.length!==0)n.src(n.options_.sources);else for(r=0,u=n.options_.techOrder;r<u.length;r++)if(f=vjs.capitalize(u[r]),e=window.videojs[f],e&&e.isSupported()){n.loadTech(f);break}}}),vjs.Player.prototype.textTracks_,vjs.Player.prototype.textTracks=function(){return this.textTracks_=this.textTracks_||[],this.textTracks_},vjs.Player.prototype.addTextTrack=function(n,t,i,r){var e=this.textTracks_=this.textTracks_||[],f,u;return r=r||{},r.kind=n,r.label=t,r.language=i,f=vjs.capitalize(n||"subtitles"),u=new window.videojs[f+"Track"](this,r),e.push(u),u.dflt()&&this.ready(function(){setTimeout(function(){u.player().showTextTrack(u.id())},0)}),u},vjs.Player.prototype.addTextTracks=function(n){for(var t,i=0;i<n.length;i++)t=n[i],this.addTextTrack(t.kind,t.label,t.language,t);return this},vjs.Player.prototype.showTextTrack=function(n,t){for(var e=this.textTracks_,r=0,o=e.length,i,u,f;r<o;r++)i=e[r],i.id()===n?(i.show(),u=i):t&&i.kind()==t&&i.mode()>0&&i.disable();return f=u?u.kind():t?t:!1,f&&this.trigger(f+"trackchange"),this},vjs.TextTrack=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.id_=t.id||"vjs_"+t.kind+"_"+t.language+"_"+vjs.guid++;this.src_=t.src;this.dflt_=t["default"]||t.dflt;this.title_=t.title;this.language_=t.srclang;this.label_=t.label;this.cues_=[];this.activeCues_=[];this.readyState_=0;this.mode_=0;this.player_.on("fullscreenchange",vjs.bind(this,this.adjustFontSize))}}),vjs.TextTrack.prototype.kind_,vjs.TextTrack.prototype.kind=function(){return this.kind_},vjs.TextTrack.prototype.src_,vjs.TextTrack.prototype.src=function(){return this.src_},vjs.TextTrack.prototype.dflt_,vjs.TextTrack.prototype.dflt=function(){return this.dflt_},vjs.TextTrack.prototype.title_,vjs.TextTrack.prototype.title=function(){return this.title_},vjs.TextTrack.prototype.language_,vjs.TextTrack.prototype.language=function(){return this.language_},vjs.TextTrack.prototype.label_,vjs.TextTrack.prototype.label=function(){return this.label_},vjs.TextTrack.prototype.cues_,vjs.TextTrack.prototype.cues=function(){return this.cues_},vjs.TextTrack.prototype.activeCues_,vjs.TextTrack.prototype.activeCues=function(){return this.activeCues_},vjs.TextTrack.prototype.readyState_,vjs.TextTrack.prototype.readyState=function(){return this.readyState_},vjs.TextTrack.prototype.mode_,vjs.TextTrack.prototype.mode=function(){return this.mode_},vjs.TextTrack.prototype.adjustFontSize=function(){this.el_.style.fontSize=this.player_.isFullScreen()?screen.width/this.player_.width()*1.4*100+"%":""},vjs.TextTrack.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-"+this.kind_+" vjs-text-track"})},vjs.TextTrack.prototype.show=function(){this.activate();this.mode_=2;vjs.Component.prototype.show.call(this)},vjs.TextTrack.prototype.hide=function(){this.activate();this.mode_=1;vjs.Component.prototype.hide.call(this)},vjs.TextTrack.prototype.disable=function(){this.mode_==2&&this.hide();this.deactivate();this.mode_=0},vjs.TextTrack.prototype.activate=function(){if(this.readyState_===0&&this.load(),this.mode_===0){this.player_.on("timeupdate",vjs.bind(this,this.update,this.id_));this.player_.on("ended",vjs.bind(this,this.reset,this.id_));(this.kind_==="captions"||this.kind_==="subtitles")&&this.player_.getChild("textTrackDisplay").addChild(this)}},vjs.TextTrack.prototype.deactivate=function(){this.player_.off("timeupdate",vjs.bind(this,this.update,this.id_));this.player_.off("ended",vjs.bind(this,this.reset,this.id_));this.reset();this.player_.getChild("textTrackDisplay").removeChild(this)},vjs.TextTrack.prototype.load=function(){this.readyState_===0&&(this.readyState_=1,vjs.get(this.src_,vjs.bind(this,this.parseCues),vjs.bind(this,this.onError)))},vjs.TextTrack.prototype.onError=function(n){this.error=n;this.readyState_=3;this.trigger("error")},vjs.TextTrack.prototype.parseCues=function(n){for(var r,f,e,u=n.split("\n"),t="",o,i=1,s=u.length;i<s;i++)if(t=vjs.trim(u[i]),t){for(t.indexOf("-->")==-1?(o=t,t=vjs.trim(u[++i])):o=this.cues_.length,r={id:o,index:this.cues_.length},f=t.split(/[\t ]+/),r.startTime=this.parseCueTime(f[0]),r.endTime=this.parseCueTime(f[2]),e=[];u[++i]&&(t=vjs.trim(u[i]));)e.push(t);r.text=e.join("<br/>");this.cues_.push(r)}this.readyState_=2;this.trigger("loaded")},vjs.TextTrack.prototype.parseCueTime=function(n){var i=n.split(":"),r=0,f,e,u,t,o;return i.length==3?(f=i[0],e=i[1],u=i[2]):(f=0,e=i[0],u=i[1]),u=u.split(/\s+/),t=u.splice(0,1)[0],t=t.split(/\.|,/),o=parseFloat(t[1]),t=t[0],r+=parseFloat(f)*3600,r+=parseFloat(e)*60,r+=parseFloat(t),o&&(r+=o/1e3),r},vjs.TextTrack.prototype.update=function(){var c,i;if(this.cues_.length>0&&(c=this.player_.options().trackTimeOffset||0,i=this.player_.currentTime()+c,this.prevChange===undefined||i<this.prevChange||this.nextChange<=i)){var s=this.cues_,r=this.player_.duration(),u=0,f=!1,h=[],e,o,n,t;for(i>=this.nextChange||this.nextChange===undefined?t=this.firstActiveIndex!==undefined?this.firstActiveIndex:0:(f=!0,t=this.lastActiveIndex!==undefined?this.lastActiveIndex:s.length-1);;){if(n=s[t],n.endTime<=i)u=Math.max(u,n.endTime),n.active&&(n.active=!1);else if(i<n.startTime){if(r=Math.min(r,n.startTime),n.active&&(n.active=!1),!f)break}else f?(h.splice(0,0,n),o===undefined&&(o=t),e=t):(h.push(n),e===undefined&&(e=t),o=t),r=Math.min(r,n.endTime),u=Math.max(u,n.startTime),n.active=!0;if(f)if(t===0)break;else t--;else if(t===s.length-1)break;else t++}this.activeCues_=h;this.nextChange=r;this.prevChange=u;this.firstActiveIndex=e;this.lastActiveIndex=o;this.updateDisplay();this.trigger("cuechange")}},vjs.TextTrack.prototype.updateDisplay=function(){for(var t=this.activeCues_,i="",n=0,r=t.length;n<r;n++)i+='<span class="vjs-tt-cue">'+t[n].text+"<\/span>";this.el_.innerHTML=i},vjs.TextTrack.prototype.reset=function(){this.nextChange=0;this.prevChange=this.player_.duration();this.firstActiveIndex=0;this.lastActiveIndex=0},vjs.CaptionsTrack=vjs.TextTrack.extend(),vjs.CaptionsTrack.prototype.kind_="captions",vjs.SubtitlesTrack=vjs.TextTrack.extend(),vjs.SubtitlesTrack.prototype.kind_="subtitles",vjs.ChaptersTrack=vjs.TextTrack.extend(),vjs.ChaptersTrack.prototype.kind_="chapters",vjs.TextTrackDisplay=vjs.Component.extend({init:function(n,t,i){vjs.Component.call(this,n,t,i);n.options_.tracks&&n.options_.tracks.length>0&&this.player_.addTextTracks(n.options_.tracks)}}),vjs.TextTrackDisplay.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"})},vjs.TextTrackMenuItem=vjs.MenuItem.extend({init:function(n,t){var i=this.track=t.track;t.label=i.label();t.selected=i.dflt();vjs.MenuItem.call(this,n,t);this.player_.on(i.kind()+"trackchange",vjs.bind(this,this.update))}}),vjs.TextTrackMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this);this.player_.showTextTrack(this.track.id_,this.track.kind())},vjs.TextTrackMenuItem.prototype.update=function(){this.selected(this.track.mode()==2)},vjs.OffTextTrackMenuItem=vjs.TextTrackMenuItem.extend({init:function(n,t){t.track={kind:function(){return t.kind},player:n,label:function(){return t.kind+" off"},dflt:function(){return!1},mode:function(){return!1}};vjs.TextTrackMenuItem.call(this,n,t);this.selected(!0)}}),vjs.OffTextTrackMenuItem.prototype.onClick=function(){vjs.TextTrackMenuItem.prototype.onClick.call(this);this.player_.showTextTrack(this.track.id_,this.track.kind())},vjs.OffTextTrackMenuItem.prototype.update=function(){for(var i=this.player_.textTracks(),n=0,u=i.length,t,r=!0;n<u;n++)t=i[n],t.kind()==this.track.kind()&&t.mode()==2&&(r=!1);this.selected(r)},vjs.TextTrackButton=vjs.MenuButton.extend({init:function(n,t){vjs.MenuButton.call(this,n,t);this.items.length<=1&&this.hide()}}),vjs.TextTrackButton.prototype.createItems=function(){var t=[],i,n;for(t.push(new vjs.OffTextTrackMenuItem(this.player_,{kind:this.kind_})),n=0;n<this.player_.textTracks().length;n++)i=this.player_.textTracks()[n],i.kind()===this.kind_&&t.push(new vjs.TextTrackMenuItem(this.player_,{track:i}));return t},vjs.CaptionsButton=vjs.TextTrackButton.extend({init:function(n,t,i){vjs.TextTrackButton.call(this,n,t,i);this.el_.setAttribute("aria-label","Captions Menu")}}),vjs.CaptionsButton.prototype.kind_="captions",vjs.CaptionsButton.prototype.buttonText="Captions",vjs.CaptionsButton.prototype.className="vjs-captions-button",vjs.SubtitlesButton=vjs.TextTrackButton.extend({init:function(n,t,i){vjs.TextTrackButton.call(this,n,t,i);this.el_.setAttribute("aria-label","Subtitles Menu")}}),vjs.SubtitlesButton.prototype.kind_="subtitles",vjs.SubtitlesButton.prototype.buttonText="Subtitles",vjs.SubtitlesButton.prototype.className="vjs-subtitles-button",vjs.ChaptersButton=vjs.TextTrackButton.extend({init:function(n,t,i){vjs.TextTrackButton.call(this,n,t,i);this.el_.setAttribute("aria-label","Chapters Menu")}}),vjs.ChaptersButton.prototype.kind_="chapters",vjs.ChaptersButton.prototype.buttonText="Chapters",vjs.ChaptersButton.prototype.className="vjs-chapters-button",vjs.ChaptersButton.prototype.createItems=function(){for(var i=[],n,t=0;t<this.player_.textTracks().length;t++)n=this.player_.textTracks()[t],n.kind()===this.kind_&&i.push(new vjs.TextTrackMenuItem(this.player_,{track:n}));return i},vjs.ChaptersButton.prototype.createMenu=function(){for(var o=this.player_.textTracks(),n=0,u=o.length,i,r,h=this.items=[],t,f,s,e;n<u;n++)if(i=o[n],i.kind()==this.kind_)if(i.readyState()===0){i.load();i.on("loaded",vjs.bind(this,this.createMenu))}else{r=i;break}if(t=this.menu,t===undefined&&(t=new vjs.Menu(this.player_),t.contentEl().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.kind_),tabindex:-1}))),r){for(f=r.cues_,n=0,u=f.length;n<u;n++)s=f[n],e=new vjs.ChaptersTrackMenuItem(this.player_,{track:r,cue:s}),h.push(e),t.addChild(e);this.addChild(t)}return this.items.length>0&&this.show(),t},vjs.ChaptersTrackMenuItem=vjs.MenuItem.extend({init:function(n,t){var u=this.track=t.track,i=this.cue=t.cue,r=n.currentTime();t.label=i.text;t.selected=i.startTime<=r&&r<i.endTime;vjs.MenuItem.call(this,n,t);u.on("cuechange",vjs.bind(this,this.update))}}),vjs.ChaptersTrackMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)},vjs.ChaptersTrackMenuItem.prototype.update=function(){var n=this.cue,t=this.player_.currentTime();this.selected(n.startTime<=t&&t<n.endTime)},vjs.obj.merge(vjs.ControlBar.prototype.options_.children,{subtitlesButton:{},captionsButton:{},chaptersButton:{}}),vjs.JSON,typeof JSON!="undefined"&&window.JSON.parse==="function"?vjs.JSON=window.JSON:(vjs.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,vjs.JSON.parse=function(n,t){function r(n,i){var f,e,u=n[i];if(u&&typeof u=="object")for(f in u)Object.prototype.hasOwnProperty.call(u,f)&&(e=r(u,f),e!==undefined?u[f]=e:delete u[f]);return t.call(n,i,u)}var i;if(n=String(n),cx.lastIndex=0,cx.test(n)&&(n=n.replace(cx,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse(): invalid or malformed JSON data");}),vjs.autoSetup=function(){var t,n,f,i=document.getElementsByTagName("video"),r,u;if(i&&i.length>0)for(r=0,u=i.length;r<u;r++)if(n=i[r],n&&n.getAttribute)n.player===undefined&&(t=n.getAttribute("data-setup"),t!==null&&(t=vjs.JSON.parse(t||"{}"),f=videojs(n,t)));else{vjs.autoSetupTimeout(1);break}else vjs.windowLoaded||vjs.autoSetupTimeout(1)},vjs.autoSetupTimeout=function(n){setTimeout(vjs.autoSetup,n)},document.readyState==="complete")vjs.windowLoaded=!0;else vjs.one(window,"load",function(){vjs.windowLoaded=!0});vjs.autoSetupTimeout(1);vjs.plugin=function(n,t){vjs.Player.prototype[n]=t};videojs.OnePlayer=videojs.Html5.extend({init:function(n,t,i){var r,u;r=t.source;delete t.source;videojs.Html5.call(this,n,t,i);this.el().controls=!1;u=OnePlayer.CreateVideoElement(this.el());u.autoplay=n.options_.autoplay;r&&this.el_.currentSrc!==r.src&&u.setSrc(r.src,r.type);n.mediaPlayer=u}});videojs.OnePlayer.prototype.src=function(n){if(n===undefined)return this.player().mediaPlayer.src;this.player().mediaPlayer.src=n};videojs.OnePlayer.prototype.setCurrentTime=function(n){this.player().mediaPlayer.currentTime=n};videojs.OnePlayer.isSupported=function(){return!!window.MediaSource};videojs.OnePlayer.canPlaySource=function(n){return n.type==="application/dash+xml"?"maybe":""};videojs.options.techOrder.unshift("onePlayer");videojs.Osmfss=videojs.MediaTechController.extend({init:function(n,t,i){vjs.MediaTechController.call(this,n,t,i);var u=t.source,s=t.parentEl,f=this.el_=vjs.createEl("div",{id:n.id()+"_temp_flash"}),e=n.id()+"_osmfss_api",r=n.options_,o=vjs.obj.merge({playerId:n.id(),controlBarMode:"none",playButtonOverlay:"false",plugin_AdaptiveStreamingPlugin:r.osmfss.plugin,AdaptiveStreamingPlugin_retryLive:"true",javascriptCallbackFunction:"videojs.Osmfss.onEvent",autoPlay:r.autoplay,preload:r.preload,loop:r.loop,muted:r.muted},t.flashVars),h=vjs.obj.merge({wmode:"opaque",bgcolor:"#000000"},t.params),c=vjs.obj.merge({id:e,name:e,"class":"vjs-tech"},t.attributes);t.swf=r.osmfss.swf;n.osmfss=this;n.osmfss.seeking_=!1;n.osmfss.lastSeekTarget_=NaN;u&&(o.src=encodeURIComponent(vjs.getAbsoluteURL(u.src)));vjs.insertFirst(f,s);t.startTime&&this.ready(function(){this.load();this.play();this.currentTime(t.startTime)});vjs.IS_FIREFOX&&this.ready(function(){vjs.on(this.el(),"mousemove",vjs.bind(this,function(){this.player().trigger({type:"mousemove",bubbles:!1})}))});n.on("stageclick",n.reportUserActivity);this.el_=vjs.Flash.embed(t.swf,f,o,h,c)}}),function(){function f(n){var t=n.charAt(0).toUpperCase()+n.slice(1);i["set"+t]=function(n){return this.el_["set"+t](n)}}function u(n){i[n]=function(){var t=n.charAt(0).toUpperCase()+n.slice(1);return this.el_["get"+t]()}}for(var i=videojs.Osmfss.prototype,t="autoplay,controller,controls,defaultMuted,defaultPlaybackRate,loop,mediaGroup,muted,playbackRate,preload,volume".split(","),r="audioTracks,currentSrc,duration,ended,error,initialTime,paused,played,readyState,seekable,seeking,startOffsetTime,textTracks,videoHeight,videoTracks,videoWidth".split(","),n=0;n<t.length;n++)u(t[n]),f(t[n]);for(n=0;n<r.length;n++)u(r[n])}();videojs.Osmfss.isSupported=function(){return vjs.Flash.isSupported()};videojs.Osmfss.canPlaySource=function(n){var t;return n.type?(t=n.type.replace(/;.*/,"").toLowerCase(),t in videojs.Osmfss.formats?"maybe":void 0):""};videojs.Osmfss.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)};videojs.Osmfss.prototype.networkState=function(){return 1};videojs.Osmfss.prototype.src=function(n){if(n===undefined)return this.currentSrc();this.el_.setSrc(vjs.getAbsoluteURL(n))};videojs.Osmfss.prototype.load=function(){this.el_.load()};videojs.Osmfss.prototype.play=function(){this.el_.play2()};videojs.Osmfss.prototype.pause=function(){this.el_.pause()};videojs.Osmfss.prototype.currentTime=function(){return this.seeking()?this.lastSeekTarget_||0:this.el_.getCurrentTime()};videojs.Osmfss.prototype.setCurrentTime=function(n){this.seeking_=!0;this.lastSeekTarget_=n;this.el_.pause()};videojs.Osmfss.prototype.buffered=function(){return videojs.createTimeRange(0,this.el_.getBufferTime())};videojs.Osmfss.prototype.supportsFullScreen=function(){return!1};videojs.Osmfss.prototype.enterFullScreen=function(){return!1};videojs.Osmfss.formats={"application/vnd.ms-sstr+xml":"ISMC","application/dash+xml":"MPD"};videojs.Osmfss.onReady=function(n){videojs.log(n,"Ready");var t,i;t=vjs.el(n);this.el_=t;i=t&&t.parentNode&&t.parentNode.player;i&&(t.player=i,videojs.Osmfss.checkReady(i.osmfss))};videojs.Osmfss.checkReady=function(n){return n.el()?n.el().getBufferTime?(n.triggerReady(),!0):(setTimeout(function(){videojs.Osmfss.checkReady(n)},50),!1):!1};videojs.Osmfss.onEvent=function(n,t){try{if("onJavaScriptBridgeCreated"===t){videojs.Osmfss.onReady(n);return}var i=videojs.el(n).player;"play"===t&&(videojs.log(n,"Event: playing"),i.trigger("playing"));"pause"===t&&i.osmfss.seeking_&&(i.osmfss.el_.setCurrentTime(i.osmfss.lastSeekTarget_),i.osmfss.seeking_=!1);"seeked"===t&&i.osmfss.play();i.trigger(t);"timeupdate"!==t&&videojs.log(n,"Event:",t)}catch(r){videojs.log(n,"Event:",t,r);throw r;}};videojs.options.techOrder.unshift("osmfss");videojs.options.osmfss={},function(n){"use strict";function u(n){if(n&&n.length>0){for(var i=0;i<n.length;i++)if(-1===t.indexOf(n[i]))throw new Error('Format "'+n[i]+'" not supported');t=n}}function s(n){var h,t,r,e,v,c,o,l,a,y,p,w,s;for(u(n),h=document.getElementsByTagName("video"),l=0;h&&l<h.length;l++)if(t=h[l],t){if(v=[],r=t.getElementsByTagName("source"),r&&r.length>0)for(a=r.length-1;a>=0;a--)if(e=r[a],y=e.getAttribute("src"),p=e.getAttribute("type"),y)v.unshift(new i(y,p)),e.parentNode.removeChild(e);else throw new Error('Source tag needs "src" attribute');for(o=f(v),w=t.firstChild,s=0;o&&s<o.length;s++)c=document.createElement("source"),c.setAttribute("src",o[s].src),c.setAttribute("type",o[s].type),t.insertBefore(c,w)}}function f(n){for(var i=[],r,u,f=[],t=0;n&&t<n.length;t++)h(n[t].src)==="ism"?(u=c(n[t].src),f.indexOf(u)===-1&&(f.push(u),r=l(n[t].src),r&&(i=i.concat(r)))):i.push(n[t]);return i.length>0?i:null}function h(n){var t=null,i=n.lastIndexOf("."),r=n.indexOf("/",i);return i>-1&&(t=n.substring(i+1,r!==-1?r:n.length),t=t.toLowerCase()),t}function c(n){var t=n.trim(),i=t.search(/\.ism\/manifest/i);return t.substr(0,i+13)}function l(n){var u=n.trim(),p=u.search(/format=/i),a=[],s,f="",h,c,l,v,y;for(p>-1&&(u=u.replace(/format=[^,)]*[ ,]*/i,""),u=u.replace(/\(\s*\)/,"")),s=u.match(/\([^)]*\)/),s&&s.length>0&&(f=s[0].substr(1).trim(),u=u.substr(0,u.indexOf("("))),h=0;h<t.length;h++)l="",c=t[h],v=o[c],c!==r?l="(format="+e[c]+(f?", "+f:")"):f&&(l="("+f),y=new i(u+l,v),a.push(y);return a.length>0?a:null}var r="SMOOTH",t=[r,"DASH","HLS-V3","HLS-V4"],e={DASH:"mpd-time-csf","HLS-V3":"m3u8-aapl-v3","HLS-V4":"m3u8-aapl-v4"},o={SMOOTH:"application/vnd.ms-sstr+xml",DASH:"application/dash+xml","HLS-V3":"application/vnd.apple.mpegurl","HLS-V4":"application/vnd.apple.mpegurl"},i=function(){function n(n,t){this.src=n;this.type=t}return n}();n.streamSrc=i;n.setMediaFormats=u;n.expandSourceTags=s;n.expandSources=f}(UrlRewriter||(UrlRewriter={})),function(n){(function(t){"use strict";var s,h,u,f,e,o,i,r;(function(n){n[n.proceed=0]="proceed";n[n.endOfStream=1]="endOfStream";n[n.retry=2]="retry"})(t.RequestState||(t.RequestState={}));s=t.RequestState,function(n){n[n.arraybuffer=0]="arraybuffer";n[n.blob=1]="blob";n[n.document=2]="document";n[n.json=3]="json";n[n.text=4]="text"}(t.ResponseType||(t.ResponseType={}));h=t.ResponseType;u=function(){function t(t,i,r){this.videoTag=i;this.appConfig=r;this.emeManager=null;this.eventMgr=new n.Events.Manager(t,!1);this.workflows=null;this.presentationUrl=null;this.presentationJson=null;this.commonPresentation=null;this.startPositionInSec=NaN;this.heuristicSettings=new n.Settings.Heuristics;this.httpRetryPolicySettings=new n.Settings.HttpRetryPolicy;this.httpDataRetrieverSettings=new n.Settings.HttpDataRetriever;this._disposed=!1}return t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this.videoTag=null,this.appConfig=null,this.workflows&&this.workflows.forEach(function(n){n.dispose()}),this.workflows=null,this.presentationUrl=null,this.presentationJson=null,this.emeManager&&(this.emeManager.dispose(),this.emeManager=null),this.eventMgr&&(this.eventMgr.dispose(),this.eventMgr=null),this.commonPresentation&&(this.commonPresentation.dispose(),this.commonPresentation=null),this.heuristicSettings=null)},Object.defineProperty(t.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this.presentationUrl=null;this.presentationJson=null;this.startPositionInSec=NaN;this.commonPresentation&&(this.commonPresentation.dispose(),this.commonPresentation=null)},t.prototype.maxBufferInSec=function(){return this.appConfig&&this.appConfig.maxBufferInSec&&this.appConfig.maxBufferInSec!="0"?parseInt(this.appConfig.maxBufferInSec):this.heuristicSettings.buffer.maxBufferInSec},t.prototype.prerollBufferInSec=function(){return this.maxBufferInSec()*this.heuristicSettings.buffer.prerollPercent},t.prototype.lowBufferInSec=function(){return this.maxBufferInSec()*this.heuristicSettings.vodDowngradeBufferLevelPercent*this.heuristicSettings.buffer.lowBufferPercent},t.prototype.liveStartBufferInSec=function(){return this.maxBufferInSec()*(this.heuristicSettings.buffer.prerollPercent+this.heuristicSettings.buffer.livePlaybackOffsetPercent)},t.prototype.updatePresentation=function(n){this.commonPresentation?(this.commonPresentation.transferPresentationState(n),this.presentationJson=n.toJson(),n.dispose()):(this.commonPresentation=n,this.presentationJson=n.toJson())},t}();t.Session=u;f=function(){function n(n,t){this.workflowType=n;this.sessionContext=t;this.state=0;this.retryWaitTimeMSec=0;this.currentModuleId=null;this.requestedStream=null;this.urlsToRetrieve=[];this.selectedTrack=null;this.selectedSegment=null;this.heuristicData=null;this.externalFailure=null;this.failTracker=new r;this._disposed=!1}return n.prototype.dispose=function(){this._disposed||(this._disposed=!0,this.workflowType=null,this.sessionContext=null,this.state=null,this.currentModuleId=null,this.requestedStream=null,this.urlsToRetrieve.forEach(function(n,t,i){i[t].dispose()}),this.urlsToRetrieve=[],this.selectedTrack=null,this.selectedSegment=null,this.heuristicData&&(this.heuristicData.dispose(),this.heuristicData=null),this.externalFailure&&(this.externalFailure.dispose(),this.externalFailure=null),this.failTracker&&(this.failTracker.dispose(),this.failTracker=null))},n.prototype.reset=function(){this.state=0;this.retryWaitTimeMSec=0;this.currentModuleId=null;this.urlsToRetrieve=[];this.selectedTrack=null;this.selectedSegment=null;this.heuristicData.reset();this.externalFailure=null},Object.defineProperty(n.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),n}();t.Request=f;e=function(){function n(n,t,i,r){typeof t=="undefined"&&(t=0);typeof i=="undefined"&&(i=0);typeof r=="undefined"&&(r=0);this.url=n;this.httpResponseCode=-1;this.httpResposeContentType="";this.mediaData=null;this.presentationData=null;this.presTimeInSec=i;this.durationInSec=r;this.responseType=t}return n.prototype.dispose=function(){this.url=null;this.httpResponseCode=null;this.httpResposeContentType="";this.mediaData=null;this.presentationData=null;this.presTimeInSec=null;this.durationInSec=null;this.responseType=null},n}();t.UrlRequest=e;o=function(){function n(n){var t=[];n.tracks.forEach(function(n){n.streamingInfo.selectable&&t.push(new i(n))});this.tracksData=t}return n.prototype.dispose=function(){this.tracksData.forEach(function(n,t,i){i[t].dispose()});this.tracksData=[]},n.prototype.reset=function(){this.tracksData.forEach(function(n,t,i){i[t].reset()})},n}();t.HeuristicData=o;i=function(){function n(n){this.trackInfo=n;this.selectable=!0;this.dataRetrieverEstimationInSec=null}return n.prototype.dispose=function(){this.trackInfo=null;this.selectable=null;this.dataRetrieverEstimationInSec=null},n.prototype.reset=function(){this.selectable=!0;this.dataRetrieverEstimationInSec=null},n}();t.TrackData=i;r=function(){function n(){this.lastFailure=null;this.lastTrack=null;this.totalRetried=0;this.tracksToTry=[];this.trackToTryIdx=0;this.sameSegmentRetried=0;this.segmentsSkipped=0}return n.prototype.dispose=function(){this.lastFailure=null;this.lastTrack=null;this.tracksToTry=[]},n.prototype.resetForSegment=function(){this.sameSegmentRetried=0;this.trackToTryIdx=0},n.prototype.log=function(n,t){this.lastFailure=n;this.lastTrack=t},n.prototype.isNone=function(){return null===this.lastFailure},n.prototype.isLastNetworkFail=function(){return this.lastFailure.code>=2164262089&&this.lastFailure.code<2164262143},n}();t.FailTracker=r})(n.Context||(n.Context={}));var t=n.Context}(OnePlayer||(OnePlayer={})),function(n){"use strict";function r(n,t){return new i(n,t)}var u,t,i;n.CreateVideoElement=r,function(n){n[n.internalErrStart=2164260864]="internalErrStart";n[n.internalErrDisposed=2164260864]="internalErrDisposed";n[n.internalErrEnd=2164261119]="internalErrEnd"}(n.ExtendedCode||(n.ExtendedCode={}));u=n.ExtendedCode;t=function(){function n(){}return n.exception="exception",n}();n.InternalEventName=t;i=function(){function i(t,i){this._sessionContext=new n.Context.Session(this,t,i);this._playerType=null;this._autoplay=!0;this._type="";this._error=null;this._passThroughEventNames=[n.EventName.volumechange,n.EventName.ended,n.EventName.timeupdate,n.EventName.pause,n.EventName.play,n.EventName.playing,n.EventName.seeking,n.EventName.seeked,n.EventName.loadstart,n.EventName.loadeddata];this._conditionalEventNames=[n.EventName.waiting,n.EventName.canplaythrough,n.EventName.error];this._registerVideoTagEvents();this._registerInternalEvents()}return Object.defineProperty(i.prototype,"src",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.src:this._sessionContext.videoTag.src},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){return this._sessionContext.videoTag.currentTime},set:function(t){n.Log.verbose(7,"currentTime: "+t+" sec");this._workflowCoordinator?this._workflowCoordinator.currentTime=t:this._sessionContext.videoTag.currentTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"volume",{get:function(){return this._sessionContext.videoTag.volume},set:function(t){n.Log.verbose(7,"volume: "+t.toString);var i=t;NaN!==t&&undefined!==t&&null!==t&&(t<0?i=0:t>1&&(i=1),this._sessionContext.videoTag.volume=i)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"autoplay",{get:function(){return this._autoplay},set:function(t){n.Log.verbose(7,"autoplay: "+t);this._autoplay=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"paused",{get:function(){return this._sessionContext.videoTag.paused},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"seeking",{get:function(){return this._sessionContext.videoTag.seeking},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ended",{get:function(){return this._sessionContext.videoTag.ended},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this._sessionContext.videoTag.height},set:function(n){this._sessionContext.videoTag.height=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this._sessionContext.videoTag.width},set:function(n){this._sessionContext.videoTag.width=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"videoHeight",{get:function(){return this._sessionContext.videoTag.videoHeight},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"videoWidth",{get:function(){return this._sessionContext.videoTag.videoWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isFullScreen",{get:function(){var n=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;return n===this._sessionContext.videoTag?document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled:!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"duration",{get:function(){return this._sessionContext.videoTag.duration},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffered",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.buffered:this._sessionContext.videoTag.buffered},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"error",{get:function(){return this._workflowCoordinator&&this._workflowCoordinator.error?this._workflowCoordinator.error:this._error},enumerable:!0,configurable:!0}),i.prototype.canPlayType=function(t){return n.PlayerType.getByPresentationType(t,this._sessionContext.videoTag)?"maybe":""},i.prototype.setSrc=function(t,i){this._sessionContext.reset();this._reset();this._type=i;this._playerType=n.PlayerType.getByPresentationType(i,this._sessionContext.videoTag);this._playerType||(this._playerType=n.PlayerType.getByUrl(t,this._sessionContext.videoTag));n.Log.verbose(7,"src: "+t+" type: "+i+" player: "+(null===this._playerType?"not known":n.PlayerDetector.Type[this._playerType]));this._workflowCoordinator&&(this._workflowCoordinator.dispose(),this._workflowCoordinator=null);this._playerType===1?(this._sessionContext.videoTag.autoplay=this._autoplay,this._sessionContext.videoTag.src=t):this._playerType===3?(this._workflowCoordinator=n.Workflow.CreateCoordinator(this._sessionContext),this._sessionContext.videoTag.autoplay=!1,this._workflowCoordinator.autoplay=this._autoplay,this._workflowCoordinator.src=t):(n.Log.error(7,t+" not supported by OnePlayer Video Element"),this._handleError(new n.Failure.External(2164261634,t)))},i.prototype.play=function(){n.Log.verbose(7,"play");this._workflowCoordinator?this._workflowCoordinator.play():this._sessionContext.videoTag.play()},i.prototype.pause=function(){n.Log.verbose(7,"pause");this._workflowCoordinator?this._workflowCoordinator.pause():this._sessionContext.videoTag.pause()},i.prototype.requestFullscreen=function(){var i,t;(n.Log.verbose(7,"requestFullscreen"),i=!1,this.isFullScreen)||(t=this._sessionContext.videoTag,t.requestFullscreen?(i=!0,t.requestFullscreen()):t.msRequestFullscreen?(i=!0,t.msRequestFullscreen()):t.webkitRequestFullscreen?(i=!0,t.webkitRequestFullscreen()):t.mozRequestFullScreen&&(i=!0,t.mozRequestFullScreen()),i&&this._sessionContext.eventMgr.dispatchEvent(n.EventName.fullscreenchange))},i.prototype.exitFullscreen=function(){n.Log.verbose(7,"exitFullscreen");var t=!1;this.isFullScreen&&(document.exitFullscreen?(t=!0,document.exitFullscreen()):document.webkitExitFullscreen?(t=!0,document.webkitExitFullscreen()):document.mozCancelFullScreen?(t=!0,document.mozCancelFullScreen()):document.msExitFullscreen&&(t=!0,document.msExitFullscreen()),t&&this._sessionContext.eventMgr.dispatchEvent(n.EventName.fullscreenchange))},i.prototype.addEventListener=function(n,t,i){typeof i=="undefined"&&(i=null);this._sessionContext.eventMgr.addHandler(n,t,i)},i.prototype.removeEventListener=function(n,t){this._sessionContext.eventMgr.removeHandler(n,t)},i.prototype.addKeySystem=function(n){return this._sessionContext.emeManager.addKeySystem(n)},i.prototype._reset=function(){function i(n){t._handleError(n)}var t=this;this._error=null;this._sessionContext.emeManager&&this._sessionContext.emeManager.dispose();this._sessionContext.emeManager=new n.KeySystem.EmeManager(this._sessionContext.videoTag);this._sessionContext.emeManager.setErrorHandler(i)},i.prototype._registerVideoTagEvents=function(){function r(i){n.Log.verbose(7,"dispatching event: "+i.type);t._sessionContext.eventMgr.dispatchEvent(i.type)}function u(i){if(n.EventName.error===i.type){if(t._sessionContext.videoTag.readyState===HTMLMediaElement.HAVE_NOTHING){n.Log.warning(7,"Ignoring video element error since state is HAVE_NOTHING "+n.Failure.mediaErrorToString(t._sessionContext.videoTag.error));return}var r=new n.Failure.External;r.translateMediaError(t._sessionContext.videoTag.error);t._handleError(r)}else t._workflowCoordinator||(n.Log.verbose(7,"dispatching event: "+i.type),t._sessionContext.eventMgr.dispatchEvent(i.type))}var i=this,t=this;this._passThroughEventNames.forEach(function(n){i._sessionContext.videoTag.addEventListener(n,r)});this._conditionalEventNames.forEach(function(n){i._sessionContext.videoTag.addEventListener(n,u)})},i.prototype._registerInternalEvents=function(){function i(t){if(t.message){n.Log.error(7,"Throwing error "+t.message);throw new Error(t.message);}}this._sessionContext.eventMgr.addHandler(t.exception,i,this)},i.prototype._handleError=function(t){this._workflowCoordinator&&this._workflowCoordinator.error||(this._error=t,this._workflowCoordinator&&(n.Log.verbose(7,"Disposing WorkflowCoordinator b/c "+t.toString()),this._workflowCoordinator.dispose(),this._workflowCoordinator=null),n.Log.verbose(7,"dispatching event: "+n.EventName.error),this._sessionContext.eventMgr.dispatchEvent(n.EventName.error))},i}()}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";var e=function(){function n(){this.windowSizeHeuristicsEnabled=n._windowSizeHeuristicsEnabledDefault;this.preFetchDataEnabled=n._preFetchDataEnabledDefault;this.vodStableBufferLevelPercent=n._vodStableBufferLevelPercentDefault;this.vodDowngradeBufferLevelPercent=n._vodDowngradeBufferLevelPercentDefault;this.belowDowngradeBufferLevelDownloadTimeFactor=n._belowDowngradeBufferLevelDownloadTimeFactorDefault;this.bandwidth=null;this.stepRule=null;this.buffer=null;this.bandwidth=new t;this.stepRule=new i;this.buffer=new r}return n.prototype.reset=function(){this.windowSizeHeuristicsEnabled=n._windowSizeHeuristicsEnabledDefault;this.preFetchDataEnabled=n._preFetchDataEnabledDefault;this.vodStableBufferLevelPercent=n._vodStableBufferLevelPercentDefault;this.vodDowngradeBufferLevelPercent=n._vodDowngradeBufferLevelPercentDefault;this.belowDowngradeBufferLevelDownloadTimeFactor=n._belowDowngradeBufferLevelDownloadTimeFactorDefault;this.bandwidth.reset();this.stepRule.reset();this.buffer.reset()},n._windowSizeHeuristicsEnabledDefault=!0,n._preFetchDataEnabledDefault=!0,n._vodStableBufferLevelPercentDefault=.7,n._vodDowngradeBufferLevelPercentDefault=.15,n._belowDowngradeBufferLevelDownloadTimeFactorDefault=.75,n}(),t,i,r,u,f;n.Heuristics=e;t=function(){function n(){this.bandwidthUsabilityPercent=n._bandwidthUsabilityPercentDefault;this.bandwidthDataSizeThresholdInBytes=n._bandwidthDataSizeThresholdInBytesDefault;this.maxBandwidthHistoryCount=n._maxBandwidthHistoryCountDefault}return n.prototype.reset=function(){this.bandwidthUsabilityPercent=n._bandwidthUsabilityPercentDefault;this.bandwidthDataSizeThresholdInBytes=n._bandwidthDataSizeThresholdInBytesDefault;this.maxBandwidthHistoryCount=n._maxBandwidthHistoryCountDefault},n._bandwidthUsabilityPercentDefault=.85,n._bandwidthDataSizeThresholdInBytesDefault=1e4,n._maxBandwidthHistoryCountDefault=5,n}();n.Bandwidth=t;i=function(){function n(){this.minSegmentsBeforeDowngrade=n._minSegmentsBeforeDowngradeDefault;this.minSegmentsBeforeUpgrade=n._minSegmentsBeforeUpgradeDefault;this.maxStepDownInQuality=n._maxStepDownInQualityDefault;this.maxStepUpInQuality=n._maxStepUpInQualityDefault}return n.prototype.reset=function(){this.minSegmentsBeforeDowngrade=n._minSegmentsBeforeDowngradeDefault;this.minSegmentsBeforeUpgrade=n._minSegmentsBeforeUpgradeDefault;this.maxStepDownInQuality=n._maxStepDownInQualityDefault;this.maxStepUpInQuality=n._maxStepUpInQualityDefault},n._minSegmentsBeforeDowngradeDefault=0,n._minSegmentsBeforeUpgradeDefault=2,n._maxStepDownInQualityDefault=10,n._maxStepUpInQualityDefault=3,n}();n.StepRule=i;r=function(){function n(){this.maxBufferInSec=n._maxBufferInSecDefault;this.prerollPercent=n._prerollPercentDefault;this.livePlaybackOffsetPercent=n._livePlaybackOffsetPercentDefault;this.lowBufferPercent=n._lowBufferPercentDefault}return n.prototype.reset=function(){this.maxBufferInSec=n._maxBufferInSecDefault;this.prerollPercent=n._prerollPercentDefault;this.lowBufferPercent=n._lowBufferPercentDefault;this.livePlaybackOffsetPercent=n._livePlaybackOffsetPercentDefault},n._maxBufferInSecDefault=30,n._prerollPercentDefault=.25,n._lowBufferPercentDefault=.25,n._livePlaybackOffsetPercentDefault=.25,n}();n.Buffer=r;u=function(){function n(){this.maxTotalRetries=n._maxTotalRetriesDefault;this.maxRetryPerSegment=n._maxRetryPerSegmentDefault;this.maxSkipSegments=n._maxSkipSegmentsDefault;this.retryLowerBitrateOnly=!1}return n._maxTotalRetriesDefault=50,n._maxRetryPerSegmentDefault=10,n._maxSkipSegmentsDefault=0,n}();n.HttpRetryPolicy=u;f=function(){function n(){this.timeoutInMSec=n._timoutInMSecDefault}return n._timoutInMSecDefault=5e3,n}();n.HttpDataRetriever=f})(n.Settings||(n.Settings={}));var t=n.Settings}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";function i(){return new e}function r(n){var t=null;if(window.hasOwnProperty("MediaSource")||window.hasOwnProperty("WebKitMediaSource"))t=window.MediaSource||window.WebKitMediaSource;else return!1;return t&&t.isTypeSupported&&t.isTypeSupported(n)}t.CreateAdapter=i;t.supported=r;var u={closed:0,open:1,ended:2},f=function(){function n(n,t,i){this.bufferIndex=n;this.startTime=t;this.endTime=i}return n}(),e=function(){function i(){this._mediaSource=new MediaSource;this._adapterSourceBuffers=new o;this._disposed=!1;this._videoTag=null;this._buffered=null}return i.prototype.dispose=function(){this._disposed||(this._mediaSource=null,this._adapterSourceBuffers.dispose(),this._adapterSourceBuffers=null,this._videoTag&&(this._videoTag.src=null,this._videoTag=null),this._disposed=!0)},Object.defineProperty(i.prototype,"readyState",{get:function(){return this._disposed?0:u[this._mediaSource.readyState]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"durationInSec",{get:function(){return this._disposed?NaN:this._mediaSource.duration},set:function(n){this._disposed||(this._mediaSource.duration=n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"adapterBuffers",{get:function(){return this._disposed?null:this._adapterSourceBuffers.adapterBuffers},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffered",{get:function(){return this._buffered},enumerable:!0,configurable:!0}),i.prototype.setVideoElementSrcAsync=function(n){var t=this;return this._videoTag=n,new Promise(function(i,r){if(t._disposed){r("VideoElementAdapter already disposed");return}t._mediaSource.addEventListener("sourceopen",function(){if(t._disposed){r("VideoElementAdapter already disposed");return}i()});n.src=URL.createObjectURL(t._mediaSource)})},i.prototype.setStartTime=function(t){function u(){!r._disposed&&r._videoTag&&r._videoTag.currentTime===0&&(r._videoTag.readyState!==HTMLMediaElement.HAVE_NOTHING?(r._videoTag.currentTime=t,n.Log.verbose(3,"StartTime set: "+t)):(n.Log.verbose(3,"Video tag not ready, will retry to set StartTime to "+t),setTimeout(u,i._setCurrentTimeTimeoutInMSec)))}var r=this;u()},i.prototype.addAdapterBuffer=function(i,r){function o(){e._updateBuffered()}if(this._disposed)return null;var e=this,u,f=null;try{u=this._mediaSource.addSourceBuffer(i);f=new t.VideoElementAdapterBuffer(r,this._videoTag,u,o);this._adapterSourceBuffers.add(f,u);n.Log.verbose(3,"Adapter buffer added: "+i+" Adapter buffer total: "+this._adapterSourceBuffers.length)}catch(s){n.Log.error(3,"Failed to add SourceBuffer to MediaSource: "+s)}return f},i.prototype.removeAdapterBuffer=function(t){if(!this._disposed){var i;i=this._adapterSourceBuffers.find(t);-1!==i?(this._mediaSource.removeSourceBuffer(this._adapterSourceBuffers.sourceBuffers[i]),this._adapterSourceBuffers.remove(i),n.Log.verbose(3,"Adapter buffer removed, remaining: "+this._adapterSourceBuffers.length)):n.Log.error(3,"Failed to remove adapter buffer: instance not found")}},i.prototype.endOfStream=function(t){this._disposed||(t?this._mediaSource.endOfStream(t):this._mediaSource.endOfStream(),n.Log.verbose(3,"End of stream signaled"))},i.prototype._updateBuffered=function(){var t,f,u,o,i;if(!this._disposed){var s=this._adapterSourceBuffers.adapterBuffers,h=new n.Common.TimeRangeSet,r=this._findUniqueStartTimes();for(t=0;t<r.length;t++){var c=r[t].startTime,e=r[t].endTime,l=!0;for(f=0;f<s.length;f++)if(u=s[f].buffered,f!==r[t].bufferIndex){for(o=!1,i=0;i<u.length;i++)if(u.start(i)<=c&&c<=u.end(i)){o=!0;u.end(i)<e&&(e=u.end(i));break}if(!o){l=!1;break}}l&&(n.Log.verbose(3,"Intersecting buffer found ("+r[t].startTime+", "+e+")"),h.addRange(new n.Common.TimeRange(r[t].startTime,e)))}this._buffered=h}},i.prototype._findUniqueStartTimes=function(){for(var t,n,i=[],u=this._adapterSourceBuffers.adapterBuffers,r=0;r<u.length;r++)for(t=u[r].buffered,n=0;n<t.length;n++)-1===i.findIndexOf(function(i){return i.startTime===t.start(n)})&&i.push(new f(r,t.start(n),t.end(n)));return i.sort(function(n,t){return n.startTime-t.startTime}),i},i._setCurrentTimeTimeoutInMSec=500,i}(),o=function(){function n(){this.adapterBuffers=[];this.sourceBuffers=[]}return n.prototype.dispose=function(){for(var n=this.adapterBuffers.length-1;n>=0;n--)this.adapterBuffers[n].dispose(),this.adapterBuffers[n]=null;for(n=this.sourceBuffers.length-1;n>=0;n--)this.sourceBuffers[n]=null},Object.defineProperty(n.prototype,"length",{get:function(){if(this.sourceBuffers.length!==this.adapterBuffers.length)throw new Error("AdapterSourceBuffers in invalid state");return this.sourceBuffers.length},enumerable:!0,configurable:!0}),n.prototype.find=function(n){return this.adapterBuffers.indexOf(n)},n.prototype.add=function(n,t){this.adapterBuffers.push(n);this.sourceBuffers.push(t)},n.prototype.remove=function(n){n>=0&&n<this.sourceBuffers.length&&(this.sourceBuffers.splice(n,1),this.adapterBuffers.splice(n,1))},n}()})(n.VideoElementAdapter||(n.VideoElementAdapter={}));var t=n.VideoElementAdapter}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(t,i,r,u){function o(){n.Log.verbose(3,"SourceBuffer 'update' event completed.");e()}function s(){n.Log.error(3,"SourceBuffer append failed with 'error' event.");e()}function e(){f._notifyBufferUpdated();f._tryInternalRemove();f._tryInternalAppend()}var f=this;this._pendingBufferRanges=new n.Common.TimeRangeSet;this._sourceBuffer=r;this._maxAdapterBufferInSec=t;this._videoTag=i;this._notifyBufferUpdated=u;this._pendingBuffer=[];this._pendingRemove=[];this._sourceBuffer.addEventListener("update",o);this._sourceBuffer.addEventListener("error",s)}return Object.defineProperty(t.prototype,"buffered",{get:function(){var t=new n.Common.TimeRangeSet,e,u,i,f,r;for(t.addRanges(this._sourceBuffer.buffered),u=t.length>0?t.end(t.length-1):NaN,i=0;i<this._pendingBufferRanges.length;i++)f=this._pendingBufferRanges.start(i),r=this._pendingBufferRanges.end(i),n.Common.diffTimes(f,u)===0?t.extendLast(r):(e=new n.Common.TimeRange(f,r),t.addRange(e)),u=r;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"presentationTimeOffsetInSec",{get:function(){return this._sourceBuffer.timestampOffset},set:function(n){this._sourceBuffer.timestampOffset=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTracks",{get:function(){return this._sourceBuffer.audioTracks},enumerable:!0,configurable:!0}),t.prototype.getBufferedAheadOfCurrentTimeInSec=function(){var t=this.buffered,i=this._videoTag.currentTime,n;for(t.removeGaps(.03),n=0;n<t.length;n++)if(t.start(n)<=i&&i<=t.end(n))return t.end(n)-i;return-1},t.prototype.bufferFull=function(){return this.getBufferedAheadOfCurrentTimeInSec()>this._maxAdapterBufferInSec},t.prototype.dispose=function(){for(var n=this._pendingBuffer.length-1;n>=0;n--)this._pendingBuffer[n]=null;for(this._sourceBuffer=null,n=this._pendingRemove.length-1;n>=0;n--)this._pendingRemove[n]=null;this._pendingBufferRanges&&(this._pendingBufferRanges.dispose(),this._pendingBufferRanges=null)},t.prototype.append=function(t,i,r){for(var s,f,e,o,u=0;u<this._pendingBuffer.length;u++)if(i<this._pendingBuffer[u].presTimeInSec)break;if(u>0&&(f=this._pendingBuffer[u-1],o=n.Common.diffTimes(i,f.presTimeInSec+f.durationInSec),o>0))throw new Error("append ("+i+","+r+") failed, overlaps with ("+f.presTimeInSec+","+f.durationInSec+")");if(u<this._pendingBuffer.length&&(e=this._pendingBuffer[u],o=n.Common.diffTimes(e.presTimeInSec,i+r),o>0))throw new Error("append ("+i+","+r+") failed, overlaps with ("+e.presTimeInSec+","+e.durationInSec+")");s=new n.Common.SegmentData(t,i,r);this._pendingBuffer.splice(u,0,s);this._updatePendingRanges();n.Log.verbose(3,"Appending segment: "+i+" sec "+t.byteLength+" bytes");this._tryInternalAppend();this._notifyBufferUpdated()},t.prototype.remove=function(t,i){var r;r=new n.Common.TimeRange(t,i);this._pendingRemove.push(r);n.Log.verbose(3,"Added to remove pending list ["+t+","+i+")");this._tryInternalRemove()},t.prototype.flush=function(){var i=this._sourceBuffer.buffered,n,t,r;if(this._sourceBuffer.updating&&this._sourceBuffer.abort(),n=0,t=0,i.length>0&&(n=i.start(0)),this._pendingBuffer.length>0&&(n=Math.min(n,this._pendingBuffer[0].presTimeInSec)),this._pendingBuffer.length>0&&(r=this._pendingBuffer[this._pendingBuffer.length-1],t=r.presTimeInSec+r.durationInSec),i.length>0&&(t=Math.max(t,i.end(i.length-1))),t>n)this.remove(n,t);else if(0!==n||0!==t)throw new Error("flush failed, endTime ("+t+") not greater than startime ("+n+")");},t.prototype._tryInternalAppend=function(){if(this._pendingBuffer&&this._sourceBuffer&&0!==this._pendingBuffer.length&&!this._sourceBuffer.updating)try{this._sourceBuffer.appendBuffer(this._pendingBuffer[0].data);n.Log.verbose(3,"Appended segment to SourceBuffer: "+this._pendingBuffer[0].presTimeInSec+" sec "+this._pendingBuffer[0].data.byteLength+" bytes");this._pendingBuffer.splice(0,1);this._updatePendingRanges()}catch(t){switch(t.code){case DOMException.INVALID_STATE_ERR:case DOMException.QUOTA_EXCEEDED_ERR:n.Log.error(3,"Failed to append segment to SourceBuffer, will retry: "+t);break;default:n.Log.error(3,"Failed to append segment to SourceBuffer: "+t);throw t;}}},t.prototype._tryInternalRemove=function(){var t,i,f,r,e;if(this._pendingBuffer&&this._sourceBuffer&&this._pendingRemove)while(0!==this._pendingRemove.length&&!this._sourceBuffer.updating){for(t=this._pendingRemove[0],i=this._pendingBuffer.length-1;i>=0;i--)if(f=this._pendingBuffer[i],r=f.presTimeInSec,e=f.durationInSec,r>=t.startInSec&&r<t.endInSec)if(r+e<=t.endInSec)this._pendingBuffer.splice(i,1),this._updatePendingRanges(),this._notifyBufferUpdated(),n.Log.verbose(3,"Segment removed: "+t.startInSec);else throw new Error("Failed to remove pending segment, range ends mid-segment");try{this._sourceBuffer.remove(t.startInSec,t.endInSec);this._pendingRemove.splice(0,1);n.Log.verbose(3,"Removing range from SourceBuffer: ["+t.startInSec+","+t.endInSec+")")}catch(u){switch(u.code){case DOMException.INVALID_ACCESS_ERR:case DOMException.INVALID_STATE_ERR:n.Log.error(3,"Failed to remove segment from SourceBuffer, will retry: "+u);break;default:n.Log.error(3,"Failed to remove segment from SourceBuffer: "+u);throw u;}}}},t.prototype._updatePendingRanges=function(){var t=this,i,r=NaN;this._pendingBufferRanges&&(this._pendingBufferRanges.dispose(),this._pendingBufferRanges=null);this._pendingBufferRanges=new n.Common.TimeRangeSet;this._pendingBuffer.forEach(function(u){n.Common.diffTimes(u.presTimeInSec,r)===0?t._pendingBufferRanges.extendLast(u.endTimestampInSec):(i=new n.Common.TimeRange(u.presTimeInSec,u.endTimestampInSec),t._pendingBufferRanges.addRange(i));r=u.endTimestampInSec})},t}();t.VideoElementAdapterBuffer=i})(n.VideoElementAdapter||(n.VideoElementAdapter={}));var t=n.VideoElementAdapter}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";function i(n){return new r(n)}t.CreateCoordinator=i;var r=function(){function i(n){this._sessionContext=n;this._workflowSeq=t.CreateSequencer(this._sessionContext);this._mediaSource=null;this._pendingPresentation=new Date;this._disposed=!1;this._pendingPlay=!0;this._pendingTryMediaRequestCount=0;this._prerollMet=!1;this._error=null}return i.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._sessionContext=null,this._pendingPresentation=null,this._mediaSource&&(this._mediaSource.dispose(),this._mediaSource=null),this._workflowSeq&&(this._workflowSeq.dispose(),this._workflowSeq=null))},Object.defineProperty(i.prototype,"src",{get:function(){return this._sessionContext.presentationUrl},set:function(t){function r(t){function u(){i._disposed||(r.periods[0].streams.forEach(function(r){if(r.streamingInfo.selected){if(r.streamingInfo.sourceBuffer=i._mediaSource.addAdapterBuffer(r.codec,t.sessionContext.maxBufferInSec()),null==r.streamingInfo.sourceBuffer)throw new Error("presentationWorkflowResolved: Failed to create source buffer for stream "+n.Presentation.StreamType[r.type]);r.streamingInfo.sourceBuffer.presentationTimeOffsetInSec=r.presentationTimeOffsetInSec}}),i._updateLiveStartPosition(),i._mediaSource.durationInSec=r.durationInSec,i._registerVideoTagEvents(),i._checkMediaWorkflow(),t.dispose())}function f(n){throw new Error(n);}var r=null;if(n.Log.verbose(1,"presentationWorkflowResolved"),!i._disposed){if(null===t.sessionContext.commonPresentation)throw new Error("presentationWorkflowResolved: unexpected null values");r=t.sessionContext.commonPresentation;i._sessionContext.emeManager.setCodec("video/mp4");i._mediaSource=n.VideoElementAdapter.CreateAdapter();i._mediaSource.setVideoElementSrcAsync(t.sessionContext.videoTag).then(u,f).catch(function(t){i._sessionContext.eventMgr.dispatchEvent(n.InternalEventName.exception,t)})}}function u(t){(n.Log.error(1,"presentationWorkflowRejected: "+t.currentModuleId),i._disposed)||(t.externalFailure&&n.Failure.isExternalError(t.externalFailure.code)&&(i._error=new n.Failure.External(t.externalFailure.code,t.externalFailure.message),n.Log.error(1,"Dispatching error: "+i.error.toString()),t.sessionContext.eventMgr.dispatchEvent(n.EventName.error)),t.dispose())}n.Log.verbose(1,"src("+t+")");var i=this;this._sessionContext.presentationUrl=t;this._presentationWorkflowAsync(r,u)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{set:function(t){var r,u,i;for(n.Log.verbose(1,"currentTime("+t.toFixed(3)+")"),r=this._sessionContext.commonPresentation.periods[0].streams,u=!1,this._sessionContext.videoTag.currentTime=t,i=0;i<r.length;i++)r[i].streamingInfo.selected&&-1===r[i].streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec()&&(r[i].streamingInfo.pendingSeekPositionInSec=t,r[i].streamingInfo.sourceBuffer.flush(),u=!0,2===r[i].streamingInfo.workflowState&&(r[i].streamingInfo.workflowState=0));this._checkMediaWorkflow();u||this._buffersAbovePreroll()||this._endOfSelectedStreams()||(u=!0);u&&(this._sessionContext.videoTag.paused||(this._pendingPlay=!0,this._sessionContext.videoTag.pause()))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"autoplay",{set:function(t){n.Log.verbose(1,"autoplay("+t+")");this._pendingPlay=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffered",{get:function(){return this._mediaSource?this._mediaSource.buffered:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"error",{get:function(){return this._error},enumerable:!0,configurable:!0}),i.prototype.play=function(){n.Log.verbose(1,"play()");this._buffersAbovePreroll()||this._endOfSelectedStreams()?this._startPlayback():this._pendingPlay=!0},i.prototype.pause=function(){n.Log.verbose(1,"pause()");this._pendingPlay&&(this._pendingPlay=!1);this._sessionContext.videoTag.pause()},i.prototype._presentationWorkflowAsync=function(t,i){function u(){r._disposed||(!r._sessionContext.commonPresentation||r._sessionContext.commonPresentation.isLive)&&r._workflowSeq.presentationRequestAsync().then(f,e).catch(function(t){r._sessionContext.eventMgr.dispatchEvent(n.InternalEventName.exception,t)})}function f(i){if(n.Log.verbose(1,"presentationRequestResolved"),!r._disposed){if(null===i.sessionContext.commonPresentation)throw new Error("presentationRequestResolved: unexpected null values");var f=new Date;i.sessionContext.commonPresentation.isLive&&r._pendingPresentation<=f&&(r._pendingPresentation.setTime(f.getTime()+2e3),setTimeout(u,2e3));t&&(t(i),t=null)}}function e(t){n.Log.error(1,"presentationRequestRejected: "+t.currentModuleId);i&&i(t)}var r=this;setTimeout(u,0)},i.prototype._checkMediaWorkflow=function(){function u(){var c,h,s,o;if(n.Log.verbose(1,"_doCheckMediaWorkflow"),c=[],t._pendingTryMediaRequestCount--,!t._disposed){for(r.videoTag.paused||t._endOfSelectedStreams()||!t._buffersNearEmpty()?t._buffersAbovePreroll()&&(t._prerollMet||(t._prerollMet=!0,r.eventMgr.dispatchEvent(n.EventName.canplaythrough)),t._pendingPlay&&t._startPlayback()):(r.eventMgr.dispatchEvent(n.EventName.waiting),t._pendingPlay=!0,r.videoTag.pause()),h=!1,s=0;s<r.commonPresentation.periods[0].streams.length;s++)o=r.commonPresentation.periods[0].streams[s],o.streamingInfo.selected&&0===o.streamingInfo.workflowState&&(o.streamingInfo.sourceBuffer.bufferFull()?h=!0:(n.Log.verbose(1,"starting media workflow "+n.Presentation.StreamType[o.type]),o.streamingInfo.workflowState=1,t._workflowSeq.mediaRequestAsync(o).then(f,e).catch(function(t){r.eventMgr.dispatchEvent(n.InternalEventName.exception,t)})));h&&0===t._pendingTryMediaRequestCount&&(n.Log.verbose(1,"_doCheckMediaWorkflow: schedule try again"),t._pendingTryMediaRequestCount++,setTimeout(u,i._mediaSegmentTimeoutInMSec))}}function f(i){var u=i.requestedStream,r;if(!t._disposed){for(u.streamingInfo.workflowState=0,1===i.state&&null===u.streamingInfo.pendingSeekPositionInSec&&(n.Log.verbose(1,"mediaRequestResolved: "+n.Presentation.StreamType[u.type]+" end of stream"),u.streamingInfo.workflowState=2,t._endOfSelectedStreams()&&(n.Log.verbose(1,"End of selected streams"),t._mediaSource.endOfStream(),t._pendingPlay&&t._startPlayback())),r=0;r<i.urlsToRetrieve.length;r++){if(null===i.urlsToRetrieve[r].mediaData)throw new Error("mediaRequestResolved: data is null url: "+i.urlsToRetrieve[r].url);null===u.streamingInfo.pendingSeekPositionInSec?(n.Log.verbose(1,"mediaRequestResolved appending url: "+i.urlsToRetrieve[r].url+"("+i.urlsToRetrieve[r].httpResposeContentType+", "+i.urlsToRetrieve[r].mediaData.byteLength+")"),u.streamingInfo.sourceBuffer.append(i.urlsToRetrieve[r].mediaData,i.urlsToRetrieve[r].presTimeInSec,i.urlsToRetrieve[r].durationInSec)):n.Log.verbose(1,"mediaRequestResolved discarding, seek in progress url: "+i.urlsToRetrieve[r].url+"("+i.urlsToRetrieve[r].httpResposeContentType+", "+i.urlsToRetrieve[r].mediaData.byteLength+")")}t._checkMediaWorkflow();i.dispose()}}function e(i){t._disposed||(n.Log.error(1,"mediaRequestRejected: "+n.Presentation.StreamType[i.requestedStream.type]+" module: "+i.currentModuleId),i.externalFailure&&n.Failure.isExternalError(i.externalFailure.code)&&(t._error=new n.Failure.External(i.externalFailure.code,i.externalFailure.message),n.Log.error(1,"Dispatching error: "+t.error.toString()),r.eventMgr.dispatchEvent(n.EventName.error)),i.dispose())}var t=this,r=t._sessionContext;this._pendingTryMediaRequestCount++;setTimeout(u,0)},i.prototype._updateLiveStartPosition=function(){var r=this._sessionContext,i=r.commonPresentation,u,e=r.liveStartBufferInSec(),t=Infinity,f;if(i&&i.isLive&&i.periods&&!(i.periods.length<1)&&i.periods[0].streams&&isNaN(r.startPositionInSec)){for(u=i.periods[0].streams,u.forEach(function(n){var i,r;i=n.segments.last.segmentInfo;r=Math.max(0,i.presTimeInSec+i.durationInSec-e);t=Math.min(r,t)}),f=0;f<u.length;f++)if(t<u[f].segments.first.segmentInfo.presTimeInSec){t=Infinity;break}isFinite(t)?(this._mediaSource.setStartTime(t),r.startPositionInSec=t):n.Log.warning(1,"Failed to set live start position")}},i.prototype._endOfSelectedStreams=function(){for(var t=this._sessionContext.commonPresentation.periods[0].streams,n=0;n<t.length;n++)if(t[n].streamingInfo.selected&&2!==t[n].streamingInfo.workflowState)return!1;return!0},i.prototype._buffersAbovePreroll=function(){var t=!0,r=this._sessionContext.videoTag,i=this._sessionContext.commonPresentation.periods[0].streams,n;if(r.HAVE_ENOUGH_DATA!==r.readyState)t=!1;else for(n=0;n<i.length;n++)if(i[n].streamingInfo.selected&&i[n].streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec()<this._sessionContext.prerollBufferInSec()){t=!1;break}return t},i.prototype._buffersNearEmpty=function(){for(var t=this._sessionContext.commonPresentation.periods[0].streams,n=0;n<t.length;n++)if(t[n].streamingInfo.selected&&t[n].streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec()<this._sessionContext.lowBufferInSec())return!0;return!1},i.prototype._startPlayback=function(){this._pendingPlay=!1;this._sessionContext.videoTag.play()},i.prototype._registerVideoTagEvents=function(){function i(){n._disposed||n._pendingPlay&&n._buffersAbovePreroll()&&n._startPlayback()}var n=this,t=n._sessionContext.videoTag;t.addEventListener("canplaythrough",i)},i._mediaSegmentTimeoutInMSec=2e3,i}()})(n.Workflow||(n.Workflow={}));var t=n.Workflow}(OnePlayer||(OnePlayer={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";function r(){return new f}function u(){return new e}t.CreatePresentation=r;t.CreateMedia=u;var i=function(){function t(t){this._eventManager=new n.Events.Manager;this._eventsOrdered=t;this._stepList=[]}return t.prototype.dispose=function(){this._eventManager.dispose();this._eventManager=null;this._eventsOrdered=null;this._stepList=null},t.prototype.addHandler=function(n,t,i){this._eventManager.addHandler(n,t,i)},t.prototype.createSteps=function(){var i=this,r=0,n,t;for(n in this._eventsOrdered)t=this._eventManager.getHandlers(this._eventsOrdered[n]),t.forEach(function(n){i._stepList[r++]=n})},Object.defineProperty(t.prototype,"stepList",{get:function(){return this._stepList},enumerable:!0,configurable:!0}),t}(),f=function(n){function t(){var t=[this.stepEvents.requestBegin,this.stepEvents.requestSend,this.stepEvents.dataRetrieved,this.stepEvents.requestEnd];n.call(this,t)}return __extends(t,n),Object.defineProperty(t.prototype,"stepEvents",{get:function(){return{requestBegin:"requestBegin",requestSend:"requestSend",dataRetrieved:"dataRetrieved",requestEnd:"requestEnd"}},enumerable:!0,configurable:!0}),t}(i),e=function(n){function t(){var t=[this.stepEvents.requestBegin,this.stepEvents.requestSend,this.stepEvents.dataRetrieved,this.stepEvents.requestEnd];n.call(this,t)}return __extends(t,n),Object.defineProperty(t.prototype,"stepEvents",{get:function(){return{requestBegin:"requestBegin",requestSend:"requestSend",dataRetrieved:"dataRetrieved",requestEnd:"requestEnd"}},enumerable:!0,configurable:!0}),t}(i)})(n.Workflow||(n.Workflow={}));var t=n.Workflow}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";function i(n){return new r(n)}t.CreateSequencer=i;var r=function(){function i(t){this._disposed=!1;this._sessionContext=t;this._orderedModules=[new n.DataRetriever.HttpRetryPolicy,new n.SegmentLocator.Dash,new n.Heuristics.InitialBandwidthDataUrlFormatter,new n.Heuristics.WindowSizeRule,new n.Heuristics.StepRule,new n.Heuristics.Engine,new n.UrlBuilder.DashUrlFormatter,new n.DataRetriever.HttpDataRetriever(t),new n.DashPresentation.Parser,new n.ContentProtection.PlayReady,new n.DashMediaSegment.Parser,new n.Presentation.InitialStreamSelector];this._createWorkflows(t)}return i.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._orderedModules.forEach(function(n){n.dispose()}),this._orderedModules=null,this._sessionContext=null)},i.prototype.presentationRequestAsync=function(){var i=this,t=this;return new Promise(function(r,u){var f=new n.Context.Request(0,t._sessionContext);f.urlsToRetrieve.push(new n.Context.UrlRequest(t._sessionContext.presentationUrl,4));i._processSteps(f,r,u)})},i.prototype.mediaRequestAsync=function(t){var i=this;return new Promise(function(r,u){var f=new n.Context.Request(1,i._sessionContext);f.requestedStream=t;f.heuristicData=new n.Context.HeuristicData(t);i._processSteps(f,r,u)})},i.prototype._processSteps=function(t,i,r){function f(){if(e._disposed||t.disposed||t.sessionContext.disposed){r();return}if(u===t.sessionContext.workflows[t.workflowType].stepList.length){t.workflowType===1?n.Log.verbose(0,"Finished process steps for "+n.Presentation.StreamType[t.requestedStream.type]+" media workflow"):n.Log.verbose(0,"Finished process steps for presentation workflow");i(t);return}var f=t.sessionContext.workflows[t.workflowType].stepList[u],h=f.functionHandler.call(f.callerInstance,t);u++;h.then(o,s)}function o(){switch(t.state){case 0:setTimeout(f,0);break;case 2:u=0;setTimeout(f,t.retryWaitTimeMSec);t.reset();break;case 1:i(t);break;default:throw new Error("processSteps unexpected state"+t.state);}}function s(i){if(null===t.externalFailure){t.sessionContext.eventMgr.dispatchEvent(n.InternalEventName.exception,i);return}var u="stepRejected: "+t.externalFailure.toString();i&&(u+=i);n.Log.error(0,u);r(t)}var e=this,u;t.workflowType===1?n.Log.verbose(0,"Starting process steps for "+n.Presentation.StreamType[t.requestedStream.type]+" media workflow"):n.Log.verbose(0,"Starting process steps for presentation workflow");u=0;setTimeout(f,0)},i.prototype._createWorkflows=function(n){n.workflows=[t.CreatePresentation(),t.CreateMedia()];this._orderedModules.forEach(function(t){t.init(n)});this._sessionContext.workflows.forEach(function(n){n.createSteps()})},i}()})(n.Workflow||(n.Workflow={}));var t=n.Workflow}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(){this.systemId=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.name="com.microsoft.playready";this._videoElement=null;this._errorHandler=null;this._session=null;this._active=!1}return t.prototype.isSupported=function(t,i){return t.isEqual(this.systemId)?n.EmeUtil.isTypeSupported(this.name,i):!1},t.prototype.activate=function(n,t){this._videoElement=n;this._errorHandler=t;this._active=!0},t.prototype.deactivate=function(){this._active&&(this._active=!1,this._session&&(n.EmeUtil.unlistenToKeyMessage(this._session,this._keyMessageHandler),n.EmeUtil.unlistenKeyError(this._session,this._keyErrorHandler),this._session.close(),this._session=null),this._videoElement=null,this._errorHandler=null)},t.prototype.initData=function(t,i){function e(n){f._keyMessageHandler(n)}function o(){f._keyErrorHandler()}var f=this,r,u;if(!this._session){if(r=n.EmeUtil.createMediaKeys(this.name),!r){n.Log.error(13,this.name+" createMediaKeys failed");u=new n.Failure.External(2164261376,this.name+" createMediaKeys failed");this._reportError(u);return}if(n.EmeUtil.setMediaKeys(this._videoElement,r),this._session=r.createSession(i,t),!this._session){n.Log.error(13,this.name+" createSession failed");u=new n.Failure.External(2164261376,this.name+" createSession failed");this._reportError(u);return}n.EmeUtil.listenToKeyMessage(this._session,e);n.EmeUtil.listenKeyError(this._session,o)}},t.prototype._keyMessageHandler=function(n){var t=this,i=new Uint16Array(n.message.buffer),r=String.fromCharCode.apply(null,i),u=n.destinationURL;this._getPlayReadyLicense(r,u).then(function(n){t._active&&t._session&&t._session.update(n)},function(n){t._active&&t._reportError(n)})},t.prototype._keyErrorHandler=function(){if(this._active&&this._session.error){var n=t._translateMediaKeyError(this._session.error);this._reportError(n)}},t.prototype._getPlayReadyLicense=function(t,i){return new Promise(function(r,u){function p(){if(f.status==200){r(new Uint8Array(f.response));return}n.Log.error(13,"Playready update, XHR status is "+f.statusText+"("+f.status+"), expected to be 200. readyState is "+f.readyState);var t=new n.Failure.External(2164261377,"Http response "+f.status+": "+f.statusText);u(t);return}function v(){n.Log.error(13,"Playready update, XHR failed status is "+f.statusText+" ("+f.status+"), readyState is "+f.readyState);var t=new n.Failure.External(2164261377,f.statusText);u(t);return}var a=null,h=[],y=new DOMParser,o=y.parseFromString(t,"application/xml"),c,s,l,e,f;if(o.getElementsByTagName("Challenge")[0])c=o.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue,c&&(a=atob(c));else{n.Log.error(13,"Playready: Can not find Challenge in keyMessage");u(new n.Failure.External(2164261377,"No challenge"));return}if(s=o.getElementsByTagName("name"),l=o.getElementsByTagName("value"),s.length!=l.length){n.Log.error(13,"Playready update, invalid header name/value pair in keyMessage");u(new n.Failure.External(2164261377,"Invalid headers"));return}for(e=0;e<s.length;e++)h[e]={name:s[e].childNodes[0].nodeValue,value:l[e].childNodes[0].nodeValue};f=new XMLHttpRequest;f.onload=p;f.onabort=v;f.onerror=v;f.open("POST",i);f.responseType="arraybuffer";h&&h.forEach(function(n){f.setRequestHeader(n.name,n.value)});f.send(a)})},t.prototype._reportError=function(n){this._errorHandler&&this._errorHandler(n)},t._translateMediaKeyError=function(t){var i=new n.Failure.External;switch(t.code){case MSMediaKeyError.MS_MEDIA_KEYERR_SERVICE:i.code=2164261378;break;case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:i.code=2164261379;break;case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:i.code=2164261380;break;case MSMediaKeyError.MS_MEDIA_KEYERR_DOMAIN:i.code=2164261381;break;case MSMediaKeyError.MS_MEDIA_KEYERR_UNKNOWN:i.code=2164261382;break;case MSMediaKeyError.MS_MEDIA_KEYERR_CLIENT:i.code=2164261383;break;default:i.code=2164261382}return i.extendedCode=t.systemCode,i},t}();t.PlayReady=i})(n.KeySystem||(n.KeySystem={}));var t=n.KeySystem}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function i(i){function f(n){u._needKeyHandler(n)}var u=this,r;this._videoElement=i;this._errorHandler=null;this.matchedKeySystem=null;this._codec=null;this._psshBoxes=[];this._keySystems={};this._disposed=!1;r=new t.PlayReady;this.addKeySystem(r);n.EmeUtil.listenToNeedKey(i,f)}return i.prototype.dispose=function(){this._disposed||(this._disposed=!0,this.matchedKeySystem&&(this.matchedKeySystem.deactivate(),this.matchedKeySystem=null),this._psshBoxes=[],this._keySystems={},this._videoElement=null,this._errorHandler=null,this._codec=null)},i.prototype.setErrorHandler=function(n){this._errorHandler=n},i.prototype.setCodec=function(n){this._codec=n},i.prototype.addKeySystem=function(t){var i=n.Common.uint8ArrayToHexString(t.systemId);return i&&i.length>0?(this._keySystems[i]&&n.Log.warning(13,"Overwriting "+t.name),this._keySystems[i]=t,t):null},i.prototype.addPsshBoxes=function(n){var t=this;n.forEach(function(n){t._psshBoxes.push(n)})},i.prototype._needKeyHandler=function(t){var u,f,i,r,e,o;if(!this._disposed)if(t.initData&&(u=new DataView(t.initData.buffer),f=n.Mp4Util.GetPsshBoxes(u),this.addPsshBoxes(f)),i=this._findMatchedKeySystem(),i)for(r=0;r<this._psshBoxes.length;r++)this._psshBoxes[r].systemId.isEqual(i.systemId)&&(e=new Uint8Array(this._psshBoxes[r].serialize()),n.Log.verbose(13,"Sending initData to: "+i.name),i.initData(e,this._codec));else o=new n.Failure.External(2164261376,"no matching keySystem found"),this._errorHandler(o)},i.prototype._findMatchedKeySystem=function(){var t,i;if(!this.matchedKeySystem)for(t=0;t<this._psshBoxes.length;t++)if(i=n.Common.uint8ArrayToHexString(this._psshBoxes[t].systemId),this._keySystems[i]&&this._keySystems[i].isSupported(this._psshBoxes[t].systemId,this._codec)){this.matchedKeySystem=this._keySystems[i];this.matchedKeySystem.activate(this._videoElement,this._errorHandler);n.Log.verbose(13,"Matched key system found: "+this.matchedKeySystem.name);break}return this.matchedKeySystem},i}();t.EmeManager=i})(n.KeySystem||(n.KeySystem={}));var t=n.KeySystem}(OnePlayer||(OnePlayer={})),function(n){"use strict";var t=function(){function n(){}return n.volumechange="volumechange",n.ended="ended",n.timeupdate="timeupdate",n.pause="pause",n.play="play",n.playing="playing",n.seeking="seeking",n.seeked="seeked",n.loadstart="loadstart",n.loadeddata="loadeddata",n.fullscreenchange="fullscreenchange",n.waiting="waiting",n.canplaythrough="canplaythrough",n.error="error",n}(),i;n.EventName=t,function(n){n[n.abortedErrStart=2164261120]="abortedErrStart";n[n.abortedErrUnknown=2164261120]="abortedErrUnknown";n[n.abortedErrNotImplemented=2164261121]="abortedErrNotImplemented";n[n.abortedErrEnd=2164261375]="abortedErrEnd";n[n.decodeErrStart=2164261376]="decodeErrStart";n[n.decryptErrKeySystemNotFound=2164261376]="decryptErrKeySystemNotFound";n[n.decryptErrKeyMessageFailed=2164261377]="decryptErrKeyMessageFailed";n[n.decryptErrKeyService=2164261378]="decryptErrKeyService";n[n.decryptErrKeyHardwareChange=2164261379]="decryptErrKeyHardwareChange";n[n.decryptErrKeyOutput=2164261380]="decryptErrKeyOutput";n[n.decryptErrKeyDomain=2164261381]="decryptErrKeyDomain";n[n.decryptErrKeyUnknown=2164261382]="decryptErrKeyUnknown";n[n.decryptErrKeyClient=2164261383]="decryptErrKeyClient";n[n.decodeErrEnd=2164261631]="decodeErrEnd";n[n.srcErrStart=2164261632]="srcErrStart";n[n.srcErrParsePresentation=2164261632]="srcErrParsePresentation";n[n.srcErrParseSegment=2164261633]="srcErrParseSegment";n[n.srcErrUnsupportedPresentation=2164261634]="srcErrUnsupportedPresentation";n[n.srcErrUnsupportedSegment=2164261635]="srcErrUnsupportedSegment";n[n.srcErrInvalidPresentation=2164261636]="srcErrInvalidPresentation";n[n.srcErrInvalidSegment=2164261637]="srcErrInvalidSegment";n[n.srcErrEnd=2164261887]="srcErrEnd";n[n.networkErrStart=2164261888]="networkErrStart";n[n.networkErrHttpBadUrlFormat=2164261888]="networkErrHttpBadUrlFormat";n[n.networkErrHttpUserAuthRequired=2164261889]="networkErrHttpUserAuthRequired";n[n.networkErrHttpUserForbidden=2164261890]="networkErrHttpUserForbidden";n[n.networkErrHttpUrlNotFound=2164261891]="networkErrHttpUrlNotFound";n[n.networkErrHttpInternalServerFailure=2164261892]="networkErrHttpInternalServerFailure";n[n.networkErrHttpBadGateway=2164261893]="networkErrHttpBadGateway";n[n.networkErrHttpServiceUnavailable=2164261894]="networkErrHttpServiceUnavailable";n[n.networkErrHttpGatewayTimeout=2164261895]="networkErrHttpGatewayTimeout";n[n.networkErrHttpUnknown=2164262088]="networkErrHttpUnknown";n[n.networkErrTimeout=2164262089]="networkErrTimeout";n[n.networkErrUnknown=2164262090]="networkErrUnknown";n[n.networkErrEnd=2164262143]="networkErrEnd"}(n.ExtendedCode||(n.ExtendedCode={}));i=n.ExtendedCode}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";var t,i;(function(n){n[n.video=0]="video";n[n.audio=1]="audio";n[n.text=2]="text"})(n.StreamType||(n.StreamType={}));t=n.StreamType,function(n){n[n.playReadySpecificData=0]="playReadySpecificData"}(n.ContentProtectionDataType||(n.ContentProtectionDataType={}));i=n.ContentProtectionDataType})(n.Presentation||(n.Presentation={}));var t=n.Presentation}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";(function(n){n[n.closed=0]="closed";n[n.open=1]="open";n[n.ended=2]="ended"})(n.ReadyState||(n.ReadyState={}));var t=n.ReadyState})(n.VideoElementAdapter||(n.VideoElementAdapter={}));var t=n.VideoElementAdapter}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";(function(n){n[n.presentation=0]="presentation";n[n.media=1]="media";n[n.max=2]="max"})(n.Type||(n.Type={}));var t=n.Type})(n.Workflow||(n.Workflow={}));var t=n.Workflow}(OnePlayer||(OnePlayer={}));Dash=function(){"use strict";return{modules:{},dependencies:{},vo:{},di:{}}}();Dash.dependencies.DashParser=function(){"use strict";var u=31536e3,f=2592e3,e=86400,o=3600,n=60,s=60,t=1e3,i=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,h=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,c=[{type:"duration",test:function(n){return i.test(n)},converter:function(t){var r=i.exec(t);return parseFloat(r[2]||0)*u+parseFloat(r[4]||0)*f+parseFloat(r[6]||0)*e+parseFloat(r[8]||0)*o+parseFloat(r[10]||0)*n+parseFloat(r[12]||0)}},{type:"datetime",test:function(n){return r.test(n)},converter:function(i){var u=r.exec(i),f,e;return f=Date.UTC(parseInt(u[1],10),parseInt(u[2],10)-1,parseInt(u[3],10),parseInt(u[4],10),parseInt(u[5],10),u[6]&&parseInt(u[6],10)||0,u[7]&&parseFloat(u[7])*t||0),u[9]&&u[10]&&(e=parseInt(u[9],10)*s+parseInt(u[10],10),f+=(u[8]==="+"?-1:1)*e*n*t),new Date(f)}},{type:"numeric",test:function(n){return h.test(n)},converter:function(n){return parseFloat(n)}}],l=function(){var n,t,i,r;return r=[{name:"profiles",merge:!1},{name:"width",merge:!1},{name:"height",merge:!1},{name:"sar",merge:!1},{name:"frameRate",merge:!1},{name:"audioSamplingRate",merge:!1},{name:"mimeType",merge:!1},{name:"segmentProfiles",merge:!1},{name:"codecs",merge:!1},{name:"maximumSAPPeriod",merge:!1},{name:"startsWithSap",merge:!1},{name:"maxPlayoutRate",merge:!1},{name:"codingDependency",merge:!1},{name:"scanType",merge:!1},{name:"FramePacking",merge:!0},{name:"AudioChannelConfiguration",merge:!0},{name:"ContentProtection",merge:!0}],n={},n.name="AdaptationSet",n.isRoot=!1,n.isArray=!0,n.parent=null,n.children=[],n.properties=r,t={},t.name="Representation",t.isRoot=!1,t.isArray=!0,t.parent=n,t.children=[],t.properties=r,n.children.push(t),i={},i.name="SubRepresentation",i.isRoot=!1,i.isArray=!0,i.parent=t,i.children=[],i.properties=r,t.children.push(i),n},a=function(){var n,t,i,r;return r=[{name:"SegmentBase",merge:!0},{name:"SegmentTemplate",merge:!0},{name:"SegmentList",merge:!0}],n={},n.name="Period",n.isRoot=!1,n.isArray=!0,n.parent=null,n.children=[],n.properties=r,t={},t.name="AdaptationSet",t.isRoot=!1,t.isArray=!0,t.parent=n,t.children=[],t.properties=r,n.children.push(t),i={},i.name="Representation",i.isRoot=!1,i.isArray=!0,i.parent=t,i.children=[],i.properties=r,t.children.push(i),n},v=function(){var i,n,t,r,u;return u=[{name:"BaseURL",merge:!0,mergeFunction:function(n,t){return t.indexOf("http://")===0?t:n+t}}],i={},i.name="mpd",i.isRoot=!0,i.isArray=!0,i.parent=null,i.children=[],i.properties=u,n={},n.name="Period",n.isRoot=!1,n.isArray=!0,n.parent=null,n.children=[],n.properties=u,i.children.push(n),t={},t.name="AdaptationSet",t.isRoot=!1,t.isArray=!0,t.parent=n,t.children=[],t.properties=u,n.children.push(t),r={},r.name="Representation",r.isRoot=!1,r.isArray=!0,r.parent=t,r.children=[],r.properties=u,t.children.push(r),i},y=function(){var n=[];return n.push(l()),n.push(a()),n.push(v()),n},p=function(n,t){var i,e=new X2JS(c,"",!0),o=new ObjectIron(y()),f=new Date,r=null,u=null;try{i=e.xml_str2json(n);r=new Date;i.hasOwnProperty("BaseURL")?(i.BaseURL=i.BaseURL_asArray[0],i.BaseURL.toString().indexOf("http")!==0&&(i.BaseURL=t+i.BaseURL)):i.BaseURL=t;o.run(i);u=new Date;this.debug.log("Parsing complete: ( xml2json: "+(r.getTime()-f.getTime())+"ms, objectiron: "+(u.getTime()-r.getTime())+"ms, total: "+(u.getTime()-f.getTime())/1e3+"s)")}catch(s){return this.errHandler.manifestError("parsing the manifest failed","parse",n),null}return i};return{debug:undefined,errHandler:undefined,parse:p}};Dash.dependencies.DashParser.prototype={constructor:Dash.dependencies.DashParser};!function(){var n,t,r,i;!function(){var u={},f={};n=function(n,t,i){u[n]={deps:t,callback:i}};i=r=t=function(n){function l(t){var i;if("."!==t.charAt(0))return t;for(var f=t.split("/"),r=n.split("/").slice(0,-1),u=0,e=f.length;e>u;u++)if(i=f[u],".."===i)r.pop();else{if("."===i)continue;r.push(i)}return r.join("/")}var c;if(i._eak_seen=u,f[n])return f[n];if(f[n]={},!u[n])throw new Error("Could not find module "+n);for(var s,h=u[n],e=h.deps,a=h.callback,o=[],r=0,v=e.length;v>r;r++)"exports"===e[r]?o.push(s={}):o.push(t(l(e[r])));return c=a.apply(this,o),f[n]=s||c}}();n("promise/all",["./utils","exports"],function(n,t){"use strict";function i(n){var t=this;if(!r(n))throw new TypeError("You must pass an array to all.");return new t(function(t,i){function h(n){return function(t){e(n,t)}}function e(n,i){o[n]=i;0==--s&&t(o)}var f,o=[],s=n.length,r;for(0===s&&t([]),r=0;r<n.length;r++)f=n[r],f&&u(f.then)?f.then(h(r),i):e(r,f)})}var r=n.isArray,u=n.isFunction;t.all=i});n("promise/asap",["exports"],function(n){"use strict";function e(){return function(){process.nextTick(i)}}function o(){var n=0,r=new f(i),t=document.createTextNode("");return r.observe(t,{characterData:!0}),function(){t.data=n=++n%2}}function s(){return function(){c.setTimeout(i,1)}}function i(){for(var n=0;n<t.length;n++){var i=t[n],r=i[0],u=i[1];r(u)}t=[]}function h(n,i){var u=t.push([n,i]);1===u&&r()}var r,u="undefined"!=typeof window?window:{},f=u.MutationObserver||u.WebKitMutationObserver,c="undefined"!=typeof global?global:void 0===this?window:this,t=[];r="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?e():f?o():s();n.asap=h});n("promise/config",["exports"],function(n){"use strict";function i(n,i){return 2!==arguments.length?t[n]:(t[n]=i,void 0)}var t={instrument:!1};n.config=t;n.configure=i});n("promise/polyfill",["./promise","./utils","exports"],function(n,t,i){"use strict";function r(){var n,t;n="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;t="Promise"in n&&"resolve"in n.Promise&&"reject"in n.Promise&&"all"in n.Promise&&"race"in n.Promise&&function(){var t;return new n.Promise(function(n){t=n}),f(t)}();t||(n.Promise=u)}var u=n.Promise,f=t.isFunction;i.polyfill=r});n("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(n,t,i,r,u,f,e,o){"use strict";function s(n){if(!v(n))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof s))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[];nt(n,this)}function nt(n,t){function r(n){c(t,n)}function i(n){h(t,n)}try{n(r,i)}catch(u){i(u)}}function w(n,t,i,r){var u,e,f,o,s=v(i);if(s)try{u=i(r);f=!0}catch(l){o=!0;e=l}else u=r,f=!0;k(t,u)||(s&&f?c(t,u):o?h(t,e):n===y?c(t,u):n===p&&h(t,u))}function tt(n,t,i,r){var u=n._subscribers,f=u.length;u[f]=t;u[f+y]=i;u[f+p]=r}function b(n,t){for(var u,f,r=n._subscribers,e=n._detail,i=0;i<r.length;i+=3)u=r[i],f=r[i+t],w(t,u,f,e);n._subscribers=null}function k(n,t){var i,r=null;try{if(n===t)throw new TypeError("A promises callback cannot return that same promise.");if(ut(t)&&(r=t.then,v(r)))return r.call(t,function(r){return i?!0:(i=!0,t!==r?c(n,r):a(n,r),void 0)},function(t){return i?!0:(i=!0,h(n,t),void 0)}),!0}catch(u){return i?!0:(h(n,u),!0)}return!1}function c(n,t){n===t?a(n,t):k(n,t)||a(n,t)}function a(n,t){n._state===d&&(n._state=g,n._detail=t,l.async(it,n))}function h(n,t){n._state===d&&(n._state=g,n._detail=t,l.async(rt,n))}function it(n){b(n,n._state=y)}function rt(n){b(n,n._state=p)}var l=n.config,ut=(n.configure,t.objectOrFunction),v=t.isFunction,ft=(t.now,i.all),et=r.race,ot=u.resolve,st=f.reject,ht=e.asap;l.async=ht;var d=void 0,g=0,y=1,p=2;s.prototype={constructor:s,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(n,t){var i=this,r=new this.constructor(function(){}),u;return this._state?(u=arguments,l.async(function(){w(i._state,r,u[i._state-1],i._detail)})):tt(this,r,n,t),r},"catch":function(n){return this.then(null,n)}};s.all=ft;s.race=et;s.resolve=ot;s.reject=st;o.Promise=s});n("promise/race",["./utils","exports"],function(n,t){"use strict";function i(n){var t=this;if(!r(n))throw new TypeError("You must pass an array to race.");return new t(function(t,i){for(var r,u=0;u<n.length;u++)r=n[u],r&&"function"==typeof r.then?r.then(t,i):t(r)})}var r=n.isArray;t.race=i});n("promise/reject",["exports"],function(n){"use strict";function t(n){var t=this;return new t(function(t,i){i(n)})}n.reject=t});n("promise/resolve",["exports"],function(n){"use strict";function t(n){if(n&&"object"==typeof n&&n.constructor===this)return n;var t=this;return new t(function(t){t(n)})}n.resolve=t});n("promise/utils",["exports"],function(n){"use strict";function i(n){return t(n)||"object"==typeof n&&null!==n}function t(n){return"function"==typeof n}function r(n){return"[object Array]"===Object.prototype.toString.call(n)}var u=Date.now||function(){return(new Date).getTime()};n.objectOrFunction=i;n.isFunction=t;n.isArray=r;n.now=u});t("promise/polyfill").polyfill()}();UTF8={};UTF8.encode=function(n){for(var t,i=[],r=0;r<n.length;++r)t=n.charCodeAt(r),t<128?i.push(t):t<2048?(i.push(192|t>>6),i.push(128|63&t)):t<65536?(i.push(224|t>>12),i.push(128|63&t>>6),i.push(128|63&t)):(i.push(240|t>>18),i.push(128|63&t>>12),i.push(128|63&t>>6),i.push(128|63&t));return i};UTF8.decode=function(n){for(var r=[],i=0,t;i<n.length;)t=n[i++],t<128||(t<224?t=(31&t)<<6|63&n[i++]:t<240?(t=(15&t)<<12,t|=(63&n[i++])<<6,t|=63&n[i++]):(t=(7&t)<<18,t|=(63&n[i++])<<12,t|=(63&n[i++])<<6,t|=63&n[i++])),r.push(String.fromCharCode(t));return r.join("")};BASE64={},function(n){var u=function(t){for(var u=0,i=[],f=0|t.length/3,r;0<f--;)r=(t[u]<<16)+(t[u+1]<<8)+t[u+2],u+=3,i.push(n.charAt(63&r>>18)),i.push(n.charAt(63&r>>12)),i.push(n.charAt(63&r>>6)),i.push(n.charAt(63&r));return 2==t.length-u?(r=(t[u]<<16)+(t[u+1]<<8),i.push(n.charAt(63&r>>18)),i.push(n.charAt(63&r>>12)),i.push(n.charAt(63&r>>6)),i.push("=")):1==t.length-u&&(r=t[u]<<16,i.push(n.charAt(63&r>>18)),i.push(n.charAt(63&r>>12)),i.push("==")),i.join("")},t=function(){for(var i=[],t=0;t<n.length;++t)i[n.charCodeAt(t)]=t;return i["=".charCodeAt(0)]=0,i}(),r=function(n){for(var r=0,i=[],f=0|n.length/4,u;0<f--;)u=(t[n.charCodeAt(r)]<<18)+(t[n.charCodeAt(r+1)]<<12)+(t[n.charCodeAt(r+2)]<<6)+t[n.charCodeAt(r+3)],i.push(255&u>>16),i.push(255&u>>8),i.push(255&u),r+=4;return i&&("="==n.charAt(r-2)?(i.pop(),i.pop()):"="==n.charAt(r-1)&&i.pop()),i},i={};i.encode=function(n){for(var i=[],t=0;t<n.length;++t)i.push(n.charCodeAt(t));return i};i.decode=function(){for(var n=0;n<s.length;++n)a[n]=String.fromCharCode(a[n]);return a.join("")};BASE64.decodeArray=function(n){var t=r(n);return new Uint8Array(t)};BASE64.encodeASCII=function(n){var t=i.encode(n);return u(t)};BASE64.decodeASCII=function(n){var t=r(n);return i.decode(t)};BASE64.encode=function(n){var t=UTF8.encode(n);return u(t)};BASE64.decode=function(n){var t=r(n);return UTF8.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");undefined===btoa&&(btoa=BASE64.encode);undefined===atob&&(atob=BASE64.decode),function(n){(function(t){"use strict";var r=function(){function t(t){this._bandwidthSettings=t;this._averageCalc=new n.Util.AverageCalculator(this._bandwidthSettings.maxBandwidthHistoryCount)}return Object.defineProperty(t.prototype,"averageBandwidthInKbps",{get:function(){return this._averageCalc.average},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"latestInKbps",{get:function(){return this._averageCalc.latest},enumerable:!0,configurable:!0}),t.prototype.updateBandwidthInfo=function(t){if(t.responseLengthInBytes<this._bandwidthSettings.bandwidthDataSizeThresholdInBytes){n.Log.verbose(5,"Ignoring Bandwidth data as data size :"+t.responseLengthInBytes+" which is less that the limit :"+this._bandwidthSettings.bandwidthDataSizeThresholdInBytes);return}var i=t.responseEndTimeInMS-t.requestStartTimeInMS,r=t.responseLengthInBytes*8/i;this._averageCalc.addValue(r);n.Log.verbose(5,"updateBandWidthInfo -  currentBw: "+this._averageCalc.latest+" averageBw: "+this._averageCalc.average+" size: "+t.responseLengthInBytes+" time Took:"+i)},t.prototype.reportHeuristicsData=function(t,i){var e=this._averageCalc.average*1e3,u=e*this._bandwidthSettings.bandwidthUsabilityPercent,r,f;for(n.Log.verbose(5,"averageBW reporting is : "+u),r=0;r<t.tracksData.length;r++)t.tracksData[r].selectable&&(f=t.tracksData[r].trackInfo.bitrate*i,t.tracksData[r].dataRetrieverEstimationInSec=u?f/u:Infinity)},t}(),i;t.BandwidthTracker=r;i=function(){function n(){this.requestStartTimeInMS=(new Date).getTime();this.responseStartTimeInMS=null;this.responseEndTimeInMS=null;this.responseLengthInBytes=0}return n}();t.BandwidthInfo=i})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="DashMediaSegmentParser"}return t.prototype.dispose=function(){},t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.dataRetrieved,this.onGetData,this)},t.prototype.onGetData=function(t){function i(t,i){var r=0;return i.flags&n.Mp4Util.TrunBox.flags_sampleDurationPresent?i.sampleInfoArray.forEach(function(n){r+=n.sampleDuration}):t.defaultSampleDuration?r=t.defaultSampleDuration*i.sampleCount:n.Log.warning(11,"Cannot calculate segment duration from 'tfhd' and 'trun'"),r}return t.currentModuleId=this._moduleId,new Promise(function(r){var l,o,u,s,h,e,c,f;if(f=t.requestedStream.streamingInfo.currentSegment,!t.sessionContext.commonPresentation.isLive||f.segmentInfo.mediaDuration){r();return}if(!t.urlsToRetrieve[0].mediaData)throw new Error(t.urlsToRetrieve[0].url+": no media segment data found");if(l=new DataView(t.urlsToRetrieve[0].mediaData),o=n.Mp4Util.GetBoxByType(l,"moof"),!o){n.Log.warning(11,"moof not found");r();return}if(u=n.Mp4Util.GetBoxByType(o.data,"traf"),!u){n.Log.warning(11,"traf not found");r();return}if(s=n.Mp4Util.GetTfhdBox(u.data),!s){r();return}if(h=n.Mp4Util.GetTrunBox(u.data),!h){r();return}if(e=n.Mp4Util.GetTfdtBox(u.data),!e){r();return}if(n.Common.diffTimes(e.baseMediaDecodeTime,f.segmentInfo.mediaTimestamp))throw new Error("Segment mismatch, requested: "+f.segmentInfo.mediaTimestamp+" got: "+e.baseMediaDecodeTime);c=i(s,h);n.Log.verbose(11,"Segment duration: "+c);f.segmentInfo.mediaDuration=c;r()})},t}();t.Parser=i})(n.DashMediaSegment||(n.DashMediaSegment={}));var t=n.DashMediaSegment}(OnePlayer||(OnePlayer={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";function a(n){var t;if("schemeIdUri"in n)t=n.schemeIdUri;else throw new Error("ContentProtection missing @schemeIdUri");return t.toLowerCase()===r.schemeIdUri?new r(n):new s(n)}var l=function(){function t(){this._moduleId="DashPresentationParser"}return t.prototype.dispose=function(){},t.prototype.init=function(n){var t=n.workflows[0];t.addHandler(t.stepEvents.dataRetrieved,this.onParse,this)},t.prototype.onParse=function(i){return i.currentModuleId=this._moduleId,new Promise(function(r,f){var e,o,c,l,s,h;if(!i.urlsToRetrieve[0].presentationData)throw new Error(i.urlsToRetrieve[0].url+": no presentation data found");if(e=i.sessionContext,h=t._getPublishTime(i.urlsToRetrieve[0].presentationData),h&&e.commonPresentation&&e.commonPresentation.publishTime&&e.commonPresentation.publishTime.getTime()===Date.parse(h)){n.Log.verbose(4,"skipping MPD parse, same publish time as previous");r();return}if(o=e.presentationUrl,c=o.lastIndexOf("/"),l=o.slice(0,c+1),s=new u(i.urlsToRetrieve[0].presentationData,l),!s){n.Failure.attachFailureToRequest(i,i.currentModuleId,2164261632,i.urlsToRetrieve[0].url+": failed to generate DASH presentation");f("failed to generate DASH presentation");return}e.updatePresentation(s);n.Log.verbose(4,"MPD updated");r()})},t._getPublishTime=function(n){var t,i,r="";return n&&(t=n.match(/<MPD[^>]*>/i),t&&t.length>0&&(i=t[0].match(/publishTime="[^"]*/i),i&&i.length>0&&(r=i[0].slice(13)))),r},t}(),u,f,e,o,i,r,s,h,c;t.Parser=l;u=function(){function t(n,t){var u=this,i,r=[];if(this._lastRetrievalTime=new Date,i=Dash.dependencies.DashParser(),i.debug=new h,i.errHandler=new c,this._manifest=i.parse(n,t),"Period_asArray"in this._manifest&&this._manifest.Period_asArray.length>0&&this._manifest.Period_asArray.forEach(function(n){r.push(new f(n,u.publishTime))}),this._periods=r,r.length>1)throw new Error("Error parsing MPD: multiple periods not supported");}return t.prototype.dispose=function(){this._periods&&(this._periods.forEach(function(n){n.dispose()}),this._periods=[]);this._manifest=null;this._lastRetrievalTime=null},Object.defineProperty(t.prototype,"startTime",{get:function(){var n=null;return"availabilityStartTime"in this._manifest&&(n=new Date(this._manifest.availabilityStartTime)),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"publishTime",{get:function(){return"publishTime"in this._manifest?new Date(this._manifest.publishTime):this._lastRetrievalTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLive",{get:function(){return this._manifest.type==="dynamic"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationInSec",{get:function(){var n=0;return"mediaPresentationDuration"in this._manifest&&(n=this._manifest.mediaPresentationDuration),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"periods",{get:function(){return this._periods},enumerable:!0,configurable:!0}),t.prototype.toJson=function(){return this._manifest},t.prototype.transferPresentationState=function(t){var e=t,i=[],r=[],f,u;for(this._manifest=e._manifest,this._lastRetrievalTime=e._lastRetrievalTime,this.periods.forEach(function(n){i.push(n)}),e.periods.forEach(function(n){r.push(n)}),f=0;f<r.length;f++)for(u=0;u<i.length;u++)if(i[u]&&r[f].startInSec===i[u].startInSec){i[u].transferPeriodState(r[f]);r[f]=null;i[u]=null;break}i=i.filter(function(n){return!!n});r=r.filter(function(n){return!!n});i.length>0&&n.Log.verbose(4,"Periods removed from MPD: "+i.length);r.length>0&&n.Log.verbose(4,"Periods added to MPD: "+r.length)},t}();t.Mpd=u;f=function(){function t(n,t){var r=this,i=[];this.startInSec="start"in n?n.start:0;"AdaptationSet_asArray"in n&&n.AdaptationSet_asArray.length>0&&n.AdaptationSet_asArray.forEach(function(n){i.push(new e(n,t,r.startInSec))});this._streams=i}return Object.defineProperty(t.prototype,"streams",{get:function(){return this._streams},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._streams&&(this._streams.forEach(function(n){n.dispose()}),this._streams=[])},t.prototype.transferPeriodState=function(t){var i=[],r=[],f,u;for(this.streams.forEach(function(n){i.push(n)}),t.streams.forEach(function(n){r.push(n)}),f=0;f<r.length;f++)for(u=0;u<i.length;u++)if(i[u]&&r[f].id===i[u].id){i[u].transferStreamState(r[f]);r[f]=null;i[u]=null;break}i=i.filter(function(n){return!!n});r=r.filter(function(n){return!!n});i.length>0&&n.Log.verbose(4,"Adaptation Sets removed from period: "+i.length);r.length>0&&n.Log.verbose(4,"Adaptation Sets added to period: "+r.length)},t}();t.Period=f;e=function(){function t(t,i,r){var w=[],b=[],s,f,e,l,v,y,h,u,p,c,k;if(this._adaptationSet=t,this.streamingInfo=new n.Presentation.MediaStreamStreamingInfo,"SegmentTemplate"in t&&(this._segmentTemplate=t.SegmentTemplate,"SegmentTimeline"in this._segmentTemplate&&(s=this._segmentTemplate.SegmentTimeline,f=this._segmentTemplate.timescale?this._segmentTemplate.timescale:1,e=r*f,e-=this._segmentTemplate.presentationTimeOffset?this._segmentTemplate.presentationTimeOffset:0,this._normalizedPtoInSec=e/f,l=new n.Presentation.MediaSegmentInfoContainer(f,e,i),"S_asArray"in s))){for(v=0,y=this._segmentTemplate.startNumber?this._segmentTemplate.startNumber:0,h=0;h<s.S_asArray.length;h++)u=s.S_asArray[h],p="t"in u?u.t:v,c="r"in u?u.r:0,k=new n.Presentation.SegmentRunEntry(y,p,u.d,e,f,c),l.addMediaSegmentRun(k),y+=c+1,v=p+u.d*(c+1);this.segments=l}"Representation"in t&&t.Representation_asArray.forEach(function(n){w.push(new o(n))});this._tracks=w.sort(function(n,t){return n.bitrate-t.bitrate});"ContentProtection"in t&&t.ContentProtection_asArray.forEach(function(n){b.push(a(n))});this._contentProtections=b}return t.prototype.dispose=function(){this._tracks&&(this._tracks.forEach(function(n){n.dispose()}),this._tracks=[]);this._contentProtections&&(this._contentProtections.forEach(function(n){n.dispose()}),this._contentProtections=[]);this.segments&&(this.segments.dispose(),this.segments=null);this.streamingInfo&&(this.streamingInfo.dispose(),this.streamingInfo=null);this._adaptationSet=null;this._segmentTemplate=null},Object.defineProperty(t.prototype,"codec",{get:function(){var n=this._adaptationSet;return n.mimeType+';codecs="'+n.codecs+'"'},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){var t;switch(this._adaptationSet.contentType){case"video":t=0;break;case"audio":t=1;break;default:n.Log.error(4,"Stream type not supported: "+this._adaptationSet.contentType)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){var n=null;return"id"in this._adaptationSet?n=this._adaptationSet.id.toString():(n=this._adaptationSet.codecs,"lang"in this._adaptationSet&&(n+=this._adaptationSet.lang)),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){var n=null;return"lang"in this._adaptationSet&&(n=this._adaptationSet.lang),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initUrlTemplate",{get:function(){var n=null;return"initialization"in this._segmentTemplate&&(n=this._adaptationSet.BaseURL+this._segmentTemplate.initialization),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mediaUrlTemplate",{get:function(){var n=null;return"media"in this._segmentTemplate&&(n=this._adaptationSet.BaseURL+this._segmentTemplate.media),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"presentationTimeOffsetInSec",{get:function(){return this._normalizedPtoInSec},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tracks",{get:function(){return this._tracks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentProtections",{get:function(){return this._contentProtections},enumerable:!0,configurable:!0}),t.prototype.transferStreamState=function(t){var i=[],r=[],f,u;for(this.tracks.forEach(function(n){i.push(n)}),t.tracks.forEach(function(n){r.push(n)}),f=0;f<r.length;f++)for(u=0;u<i.length;u++)if(i[u]&&r[f].id===i[u].id){r[f]=null;i[u]=null;break}i=i.filter(function(n){return!!n});r=r.filter(function(n){return!!n});i.length>0&&n.Log.verbose(4,"Representations removed from MPD: "+i.length);r.length>0&&n.Log.verbose(4,"Representations added to MPD: "+r.length);this.segments.update(t.segments)},t}();t.AdaptationSet=e;o=function(){function t(t){if("id"in t)this._id=t.id;else throw new Error("Representation missing @id");if("bandwidth"in t)this._bitrate=t.bandwidth;else throw new Error("Representation missing @bandwidth");this._height=t.height;this._width=t.width;this.streamingInfo=new n.Presentation.MediaTrackStreamingInfo}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bitrate",{get:function(){return this._bitrate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){},t}();t.Representation=o;i=function(){function n(n){if("schemeIdUri"in n)this.schemeIdUri=n.schemeIdUri;else throw new Error("ContentProtection missing @schemeIdUri");"value"in n&&(this._value=n.value);"id"in n&&(this._id=n.id)}return Object.defineProperty(n.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){},n}();t.BaseContentProtection=i;r=function(n){function t(t){n.call(this,t);"pro"in t&&(this._specificData=t.pro.__text)}return __extends(t,n),t.prototype.data=function(n){return 0===n?this._specificData:null},t.prototype.dispose=function(){},t.schemeIdUri="urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",t}(i);t.PlayReadyContentProtection=r;s=function(n){function t(t){n.call(this,t)}return __extends(t,n),t.prototype.data=function(){return null},t.prototype.dispose=function(){},t}(i);t.GenericContentProtection=s;h=function(){function t(){this.log=function(t){n.Log.verbose(4,t)}}return t}();c=function(){function t(){this.manifestError=function(t){n.Log.error(4,t)}}return t}()})(n.DashPresentation||(n.DashPresentation={}));var t=n.DashPresentation}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="DashUrlFormatter"}return t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestSend,this.onUrlFormat,this)},t.prototype.dispose=function(){},t.prototype.onUrlFormat=function(t){return t.currentModuleId=this._moduleId,new Promise(function(i){var r,u,e,f,o,s;if(!t.selectedTrack)throw new Error("Selected Track not set");if(r=t.selectedTrack.bitrate,r===null||r===undefined)throw new Error("incorrect bitrate");if(t.requestedStream.streamingInfo.fetchInitSegment){if(u=t.requestedStream.initUrlTemplate,!u)throw new Error("no initial url template for the stream");e=n.Util.UrlFormatter.FormatDashInitUrl(u,r.toString());t.requestedStream.streamingInfo.fetchInitSegment=!1;t.urlsToRetrieve.push(new n.Context.UrlRequest(e))}if(f=t.requestedStream.mediaUrlTemplate,!f)throw new Error("media url template is not set for the stream");if(!t.requestedStream.streamingInfo.currentSegment)throw new Error("current segment not selected.");o=t.requestedStream.streamingInfo.currentSegment.segmentInfo.mediaTimestamp;s=n.Util.UrlFormatter.FormatDashMediaUrl(f,r.toString(),o.toString());t.urlsToRetrieve.push(new n.Context.UrlRequest(s,0,t.requestedStream.streamingInfo.currentSegment.segmentInfo.presTimeInSec,t.requestedStream.streamingInfo.currentSegment.segmentInfo.durationInSec));i()})},t}();t.DashUrlFormatter=i})(n.UrlBuilder||(n.UrlBuilder={}));var t=n.UrlBuilder}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="heuristics.Engine";this._disposed=!1}return t.prototype.dispose=function(){this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestSend,this.onGetIndex,this)},t.prototype.onGetIndex=function(t){function u(){t.selectedTrack!==t.requestedStream.streamingInfo.lastDownloadedTrack&&(t.requestedStream.streamingInfo.fetchInitSegment=!0)}function f(n){for(var i=t.heuristicData.tracksData.length-1;i>=0;i--)if(t.heuristicData.tracksData[i].selectable&&t.heuristicData.tracksData[i].dataRetrieverEstimationInSec<n)return t.heuristicData.tracksData[i].trackInfo;return null}var i=this,r;return n.Log.verbose(8,"OnGetIndex"),t.currentModuleId=this._moduleId,r=this,new Promise(function(r,e){function s(){u();r()}var c,l,h,o;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,2164260864);e("object is already disposed.");return}if(t.selectedTrack){s();return}if(t.requestedStream.type!==0){t.selectedTrack=t.requestedStream.tracks[0];s();return}if(c=t.heuristicData.tracksData.findFirst(function(n){return n.selectable===!0}),c)t.selectedTrack=c.trackInfo;else{t.selectedTrack=t.heuristicData.tracksData[0].trackInfo;s();return}if(l=t.requestedStream.streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec(),h=5,!t.requestedStream.streamingInfo.currentSegment){s();return}if(h=t.requestedStream.streamingInfo.currentSegment.segmentInfo.durationInSec,!t.requestedStream.streamingInfo.currentSegment)throw new Error("current segment not selected.");var h=t.requestedStream.streamingInfo.currentSegment.segmentInfo.durationInSec,a=t.sessionContext.maxBufferInSec()*t.sessionContext.heuristicSettings.vodStableBufferLevelPercent,v=t.sessionContext.maxBufferInSec()*t.sessionContext.heuristicSettings.vodDowngradeBufferLevelPercent;l<v&&(h*=t.sessionContext.heuristicSettings.belowDowngradeBufferLevelDownloadTimeFactor);o=f(h);(!o||l>a&&o.bitrate<t.requestedStream.streamingInfo.lastDownloadedTrack.bitrate)&&t.heuristicData.tracksData.findFirst(function(n){return n.trackInfo===t.requestedStream.streamingInfo.lastDownloadedTrack&&n.selectable})&&(o=t.requestedStream.streamingInfo.lastDownloadedTrack);o&&(t.selectedTrack=o);s()})},t}();t.Engine=i})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="stepRule";this._disposed=!1;this._currentTrackSegmentCount=0;this._previousTrackSelected=null;this._currentSelectedVideoStream=null}return t.prototype.dispose=function(){this._disposed=!0;this._previousTrackSelected=null;this._currentSelectedVideoStream=null},t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestBegin,this.onRunStepRule,this)},t.prototype.onRunStepRule=function(t){var r=this,i;return n.Log.verbose(8,"onRunStepRule"),t.currentModuleId=this._moduleId,i=this,new Promise(function(u,f){var e;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,2164260864);f("object is already disposed.");return}if(t.selectedTrack||t.requestedStream.streamingInfo.lastDownloadedTrack===null||t.requestedStream.type!==0){u();return}t.requestedStream!==r._currentSelectedVideoStream&&(i._currentSelectedVideoStream=t.requestedStream,i._previousTrackSelected=null);t.requestedStream.streamingInfo.lastDownloadedTrack===i._previousTrackSelected?i._currentTrackSegmentCount++:(i._previousTrackSelected=t.requestedStream.streamingInfo.lastDownloadedTrack,i._currentTrackSegmentCount=1);var c=i._currentTrackSegmentCount>=t.sessionContext.heuristicSettings.stepRule.minSegmentsBeforeDowngrade,l=i._currentTrackSegmentCount>=t.sessionContext.heuristicSettings.stepRule.minSegmentsBeforeUpgrade,o=t.requestedStream.tracks.indexOf(i._previousTrackSelected),s=o,h=o;for(c&&t.sessionContext.heuristicSettings.stepRule.maxStepDownInQuality>0&&(s=Math.max(0,o-t.sessionContext.heuristicSettings.stepRule.maxStepDownInQuality)),l&&t.sessionContext.heuristicSettings.stepRule.maxStepUpInQuality>0&&(h=Math.min(t.heuristicData.tracksData.length-1,o+t.sessionContext.heuristicSettings.stepRule.maxStepUpInQuality)),e=0;e<t.heuristicData.tracksData.length;e++)(e>h||e<s)&&(t.heuristicData.tracksData[e].selectable=!1);u()})},t}();t.StepRule=i})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="windowSizeRule";this._disposed=!1;this._windowHeight=0;this._windowWidth=0;this._highestTrackIndexAllowed=-1;this._currentSelectedVideoStream=null}return t.prototype.dispose=function(){this._disposed=!0;this._currentSelectedVideoStream=null},t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestBegin,this.onRunWindowSizeRule,this)},t.prototype.onRunWindowSizeRule=function(t){var r=this,i;return n.Log.verbose(8,"onRunWindowSizeRule"),t.currentModuleId=this._moduleId,i=this,new Promise(function(u,f){var s,h,o,e;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,2164260864);f("object is already disposed.");return}if(t.selectedTrack||!t.sessionContext.heuristicSettings.windowSizeHeuristicsEnabled||t.requestedStream.type!==0){u();return}if(t.requestedStream!==r._currentSelectedVideoStream&&(i._currentSelectedVideoStream=t.requestedStream,i._highestTrackIndexAllowed=-1),s=Math.max(t.sessionContext.videoTag.scrollWidth,t.sessionContext.videoTag.width),h=Math.max(t.sessionContext.videoTag.scrollHeight,t.sessionContext.videoTag.height),h===0||s===0){n.Log.warning(8,"Ignoring window size heuristic rule, as one of the window dimensions is 0.");u();return}for((i._windowWidth!==s||i._windowHeight!==h)&&(i._windowWidth=s,i._windowHeight=h,i._highestTrackIndexAllowed=-1),o=t.heuristicData.tracksData,e=o.length-1;e>i._highestTrackIndexAllowed;e--)if(o[e].selectable)if(o[e].trackInfo.width>s||o[e].trackInfo.height>h)o[e].selectable=!1;else{i._highestTrackIndexAllowed=e;break}u()})},t}();t.WindowSizeRule=i})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i,r,u;(function(n){n[n.success=200]="success";n[n.notFound=404]="notFound";n[n.badGateway=502]="badGateway"})(i||(i={}));r=function(){function t(t){this._moduleId="httpDataRetriever";this._requestList=[];this._disposed=!1;this._bandwidthData=new n.Heuristics.BandwidthTracker(t.heuristicSettings.bandwidth)}return t.prototype.dispose=function(){while(this._requestList.length>0){var n=this._requestList.pop();n.request=null;n=null}this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[0],i=n.workflows[1];t.addHandler(t.stepEvents.requestBegin,this.onGetData,this);t.addHandler(t.stepEvents.requestEnd,this.onGetData,this);i.addHandler(i.stepEvents.requestBegin,this.onReportHeuristicData,this);i.addHandler(i.stepEvents.requestSend,this.onGetData,this)},t.prototype.onReportHeuristicData=function(t){n.Log.verbose(5,"onReportHeuristicData");t.currentModuleId=this._moduleId;var i=this;return new Promise(function(r,u){if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,2164260864);u("object is already disposed.");return}if(t.requestedStream.type!==0){r();return}i._bandwidthData.reportHeuristicsData(t.heuristicData,t.requestedStream.streamingInfo.currentSegment.segmentInfo.durationInSec);r()})},t.prototype.onGetData=function(t){n.Log.verbose(5,"onGetData");t.currentModuleId=this._moduleId;var i=this;return new Promise(function(r,f){function o(){var f,s;if(!t.urlsToRetrieve[e])throw new Error("Failed to start the download as urlToRetrieve at index "+e+" is null");if(!t.urlsToRetrieve[e].url)throw new Error("Failed to start the download as urlToRetrieve at index "+e+" is empty");t.urlsToRetrieve[e].responseType===0&&t.urlsToRetrieve[e].mediaData!=null||t.urlsToRetrieve[e].responseType===4&&t.urlsToRetrieve[e].presentationData!=null?(e++,e>=t.urlsToRetrieve.length?r():o()):(f=new XMLHttpRequest,f.open("GET",t.urlsToRetrieve[e].url),f.onprogress=h,f.onload=c,f.onerror=l,f.ontimeout=a,t.urlsToRetrieve[e].responseType===0&&(f.responseType=n.Context.ResponseType[0]),f.msCaching&&(f.msCaching="disabled"),f.timeout=t.sessionContext.httpDataRetrieverSettings.timeoutInMSec,s=new u(t.urlsToRetrieve[e],f),t.requestedStream&&t.requestedStream.type==0&&t.selectedTrack&&n.Log.verbose(5,"HeuristicInfo: SuggestedBr: "+t.selectedTrack.bitrate+" CurrentBw: "+i._bandwidthData.latestInKbps+" AverageBw: "+i._bandwidthData.averageBandwidthInKbps+" BufferSize: "+t.requestedStream.streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec()+" StreamType: "+n.Presentation.StreamType[t.requestedStream.type]+" StreamName: "+t.requestedStream.language+" Index: "+t.requestedStream.streamingInfo.currentSegment.segmentInfo.index+" Time: "+t.requestedStream.streamingInfo.currentSegment.segmentInfo.presTimeInSec+" Duration: "+t.requestedStream.streamingInfo.currentSegment.segmentInfo.durationInSec+" Url: "+t.urlsToRetrieve[e].url),i._requestList.push(s),f.send())}function h(n){var u=this,r,t;if(!i._disposed){if(r=(new Date).getTime(),t=i._requestList.findFirst(function(n){return n.request===u}),!t)throw new Error("cannot find the request in the request queue");t.bandwidthInfo.responseStartTimeInMS||(!n.lengthComputable||n.lengthComputable&&n.total!=n.loaded)&&(t.bandwidthInfo.responseStartTimeInMS=r)}}function c(){var h=this,u,f;if(!i._disposed){if(u=i._requestList.removeFirst(function(n){return n.request===h}),!u)throw new Error("cannot find the request in the request queue");if(u.bandwidthInfo.responseEndTimeInMS=(new Date).getTime(),f=t.urlsToRetrieve.indexOf(u.urlRequest),t.urlsToRetrieve[f].httpResposeContentType=this.getResponseHeader("Content-Type"),t.urlsToRetrieve[f].httpResponseCode=this.status,200===this.status){switch(u.urlRequest.responseType){case 0:t.urlsToRetrieve[f].mediaData=this.response;u.bandwidthInfo.responseLengthInBytes=t.urlsToRetrieve[f].mediaData.byteLength;break;case 4:t.urlsToRetrieve[f].presentationData=this.response;u.bandwidthInfo.responseLengthInBytes=t.urlsToRetrieve[f].presentationData.length;break;default:throw new Error("Unexpected response Type in the request Context");}if(n.Log.verbose(5,"Download Finished for :"+u.urlRequest.url),t.requestedStream&&(i._bandwidthData&&t.requestedStream.type===0&&i._bandwidthData.updateBandwidthInfo(u.bandwidthInfo),t.requestedStream.streamingInfo.lastDownloadedTrack=t.selectedTrack),e++,e>=t.urlsToRetrieve.length){r();return}o()}else n.Log.error(5,u.urlRequest+" failed, httpStatus: "+this.status),s(n.Failure.translateHttpStatusToCode(this.status),u.urlRequest.url)}}function l(t){var u=this,r;if(!i._disposed){if(r=i._requestList.removeFirst(function(n){return n.request===u}),!r)throw new Error("cannot find the request in the request queue");n.Log.error(5,r.urlRequest+" failed, error: "+n.Failure.errorEventToString(t));s(2164262090,r.urlRequest.url)}}function a(){var r=this,t;if(!i._disposed){if(t=i._requestList.removeFirst(function(n){return n.request===r}),!t)throw new Error("cannot find the request in the request queue");n.Log.error(5,t.urlRequest+" failed, timed out");s(2164262089,t.urlRequest.url)}}function s(i,u){var e=new n.Failure.Record(t.currentModuleId,i,u);t.requestedStream?(t.state=2,t.retryWaitTimeMSec=0,t.failTracker.log(e,t.selectedTrack),n.Log.warning(5,"failed to download: "+u),r()):(t.externalFailure=e,f())}if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,2164260864);f("object is already disposed.");return}if(t.urlsToRetrieve.length===0)throw new Error("Failed to start the download as urlsToRetrieve is empty.");var e=0;o()})},t}();t.HttpDataRetriever=r;u=function(){function t(t,i){this.urlRequest=t;this.request=i;this.bandwidthInfo=new n.Heuristics.BandwidthInfo}return t}()})(n.DataRetriever||(n.DataRetriever={}));var t=n.DataRetriever}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i,r;(function(n){n[n.noRetry=0]="noRetry";n[n.nextTrack=1]="nextTrack";n[n.nextSegment=2]="nextSegment";n[n.same=3]="same"})(i||(i={}));r=function(){function t(){this._moduleId="httpRetryPolicy";this._disposed=!1}return t.prototype.dispose=function(){this._disposed||(this._disposed=!0)},t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestBegin,this.onRetry,this)},t.prototype.onRetry=function(t){var r=this;return n.Log.verbose(5,"onRetry"),t.currentModuleId=this._moduleId,new Promise(function(u,f){var s;if(r._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,2164260864);f("object is already disposed.");return}if(!t.requestedStream){u();return}var e=t.failTracker,o=t.requestedStream.streamingInfo,h=t.sessionContext.httpRetryPolicySettings;if(e.isNone()||null!==o.pendingSeekPositionInSec){u();return}0===e.totalRetried&&(e.tracksToTry=r._createTrackToTry(h,t.requestedStream,e.lastTrack));s=r._getAction(h,t.failTracker);switch(s){case 0:t.externalFailure=e.lastFailure;n.Log.verbose(5,"onRetry: onRetry,mediaTimestamp: "+o.currentSegment.segmentInfo.mediaTimestamp);f();return;case 1:e.sameSegmentRetried++;t.selectedSegment=o.currentSegment;t.selectedTrack=e.tracksToTry[++e.trackToTryIdx];break;case 2:if(o.currentSegment.next)o.currentSegment=o.currentSegment.next,e.segmentsSkipped++,e.resetForSegment(),t.selectedSegment=o.currentSegment,t.selectedTrack=e.tracksToTry[0];else{t.externalFailure=e.lastFailure;n.Log.verbose(5,"onRetry: noRetry, EOS mediaTimestamp: "+o.currentSegment.segmentInfo.mediaTimestamp);f();return}break;case 3:e.sameSegmentRetried++;t.selectedSegment=o.currentSegment;t.selectedTrack=e.tracksToTry[0];break;default:throw new Error("unexpected retry action: "+s);}e.totalRetried++;n.Log.verbose(5,"onRetry: "+i[s]+" bitrate: "+t.selectedTrack.bitrate+" mediaTimestamp: "+t.selectedSegment.segmentInfo.mediaTimestamp);u()})},t.prototype._getAction=function(n,t){if(t.totalRetried+1>n.maxTotalRetries)return 0;var i;return i=t.isLastNetworkFail()?3:t.trackToTryIdx+1<t.tracksToTry.length?1:2,(3===i||1===i)&&t.sameSegmentRetried+1>n.maxRetryPerSegment&&(i=2),2==i&&t.segmentsSkipped+1>n.maxSkipSegments&&(i=0),i},t.prototype._createTrackToTry=function(n,t,i){var u=[],f=t.tracks.indexOf(i),e=t.tracks.length,r;for(u.push(t.tracks[f]),r=f-1;r>=0;r--)t.tracks[r].streamingInfo.selectable&&u.push(t.tracks[r]);if(!n.retryLowerBitrateOnly)for(r=f+1;r<e;r++)t.tracks[r].streamingInfo.selectable&&u.push(t.tracks[r]);return u},t}();t.HttpRetryPolicy=r})(n.DataRetriever||(n.DataRetriever={}));var t=n.DataRetriever}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i,r;(function(n){n[n.success=200]="success";n[n.notFound=404]="notFound";n[n.badGateway=502]="badGateway"})(i||(i={}));r=function(){function t(){this._moduleId="InitialBandwidthDataUrlFormatter";this._disposed=!1}return t.prototype.dispose=function(){this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[0];t.addHandler(t.stepEvents.requestEnd,this.onPreFetchUrlFormat,this)},t.prototype.onPreFetchUrlFormat=function(t){n.Log.verbose(6,"OnPreFetchUrlFormat");t.currentModuleId=this._moduleId;var i=this;return new Promise(function(r,u){var s,f,e,o;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,2164260864);u("object is already disposed.");return}if(!t.sessionContext.heuristicSettings.preFetchDataEnabled){r();return}if(s=t.sessionContext.commonPresentation.periods[0].streams,f=s.findFirst(function(n){return n.type===0}),t.requestedStream=f,e=f.tracks[0].bitrate,e===null||e===undefined)throw new Error("bitrate of first video track not set in presentation");if(o=t.requestedStream.mediaUrlTemplate,!o)throw new Error("media url template is not set for the video stream");var h=f.segments,c=h.first.segmentInfo,l=n.Util.UrlFormatter.FormatDashMediaUrl(o,e.toString(),c.mediaTimestamp.toString());t.urlsToRetrieve.push(new n.Context.UrlRequest(l));t.sessionContext.heuristicSettings.preFetchDataEnabled=!1;r()})},t}();t.InitialBandwidthDataUrlFormatter=r})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="streamSelector";this._disposed=!1;this._initial=!0}return t.prototype.dispose=function(){this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[0];t.addHandler(t.stepEvents.requestEnd,this.onSelectStreams,this)},t.prototype.onSelectStreams=function(t){var i=this;return t.currentModuleId=this._moduleId,new Promise(function(r,u){var o=!1,s=!1,f=t.sessionContext.commonPresentation,e;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,2164260864);u("Disposed");return}if(!i._initial){r();return}if(!f)throw new Error("CommonPresentation is empty");for(f.periods[0].streams.forEach(function(n){n.streamingInfo.selected=!1}),e=0;e<f.periods[0].streams.length;e++)0!==f.periods[0].streams[e].type||o?1!==f.periods[0].streams[e].type||s||(s=!0,f.periods[0].streams[e].streamingInfo.selected=!0):(o=!0,f.periods[0].streams[e].streamingInfo.selected=!0);if(!o||!s){n.Failure.attachFailureToRequest(t,t.currentModuleId,2164261634);u("Video or audio streams not found");return}i._initial=!1;r()})},t}();t.InitialStreamSelector=i})(n.Presentation||(n.Presentation={}));var t=n.Presentation}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var r=function(){function n(n,t,i,r,u){this.index=n;this._timescale=u;this._mediaTimestamp=t;this._presTimeInSec=(this._mediaTimestamp+r)/u;i&&(this._mediaDuration=i,this._durationInSec=i/u)}return Object.defineProperty(n.prototype,"mediaTimestamp",{get:function(){return this._mediaTimestamp},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mediaDuration",{get:function(){return this._mediaDuration},set:function(n){this._mediaDuration=n;this._durationInSec=n/this._timescale},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"presTimeInSec",{get:function(){return this._presTimeInSec},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"durationInSec",{get:function(){return this._durationInSec},enumerable:!0,configurable:!0}),n}(),u,i,f,s,e,o;t.MediaSegmentInfo=r;u=function(){function n(n,t,i,u,f,e){this.firstSegment=new r(n,t,i,u,f);this.repeat=e;this.containerIndex=NaN}return n}();t.SegmentRunEntry=u;i=function(){function t(n,t,i){this._container=n;this._pubTime=n.pubTime;this._runEntry=t;this._runEntryRepeatPosition=i;this.segmentInfo=new r(t.firstSegment.index+i,t.firstSegment.mediaTimestamp+i*t.firstSegment.mediaDuration,t.firstSegment.mediaDuration,n.presentationTimeOffset,n.timescale)}return Object.defineProperty(t.prototype,"next",{get:function(){var i,r,u;if(this._updateIterator(),i=this._runEntry,r=0,this._runEntryRepeatPosition+1>this._runEntry.repeat)if(u=this._runEntry.containerIndex+1,u<this._container.segmentTable.length)i=this._container.segmentTable[u];else return n.Log.warning(4,"Cannot get next iterator"),null;else r=this._runEntryRepeatPosition+1;return new t(this._container,i,r)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prev",{get:function(){var i,r,u;if(this._updateIterator(),i=this._runEntry,this._runEntryRepeatPosition===0)if(u=this._runEntry.containerIndex-1,u>=0)i=this._container.segmentTable[u],r=i.repeat;else return n.Log.warning(4,"Cannot get previous iterator"),null;else r=this._runEntryRepeatPosition-1;return new t(this._container,i,r)},enumerable:!0,configurable:!0}),t.prototype._updateIterator=function(){var t,n,i,r;if(this._container.pubTime.getTime()>this._pubTime.getTime()){for(this._pubTime=this._container.pubTime,t=this._runEntry.containerIndex,n=this._container.segmentTable[t];!n&&t>0;)t--,n=this._container.segmentTable[t];if(n){if(n.firstSegment.index<=this.segmentInfo.index&&this.segmentInfo.index<=n.firstSegment.index+n.repeat){this._runEntry=n;this._runEntryRepeatPosition=this.segmentInfo.index-n.firstSegment.index;return}if(this.segmentInfo.index>n.firstSegment.index+n.repeat&&this._container.segmentTable.length>t+1&&(i=this._container.segmentTable[t+1],this.segmentInfo.index<=i.firstSegment.index+i.repeat)){this._runEntry=i;this._runEntryRepeatPosition=this.segmentInfo.index-i.firstSegment.index;return}}if(r=this._container.getByIndex(this.segmentInfo.index),!r)throw new Error("Referenced segment not found in presentation");this._runEntry=r._runEntry;this._runEntryRepeatPosition=r._runEntryRepeatPosition}},t}();t.MediaSegmentInfoIterator=i;f=function(){function t(n,t,i){this.timescale=n;this.presentationTimeOffset=t;this.pubTime=i;this.segmentTable=[]}return t.prototype.dispose=function(){this.segmentTable.length=0},Object.defineProperty(t.prototype,"first",{get:function(){var n=null;return this.segmentTable.length>0&&(n=new i(this,this.segmentTable[0],0)),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"last",{get:function(){var n,t=null;return this.segmentTable.length>0&&(n=this.segmentTable[this.segmentTable.length-1],t=new i(this,n,n.repeat)),t},enumerable:!0,configurable:!0}),t.prototype.addMediaSegmentRun=function(t){var i=null,r=0;this.segmentTable.length>0&&(i=this.segmentTable[this.segmentTable.length-1],r=i.firstSegment.mediaTimestamp+i.firstSegment.mediaDuration*(i.repeat+1),r>t.firstSegment.mediaTimestamp&&(n.Log.error(4,"Cannot add segment with timestamp "+t.firstSegment.mediaTimestamp+" to middle of table ["+this.segmentTable[0].firstSegment.mediaTimestamp+","+r+"]"),t=null));t&&(t.containerIndex=this.segmentTable.length,this.segmentTable.push(t),n.Log.verbose(4,"Added segment with t="+t.firstSegment.mediaTimestamp+" r="+t.repeat))},t.prototype.getByIndex=function(t){var r=null,u,f,e;return 0===this.segmentTable.length?null:(u=n.Common.binarySearch(t,this.segmentTable,this._compareIndex),u!==-1&&(f=this.segmentTable[u],e=t-f.firstSegment.index,r=new i(this,f,e)),r||n.Log.verbose(4,"Entry with index "+t+" not found"),r)},t.prototype.getBySegmentStartTime=function(t,r){var o=null,f,u,e,s;if(0===this.segmentTable.length)return null;if(r||(r=n.Common.timestampDeltaThreshold),Math.abs(t-this.segmentTable[0].firstSegment.presTimeInSec)<r)return this.first;if(f=n.Common.binarySearch(t,this.segmentTable,this._compareTimestampInSec),f!==-1){if(u=this.segmentTable[f],e=Math.round((t-u.firstSegment.presTimeInSec)/u.firstSegment.durationInSec),e>u.repeat)if(f+1<this.segmentTable.length)u=this.segmentTable[f+1],e=0;else return n.Log.verbose(4,"Cannot find match for "+t),null;if(s=u.firstSegment.presTimeInSec+e*u.firstSegment.durationInSec,Math.abs(t-s)>r)return n.Log.verbose(4,"Cannot find match within error range for "+t),null;o=new i(this,u,e)}return o},t.prototype.getByInSegmentTimestamp=function(t){var u=null,f,r,e;return 0===this.segmentTable.length?null:(f=n.Common.binarySearch(t,this.segmentTable,this._compareTimestampInSec),f!==-1&&(r=this.segmentTable[f],e=Math.floor((t-r.firstSegment.presTimeInSec)/r.firstSegment.durationInSec),u=new i(this,r,e)),u||n.Log.verbose(4,"Entry including timestamp "+t+" not found"),u)},t.prototype.update=function(t){var f=this,i=t,r=null,u=0;if(!(i.pubTime.getTime()<=this.pubTime.getTime())){if(this.pubTime=i.pubTime,r=this.getBySegmentStartTime(i.first.segmentInfo.presTimeInSec),r&&r.segmentInfo.index!==i.first.segmentInfo.index&&(u=r.segmentInfo.index,n.Common.diffTimes(i.first.segmentInfo.presTimeInSec,r.segmentInfo.presTimeInSec)))throw new Error("Segment mismatch during container update");this.segmentTable.length=0;i.segmentTable.forEach(function(n){n.firstSegment.index+=u;f.segmentTable.push(n)})}},t.prototype._compareTimestampInSec=function(n,t){var i=0;return n<t.firstSegment.presTimeInSec?i=-1:n>=t.firstSegment.presTimeInSec+(t.repeat+1)*t.firstSegment.durationInSec&&(i=1),i},t.prototype._compareIndex=function(n,t){var i=0;return n<t.firstSegment.index?i=-1:n>=t.firstSegment.index+(t.repeat+1)&&(i=1),i},t}();t.MediaSegmentInfoContainer=f,function(n){n[n.needsToBeScheduled=0]="needsToBeScheduled";n[n.inProgress=1]="inProgress";n[n.endOfStream=2]="endOfStream"}(t.WorkflowState||(t.WorkflowState={}));s=t.WorkflowState;e=function(){function n(){this.selected=!1;this.fetchInitSegment=!0;this.currentSegment=null;this.pendingSeekPositionInSec=null;this.workflowState=0;this.sourceBuffer=null;this.lastDownloadedTrack=null}return n.prototype.dispose=function(){this.currentSegment=null;this.sourceBuffer&&(this.sourceBuffer.dispose(),this.sourceBuffer=null);this.lastDownloadedTrack=null},n}();t.MediaStreamStreamingInfo=e;o=function(){function n(){this.selectable=!0}return n}();t.MediaTrackStreamingInfo=o})(n.Presentation||(n.Presentation={}));var t=n.Presentation}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="SegmentLocator.Dash";this._disposed=!1}return t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestBegin,this.onFindSegment,this)},t.prototype.dispose=function(){this._disposed=!0},t.prototype.onFindSegment=function(i){n.Log.verbose(9,"onFindSegment");i.currentModuleId=this._moduleId;var r=this;return new Promise(function(u,f){var h;if(r._disposed){n.Failure.attachFailureToRequest(i,i.currentModuleId,2164260864);f("object is already disposed.");return}var e=i.requestedStream,o=e.streamingInfo.currentSegment,s=e.segments;if(i.selectedSegment){u();return}null!==e.streamingInfo.pendingSeekPositionInSec?(e.streamingInfo.currentSegment=s.getByInSegmentTimestamp(e.streamingInfo.pendingSeekPositionInSec),e.streamingInfo.pendingSeekPositionInSec=null):o?e.streamingInfo.currentSegment=o.next:(h=i.sessionContext,e.streamingInfo.currentSegment=isNaN(h.startPositionInSec)?s.first:s.getByInSegmentTimestamp(h.startPositionInSec));null===e.streamingInfo.currentSegment&&(i.sessionContext.commonPresentation.isLive?(i.state=2,i.retryWaitTimeMSec=t._retryWaitTimeMSec,e.streamingInfo.currentSegment=o):i.state=1);u()})},t._retryWaitTimeMSec=2e3,t}();t.Dash=i})(n.SegmentLocator||(n.SegmentLocator={}));var t=n.SegmentLocator}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="playReady";this._disposed=!1;this._initial=!0}return t.prototype.dispose=function(){this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[0];t.addHandler(t.stepEvents.requestEnd,this.onContentProtected,this)},t.prototype.onContentProtected=function(i){var r=this;return i.currentModuleId=this._moduleId,new Promise(function(u,f){var e=[],o=i.sessionContext.commonPresentation;if(r._disposed){n.Failure.attachFailureToRequest(i,i.currentModuleId,2164260864);f("Disposed");return}if(!r._initial){u();return}if(!o)throw new Error("CommonPresentation is empty");o.periods[0].streams.forEach(function(i){for(var f,u,r=0;r<i.contentProtections.length;r++)f=i.contentProtections[r].data(0),f&&(u=new n.Mp4Util.PsshBox,u.systemId=t.systemId,u.specificData=BASE64.decodeArray(f),e.push(u))});e.length>0&&i.sessionContext.emeManager.addPsshBoxes(e);r._initial=!1;u()})},t.systemId=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),t}();t.PlayReady=i})(n.ContentProtection||(n.ContentProtection={}));var t=n.ContentProtection}(OnePlayer||(OnePlayer={}));Array.prototype.findFirst=function(n){for(var i,t=0;t<this.length;t++)if(i=this[t],n.call(this,i,t,Object(this)))return i;return null};Array.prototype.findLast=function(n){for(var i,t=this.length-1;t>=0;t--)if(i=this[t],n.call(this,i,t,Object(this)))return i;return null};Array.prototype.findIndexOf=function(n){for(var i,t=0;t<this.length;t++)if(i=this[t],n.call(this,i,t,Object(this)))return t;return-1};Array.prototype.removeFirst=function(n){var t=this.findIndexOf(n),i=null;return t!==-1&&(i=this.splice(t,1)[0]),i};Uint8Array.prototype.isEqual=function(n){if(this.length===n.length){for(var t=0;t<this.length;t++)if(this[t]!==n[t])return!1;return!0}return!1},function(n){(function(n){"use strict";var t=function(){function n(n){if(this._slidingWindow=[],this._sum=0,this._maxWindowLength=n,n<1)throw new Error("window length for average class should be greater than 0");}return n.prototype.dispose=function(){this._slidingWindow=null},Object.defineProperty(n.prototype,"average",{get:function(){return this._slidingWindow.length===0?0:this._sum/this._slidingWindow.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"latest",{get:function(){return this._slidingWindow.length===0?0:this._slidingWindow[this._slidingWindow.length-1]},enumerable:!0,configurable:!0}),n.prototype.addValue=function(n){if(this._slidingWindow.length>=this._maxWindowLength){var t=this._slidingWindow.splice(0,1);this._sum-=t[0]}this._slidingWindow.push(n);this._sum+=n},n}();n.AverageCalculator=t})(n.Util||(n.Util={}));var t=n.Util}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";function u(t,i,r){typeof r=="undefined"&&(r=n.timestampDeltaThreshold);var u=i-t;return Math.abs(u)<r&&(u=0),u}function f(n,t,i){for(var u=0,f=t.length-1,r=0,e;u<=f;)if(r=Math.floor((u+f)/2),e=i(n,t[r]),e<0)f=r-1;else if(e>0)u=r+1;else return r;return-1}function e(n){for(var t,r="",i=0;i<n.length;i++)t=n[i].toString(16),r+=t.length<2?"0"+t:t;return r}var t,i,r;n.timestampDeltaThreshold=1e-6;n.diffTimes=u;t=function(){function n(n,t){this.startInSec=n;this.endInSec=t}return n}();n.TimeRange=t;i=function(){function n(){this._timeRanges=[]}return n.prototype.dispose=function(){this._timeRanges=null},Object.defineProperty(n.prototype,"length",{get:function(){return this._timeRanges.length},enumerable:!0,configurable:!0}),n.prototype.start=function(n){return this._timeRanges[n].startInSec},n.prototype.end=function(n){return this._timeRanges[n].endInSec},n.prototype.duration=function(n){return this._timeRanges[n].endInSec-this._timeRanges[n].startInSec},n.prototype.extendLast=function(n){this._timeRanges[this._timeRanges.length-1].endInSec=n},n.prototype.addRange=function(n){this._timeRanges.push(n)},n.prototype.addRanges=function(n){for(var i=0;i<n.length;i++)this.addRange(new t(n.start(i),n.end(i)))},n.prototype.removeGaps=function(n){for(var t=0;t+1<this._timeRanges.length;)this._timeRanges[t+1].startInSec-this._timeRanges[t].endInSec<n?(this._timeRanges[t].endInSec=this._timeRanges[t+1].endInSec,this._timeRanges.splice(t+1,1)):t++},n}();n.TimeRangeSet=i;r=function(){function n(n,t,i){this.presTimeInSec=t;this.durationInSec=i;this.data=n}return Object.defineProperty(n.prototype,"endTimestampInSec",{get:function(){return this.presTimeInSec+this.durationInSec},enumerable:!0,configurable:!0}),n}();n.SegmentData=r;n.binarySearch=f;n.uint8ArrayToHexString=e})(n.Common||(n.Common={}));var t=n.Common}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";var i=function(){function n(n,t){typeof t=="undefined"&&(t=0);this.data=n;this.readPos=t}return n.prototype.getUint8=function(){return this.data.getUint8(this.readPos++)},n.prototype.getUint32=function(){var n=this.data.getUint32(this.readPos);return this.readPos+=4,n},n.prototype.getInt32=function(){var n=this.data.getInt32(this.readPos);return this.readPos+=4,n},n.prototype.getBytes=function(n){for(var i=new Uint8Array(n),t=0;t<n;t++)i[t]=this.getUint8();return i},n.prototype.readString=function(n){for(var t="",i=0;i<n;i++)t+=String.fromCharCode(this.getUint8());return t},n}(),t;n.Reader=i;t=function(){function n(n,t){typeof t=="undefined"&&(t=0);this.data=n;this.writePos=t}return n.prototype.setUint8=function(n){this.data.setUint8(this.writePos++,n)},n.prototype.setUint32=function(n){this.data.setUint32(this.writePos,n);this.writePos+=4},n.prototype.setInt32=function(n){this.data.setInt32(this.writePos,n);this.writePos+=4},n.prototype.setString=function(n){for(var t=0;t<n.length;t++)this.setUint8(n.charCodeAt(t))},n.prototype.setBytes=function(n){for(var t=0;t<n.length;t++)this.setUint8(n[t])},n}();n.Writer=t})(n.DataViewReaderWriter||(n.DataViewReaderWriter={}));var t=n.DataViewReaderWriter}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";var r=function(){function n(n,t){typeof n=="undefined"&&(n=null);typeof t=="undefined"&&(t=!0);this._videoElement=n;this._allowDuplicateHandlers=t;this._registrations={}}return n.prototype.dispose=function(){this._registrations=null},n.prototype.getHandlers=function(n){return n in this._registrations||(this._registrations[n]=[]),this._registrations[n]},n.prototype.addHandler=function(n,t,r){var u=this.getHandlers(n),f;(this._allowDuplicateHandlers||-1===this._findHandlerByFunction(u,t))&&(f=new i(r,t),u[u.length]=f)},n.prototype.removeHandler=function(n,t){for(var i=this.getHandlers(n),r=this._findHandlerByFunction(i,t);r!==-1;)i.splice(r,1),r=this._findHandlerByFunction(i,t)},n.prototype.dispatchEvent=function(n,i){function f(){var o=new t(n,e._videoElement,i);r[u].functionHandler.call(r[u].callerInstance,o);++u<r.length&&setTimeout(f,0)}var e=this,u=0,r=this.getHandlers(n).slice();r.length>0&&setTimeout(f,0)},n.prototype._findHandlerByFunction=function(n,t){for(var r=-1,i=0;i<n.length;i++)if(n[i].functionHandler===t){r=i;break}return r},n}(),t,i;n.Manager=r;t=function(){function n(n,t,i){this.type=n;this.currentDate=new Date;this.videoElement=t;this.presentationTimeInSec=t?t.currentTime:0;this.message=i}return n}();n.EventInfo=t;i=function(){function n(n,t){this.callerInstance=n;this.functionHandler=t}return n}();n.Handler=i})(n.Events||(n.Events={}));var t=n.Events}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";function f(n){switch(n){case 400:return 2164261888;case 401:return 2164261889;case 403:return 2164261890;case 404:return 2164261891;case 500:return 2164261892;case 502:return 2164261893;case 503:return 2164261894;case 504:return 2164261895;default:return 2164262088}}function e(n){var t;return n.filename&&(t+=" file: "+n.filename),n.lineno&&(t+=" line: "+n.lineno),n.colno&&(t+=" colno: "+n.colno),n.error&&(t+="error: "+n.error),n.message&&(t+="msg: "+n.message),t}function o(n){if(undefined===n||null===n)return"undefined";var i=r(n.code);return n.msExtendedCode&&(i+=", extendedCode: "+t(n.msExtendedCode)),i}function s(n,t,r,u){var f=new i(t,r,u);null!=n&&(n.externalFailure=f)}function r(n){switch(n){case MediaError.MEDIA_ERR_ABORTED:return"MEDIA_ERR_ABORTED";case MediaError.MEDIA_ERR_NETWORK:return"MEDIA_ERR_NETWORK";case MediaError.MEDIA_ERR_DECODE:return"MEDIA_ERR_DECODE";case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return n.toString()}}function t(n){return n<0&&(n=4294967295+n+1),"0x"+("00000000"+n.toString(16).toUpperCase()).substr(-8)}function h(n){return n>2164261119}var i=function(){function n(n,t,i){this.originModuleId=n;this.code=t;this.message=i}return n.prototype.dispose=function(){this.originModuleId=null;this.code=null;this.message=null},n.prototype.toString=function(){var n;return n="Module = "+this.originModuleId+" FailureCode = "+t(this.code),this.message&&(n+=" "+this.message),n},n}(),u;n.Record=i;n.translateHttpStatusToCode=f;n.errorEventToString=e;n.mediaErrorToString=o;n.attachFailureToRequest=s;n.isExternalError=h;u=function(){function n(n,t){n?(this.code=this._mapExtendedCodeToCode(n),this.extendedCode=n,this.message=t):(this.code=0,this.extendedCode=null,this.message=null)}return n.prototype.translateMediaError=function(n){this.code=n.code;n.msExtendedCode&&(this.extendedCode=n.msExtendedCode)},n.prototype.toString=function(){var n="code: "+r(this.code);return this.extendedCode&&(n+=", extendedCode: "+t(this.extendedCode)),this.message&&(n+=", msg: "+this.message),n},n.prototype._mapExtendedCodeToCode=function(n){return 2164261120<=n&&n<=2164261375?MediaError.MEDIA_ERR_ABORTED:2164261376<=n&&n<=2164261631?MediaError.MEDIA_ERR_DECODE:2164261632<=n&&n<=2164261887?MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:2164261888<=n&&n<=2164262143?MediaError.MEDIA_ERR_NETWORK:Number.MAX_VALUE},n}();n.External=u})(n.Failure||(n.Failure={}));var t=n.Failure}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";function h(n,t){r(n,3,t)}function c(n,t){r(n,2,t)}function l(n,t){r(n,1,t)}function a(n){s=n}function v(n){undefined===n||null===n?t.forEach(function(n,t,i){i[t]=!0}):t[n]=!0}function y(n){undefined===n||null===n?t.forEach(function(n,t,i){i[t]=!1}):t[n]=!1}function p(n){typeof n=="undefined"&&(n=!0);f=n}function w(n){typeof n=="undefined"&&(n=!0);var t=i;return n&&(i=""),t}function r(n,r,u){var h=new Date(Date.now()),c;r<=s&&t[n]&&(c="["+h.getHours()+":"+h.getMinutes()+":"+h.getSeconds()+"."+h.getMilliseconds()+"] "+e[r]+": "+o[n]+": "+u,f&&(i+="\n"+c),console.log(c))}var e,o,u,f,i;(function(n){n[n.none=0]="none";n[n.error=1]="error";n[n.warning=2]="warning";n[n.verbose=3]="verbose"})(n.Level||(n.Level={}));e=n.Level,function(n){n[n.workflowSequencer=0]="workflowSequencer";n[n.workflowCoordinator=1]="workflowCoordinator";n[n.htmlAdapter=2]="htmlAdapter";n[n.videoElementAdapter=3]="videoElementAdapter";n[n.manifestParser=4]="manifestParser";n[n.httpDataRetriever=5]="httpDataRetriever";n[n.dashUrlFormatter=6]="dashUrlFormatter";n[n.onePlayerVideoElement=7]="onePlayerVideoElement";n[n.heuristics=8]="heuristics";n[n.segmentLocator=9]="segmentLocator";n[n.functionalTest=10]="functionalTest";n[n.mediaParser=11]="mediaParser";n[n.mp4Parser=12]="mp4Parser";n[n.encrypted=13]="encrypted";n[n.max=14]="max"}(n.Area||(n.Area={}));o=n.Area;n.verbose=h;n.warning=c;n.error=l;n.setConsoleOutputByLevel=a;n.enableConsoleOutputByArea=v;n.disableConsoleOutputByArea=y;n.enableMemoryLog=p;n.getMemoryLog=w;var s=0,t=[];for(u=0;u<14;u++)t.push(!1);f=!1;i="";n.enableConsoleOutputByArea();n.setConsoleOutputByLevel(3)})(n.Log||(n.Log={}));var t=n.Log}(OnePlayer||(OnePlayer={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";function r(t,i,r){typeof r=="undefined"&&(r=0);var u,f=r;if(!i||i.length!==4)return n.Log.error(12,"Parameter error, box type must have four characters"),null;if(!t||t.byteLength<8)return n.Log.error(12,"Parameter error, not enough data"),null;while(f<t.byteLength){if(u=c(t,f),!u)break;if(u.type===i)return u;f+=u.size}return null}function c(t,i){if(!t||t.byteLength-i<8)return n.Log.error(12,"MP4 box parsing error, not enough data for box header"),null;var r=new f(t,i);if(r.size=r.getUint32(),r.type=r.readString(4),r.size===1){if(t.byteLength-i<16)return n.Log.error(12,"MP4 box parsing error, not enough data for largesize"),null;if(r.size=r.getUint32()<<32,r.size+=r.getUint32(),r.size>9007199254740991)return n.Log.error(12,"Box size too big for precise representation as Javascript number"),null}else r.size===0&&(r.size=t.byteLength);if(r.size>t.byteLength-i)return null;if(r.type==="uuid"){if(t.byteLength-r.readPosition<16)return n.Log.error(12,"MP4 box parsing error, not enough data for usertype"),null;r.usertype=r.readString(16)}return r.data=new DataView(t.buffer,t.byteOffset+r.readPosition,t.byteLength-r.readPosition),r}function l(t){var i,u=null;return(i=r(t,"tfhd"),!i)?(n.Log.warning(12,"tfhd not found"),null):(u=e.parse(i),u||n.Log.warning(12,"Parsing of tfhd failed"),u)}function a(t){var i,u=null;return(i=r(t,"trun"),!i)?(n.Log.warning(12,"trun not found"),null):(u=o.parse(i),u||n.Log.warning(12,"Parsing of trun failed"),u)}function v(t){var i,u=null;return(i=r(t,"tfdt"),!i)?(n.Log.warning(12,"tfdt not found"),null):(u=h.parse(i),u||n.Log.warning(12,"Parsing of tfdt failed"),u)}function y(t){for(var i,f=[],e=0,o;e<t.byteLength;){if(i=r(t,u.typeStr,e),!i)return n.Log.warning(12,"pssh not found"),f;o=u.parse(i);o?f.push(o):n.Log.warning(12,"Parsing of pssh failed");e+=i.size}return f}var f=function(){function t(t,i){t&&typeof i!="undefined"&&(this.data=t,this.reader=new n.DataViewReaderWriter.Reader(t,i))}return t.prototype.getUint32=function(){return this.reader.getUint32()},t.prototype.getInt32=function(){return this.reader.getInt32()},t.prototype.getUint8=function(){return this.reader.getUint8()},t.prototype.getBytes=function(n){return this.reader.getBytes(n)},t.prototype.readString=function(n){return this.reader.readString(n)},Object.defineProperty(t.prototype,"readPosition",{get:function(){return this.reader.readPos},enumerable:!0,configurable:!0}),t}(),i,e,o,s,h,u;t.Mp4Box=f;i=function(t){function i(i){t.call(this);i&&(this.size=i.size,this.type=i.type,this.usertype=i.usertype,this.data=i.data,this.reader=new n.DataViewReaderWriter.Reader(this.data),this._versionFlags=i._versionFlags)}return __extends(i,t),i.parse=function(t){var r=null;return t.data.byteLength<4?(n.Log.error(12,"Full box parsing error, not enough bytes"),null):(r=new i,r.size=t.size,r.type=t.type,r.usertype=t.usertype,r._versionFlags=t.data.getUint32(0),r.data=new DataView(t.data.buffer,t.data.byteOffset+4,t.data.byteLength-4),r.reader=new n.DataViewReaderWriter.Reader(r.data),r)},i.serialize=function(t,i){var f=(t.type==="uuid"?16:0)+12,u=i+f,e=new ArrayBuffer(u),o=new DataView(e),r=new n.DataViewReaderWriter.Writer(o);if(u>4294967295)throw new Error("Mp4FullBox::serialize, large size is not supported");if(r.setUint32(u),r.setString(t.type),t.type==="uuid"&&r.setString(t.usertype),r.setUint32(t._versionFlags),r.writePos!==f)throw new Error("Mp4FullBox::serialize, inconsistent bytes written");return r},Object.defineProperty(i.prototype,"version",{get:function(){return this._versionFlags>>24},set:function(n){this._versionFlags&=16777215;this._versionFlags|=n<<24},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flags",{get:function(){return this._versionFlags&16777215},set:function(n){this._versionFlags&=4278190080;this._versionFlags|=n&16777215},enumerable:!0,configurable:!0}),i.prototype.getUint32Cond=function(n){var t;return n&this.flags&&(t=this.reader.getUint32()),t},i}(f);t.Mp4FullBox=i;e=function(t){function r(n){t.call(this,n)}return __extends(r,t),r.parse=function(t){var u=null,f=null;return(f=i.parse(t),!f)?null:(u=new r(f),f.data.byteLength<u._calculatedSize())?(n.Log.error(12,"tfhd box parsing error, not enough data"),null):(u.trackId=u.getUint32(),u.baseDataOffsetHi=u.getUint32Cond(r.flags_baseDataOffsetPresent),u.baseDataOffsetLo=u.getUint32Cond(r.flags_baseDataOffsetPresent),u.sampleDescriptionIndex=u.getUint32Cond(r.flags_sampleDescriptionIndexPresent),u.defaultSampleDuration=u.getUint32Cond(r.flags_defaultSampleDurationPresent),u.defaultSampleSize=u.getUint32Cond(r.flags_defaultSampleSizePresent),u.defaultSampleFlags=u.getUint32Cond(r.flags_defaultSampleFlagsPresent),u)},r.prototype._calculatedSize=function(){var n=4;return n+=this.flags&r.flags_baseDataOffsetPresent?8:0,n+=this.flags&r.flags_sampleDescriptionIndexPresent?4:0,n+=this.flags&r.flags_defaultSampleDurationPresent?4:0,n+=this.flags&r.flags_defaultSampleSizePresent?4:0,n+(this.flags&r.flags_defaultSampleFlagsPresent?4:0)},r.typeStr="tfhd",r.flags_baseDataOffsetPresent=1,r.flags_sampleDescriptionIndexPresent=2,r.flags_defaultSampleDurationPresent=8,r.flags_defaultSampleSizePresent=16,r.flags_defaultSampleFlagsPresent=32,r.flags_durationIsEmpty=65536,r.flags_defaultBaseIsMoof=131072,r}(i);t.TfhdBox=e;o=function(t){function r(n){t.call(this,n)}return __extends(r,t),r.parse=function(t){var u=null,e=null,o,f;if(e=i.parse(t),!e)return null;if((u=new r(e),e.data.byteLength<4)||(u.sampleCount=u.getUint32(),e.data.byteLength<u._calculatedSize()))return n.Log.error(12,"trun box parsing error, not enough data"),null;for(u.dataOffset=u.getUint32Cond(r.flags_dataOffsetPresent),u.firstSampleFlags=u.getUint32Cond(r.flags_firstSampleFlagsPresent),u.sampleInfoArray=[],o=0;o<u.sampleCount;o++)f=new s,f.sampleDuration=u.getUint32Cond(r.flags_sampleDurationPresent),f.sampleSize=u.getUint32Cond(r.flags_sampleSizePresent),f.sampleFlags=u.getUint32Cond(r.flags_sampleFlagsPresent),u.flags&r.flags_sampleCompositionTimeOffsetsPresent&&(f.sampleCompositionTimeOffset=u.version===0?u.getUint32():u.getInt32()),u.sampleInfoArray.push(f);return u},r.prototype._calculatedSize=function(){var t=4,n;return t+=this.flags&r.flags_dataOffsetPresent?4:0,t+=this.flags&r.flags_firstSampleFlagsPresent?4:0,n=this.flags&r.flags_sampleDurationPresent?4:0,n+=this.flags&r.flags_sampleSizePresent?4:0,n+=this.flags&r.flags_sampleFlagsPresent?4:0,n+=this.flags&r.flags_sampleCompositionTimeOffsetsPresent?4:0,t+this.sampleCount*n},r.typeStr="trun",r.flags_dataOffsetPresent=1,r.flags_firstSampleFlagsPresent=4,r.flags_sampleDurationPresent=256,r.flags_sampleSizePresent=512,r.flags_sampleFlagsPresent=1024,r.flags_sampleCompositionTimeOffsetsPresent=2048,r}(i);t.TrunBox=o;s=function(){function n(){}return n}();t.TrunSampleInfo=s;h=function(t){function r(n){t.call(this,n);this.baseMediaDecodeTime=0}return __extends(r,t),r.parse=function(t){var u=null,f=null;return(f=i.parse(t),!f)?null:(u=new r(f),f.data.byteLength<u._calculatedSize())?(n.Log.error(12,"tfdt box parsing error, not enough data"),null):(u.version===1&&(u.baseMediaDecodeTime=u.getUint32()*4294967296),u.baseMediaDecodeTime+=u.getUint32(),u.baseMediaDecodeTime>=9007199254740992&&n.Log.warning(12,"tfdt timestamp greater than 53 bits, possible precision loss"),u)},r.prototype._calculatedSize=function(){return this.version===1?8:4},r.typeStr="tfdt",r}(i);t.TfdtBox=h;u=function(t){function r(n){n?t.call(this,n):this.type=r.typeStr;this._keyIds=[]}return __extends(r,t),r.parse=function(t){var u=null,f=null,e,o,h,s;if(f=i.parse(t),!f)return null;if(u=new r(f),f.data.byteLength<u._calculatedSize())return n.Log.error(12,"pssh box parsing error, not enough data"),null;if(u.systemId=u.getBytes(16),e=0,u.version>0){if(e=u.getUint32(),u._keyIds.length=e,f.data.byteLength<u._calculatedSize())return n.Log.error(12,"pssh box parsing error, not enough data"),null;for(o=0;o<e;o++)h=u.getBytes(16),u._keyIds[o]=h}return(s=u.getUint32(),f.data.byteLength<u._calculatedSize(s))?(n.Log.error(12,"pssh box parsing error, not enough data"),null):(u.specificData=u.getBytes(s),u)},r.prototype.addKeyId=function(n){if(n.length!==16)throw new Error("keyId must be 16 bytes");this.version=1;this._keyIds.push(n)},Object.defineProperty(r.prototype,"keyIds",{get:function(){return this._keyIds},enumerable:!0,configurable:!0}),r.prototype._calculatedSize=function(n){typeof n=="undefined"&&(n=0);var t=20+n;return this.version>0&&(t+=4+this._keyIds.length*16),t},r.prototype.serialize=function(){var n=i.serialize(this,this._calculatedSize(this.specificData.byteLength));if(!this.systemId)throw new Error("systemId is not set");if(n.setBytes(this.systemId),this.version>0&&(n.setUint32(this._keyIds.length),this._keyIds.forEach(function(t){n.setBytes(t)})),!this.specificData)throw new Error("specificData is not set");if(n.setUint32(this.specificData.byteLength),n.setBytes(this.specificData),n.writePos!=n.data.buffer.byteLength)throw new Error("Failed to write to end of buffer");return n.data.buffer},r.typeStr="pssh",r}(i);t.PsshBox=u;t.GetBoxByType=r;t.GetTfhdBox=l;t.GetTrunBox=a;t.GetTfdtBox=v;t.GetPsshBoxes=y})(n.Mp4Util||(n.Mp4Util={}));var t=n.Mp4Util}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";function i(){return n.VideoElementAdapter.supported('video/mp4; codecs="avc1.4d404f"')}function r(n){var i=!1,t;return n&&n.canPlayType&&(t=n.canPlayType("application/vnd.apple.mpegurl"),(t==="maybe"||t==="probably")&&(i=!0)),i}function u(n){var i=!1,t;return n&&n.canPlayType&&(t=n.canPlayType("video/mp4"),(t==="maybe"||t==="probably")&&(i=!0)),i}(function(n){n[n.type1=1]="type1";n[n.type2=2]="type2";n[n.type3=3]="type3"})(t.Type||(t.Type={}));var f=t.Type;t.MseSupported=i;t.HlsType1Supported=r;t.Mp4Type1Supported=u})(n.PlayerDetector||(n.PlayerDetector={}));var t=n.PlayerDetector}(OnePlayer||(OnePlayer={})),function(n){(function(t){"use strict";function s(n,t){var r;if(n&&n.length>0&&(r=n.trim().toLowerCase(),f[r]))return i(f[r],t)}function h(n,t){var f=n.trim().toLowerCase(),s,h;return f.lastIndexOf(".ism/")>-1&&(s=o(f),r[s])?i(r[s],t):(h=e(f),u[h])?i(u[h],t):null}function e(n){var i=null,t=n.lastIndexOf("."),r=n.indexOf("/",t);return t>-1&&(i=n.substring(t+1,r!==-1?r:n.length)),i}function o(n){var t=null,i=n,e="(format=",o=n.lastIndexOf("?"),r,u,f;return o>-1&&(i=n.substring(0,o)),r=i.lastIndexOf(e),r>-1&&(u=i.lastIndexOf(")"),u>r&&(t=i.substring(r+e.length,u),f=t.indexOf(","),f>-1&&(t=t.substring(0,f)))),t}function i(t,i){var r=null;switch(t){case 1:n.PlayerDetector.HlsType1Supported(i)&&(r=1);break;case 2:n.PlayerDetector.Mp4Type1Supported(i)&&(r=1);break;case 3:n.PlayerDetector.MseSupported(i)&&(r=3)}return r}(function(n){n[n.hls=1]="hls";n[n.mp4=2]="mp4";n[n.dash=3]="dash"})(t.Format||(t.Format={}));var c=t.Format,r={"m3u8-aapl-v3":1,"m3u8-aapl-v4":1,"mpd-time-csf":3},u={mp4:2,m3u8:1},f={"video/mp4":2,"application/dash+xml":3,"application/vnd.apple.mpegurl":1};t.getByPresentationType=s;t.getByUrl=h;t._getFileExtension=e;t._getAzureMediaFormatTag=o;t._getPlayerTypeByFormat=i})(n.PlayerType||(n.PlayerType={}));var t=n.PlayerType}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";var t=function(){function t(){}return t.FormatDashMediaUrl=function(n,t,i){if(!n)throw new Error("url Template is not set");var r=n;return t!==null&&t!==undefined&&t!==""&&(r=r.replace("$Bandwidth$",t)),i!==null&&i!==undefined&&i!==""&&(r=r.replace("$Time$",i)),r},t.FormatDashInitUrl=function(t,i){return n.UrlFormatter.FormatDashMediaUrl(t,i,null)},t}();n.UrlFormatter=t})(n.Util||(n.Util={}));var t=n.Util}(OnePlayer||(OnePlayer={})),function(n){(function(n){"use strict";function t(n,t){var i="WebKitMediaKeys"in window,r="MSMediaKeys"in window,u="MediaKeys"in window;return u?window.MediaKeys.isTypeSupported(n,t):i?window.WebKitMediaKeys.isTypeSupported(n,t):r?window.MSMediaKeys.isTypeSupported(n,t):!1}function i(n){var t="WebKitMediaKeys"in window,i="MSMediaKeys"in window,r="MediaKeys"in window;if(r)return new window.MediaKeys(n);if(t)return new window.WebKitMediaKeys(n);if(i)return new window.MSMediaKeys(n);throw new Error("create MediaKeys not supported");}function r(n,t){var i="WebKitSetMediaKeys"in n,r="msSetMediaKeys"in n,u="SetMediaKeys"in n;if(u)n.SetMediaKeys(t);else if(i)n.WebKitSetMediaKeys(t);else if(r)n.msSetMediaKeys(t);else throw new Error("SetMediaKeys not supported");}function u(n,t){n.addEventListener("webkitneedkey",t);n.addEventListener("msneedkey",t);n.addEventListener("needKey",t)}function f(n,t){n.addEventListener("webkitkeymessage",t);n.addEventListener("mskeymessage",t);n.addEventListener("keymessage",t)}function e(n,t){n.addEventListener("webkitkeyadded",t);n.addEventListener("mskeyadded",t);n.addEventListener("keyadded",t)}function o(n,t){n.addEventListener("webkitkeyerror",t);n.addEventListener("mskeyerror",t);n.addEventListener("keyerror",t)}function s(n,t){n.removeEventListener("webkitneedkey",t);n.removeEventListener("msneedkey",t);n.removeEventListener("needKey",t)}function h(n,t){n.removeEventListener("webkitkeymessage",t);n.removeEventListener("mskeymessage",t);n.removeEventListener("keymessage",t)}function c(n,t){n.removeEventListener("webkitkeyadded",t);n.removeEventListener("mskeyadded",t);n.removeEventListener("keyadded",t)}function l(n,t){n.removeEventListener("webkitkeyerror",t);n.removeEventListener("mskeyerror",t);n.removeEventListener("keyerror",t)}n.isTypeSupported=t;n.createMediaKeys=i;n.setMediaKeys=r;n.listenToNeedKey=u;n.listenToKeyMessage=f;n.listenToKeyAdded=e;n.listenKeyError=o;n.unlistenToNeedKey=s;n.unlistenToKeyMessage=h;n.unlistenToKeyAdded=c;n.unlistenKeyError=l})(n.EmeUtil||(n.EmeUtil={}));var t=n.EmeUtil}(OnePlayer||(OnePlayer={}))